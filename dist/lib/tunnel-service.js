'use strict';var a35_0x2cf3=['userServiceConfig','path','runner','registry.','userTriggerConfigList','remove','20IlOpPk','Unset\x20helper\x20function\x20provision\x20and\x20on-demand\x20config\x20done.','getProvisionConfig','getState','nodejs','Stop\x20proxy\x20container:\x20','map','custom-container','getHelperConfigFromState','genStateId','__awaiter','Received\x20canncel\x20request,\x20stopping\x20running\x20proxy\x20container.....','handler','debug','trys','Delete\x20done.','Error:\x20','Deploying\x20helper\x20function...','/services/','name','setup','Delete\x20error.','fs-extra','default','/tcp','Unsetting\x20helper\x20function\x20config...','spinner','generateProxyContainerOpts','warn','stdoutFormatter','stdoutFilePath','Session\x20name\x20is\x20:\x20','initializationTimeout','data',',\x20functionName:\x20','appName','proxyImageVersion','utf-8','Close\x20stdout\x20file\x20of\x20proxy\x20container:\x20','cache','supportedRegionList','309cFIsWQ','service','genHelperServiceConfig','localInstanceId','0:0','next',',\x20please\x20make\x20sure\x20that\x20your\x20account\x20has\x20updateService\x20permission.','FcRemoteInvokeComponent','./component/stdout-formatter','proxyContainerId','getProxyContainerIdFromState','Proxy\x20container\x20was\x20not\x20running.\x20Please\x20exec\x20\x27s\x20setup\x27\x20first.','52tqqczv','./definition','7FOewDa','FcDeployComponent','--invocation-type\x20async','region','forEach','then','tunnel-service.cn-hangzhou.aliyuncs.com','Container:\x20','client','php7.2','loadComponent','Delete\x20session\x20body:\x20','__esModule','push','remoteInstanceId','genHelperFunctionConfig','stdout.log','genOutputFileOfProxyContainer','function','runtime','generateProxyContainerEnv','1095qvItIA','return','initializer','3710wALRqG','sent','makeHelperFunction','serviceName:\x20','createWriteStream','Session\x20has\x20not\x20been\x20established.\x20Please\x20exec\x20\x27s\x20setup\x27\x20first.','credentials','streamOfRunner','debugPort','Set/get\x20provision\x20of\x20helper\x20function\x20error.Please\x20make\x20sure\x20you\x20have\x20the\x20related\x20ram\x20permission.','ts-local','message','stopContainer','--invocation-type\x20sync','stringify','36292tBvRQX','Checking\x20if\x20session\x20is\x20established...','container','apply','remove\x20helper\x20service',',\x20stderr\x20to:\x20','isAutoConfig','Create\x20session\x20result\x20data:\x20','dirname','523748RWYyaN','environmentVariables','./docker/docker','Create\x20session\x20failed.','TUNNEL_SERVICE_PROXY_IMAGE_LATEST_VERSION','tunnerServiceHost','done','fc-deploy-project','join','saveSession','service\x20-y','error','isCustomContainerRuntime','ESTABLISHED','helperImageStableVersion','functionName','length','defineProperty','statusCode','genComponentInputs','./utils/devs','session_','getSessionFromState','fc-remote-invoke-project','deploy','generateSessionName','serviceName','Session\x20establish\x20fail.','succeed','stderrFileWriteStream','unsetHelperFunctionConfig','maxRetryCnt','current','invokeHelperFunction','./component/fc-deploy','AccountID','lodash','fc-remote-invoke','Session\x20establish\x20fail,\x20body\x20in\x20response\x20is:\x20','TUNNEL_SERVICE_AK_SECRET','call','runtimeListNeedSetTsAdjustFLag','fc-deploy','Unset\x20error.','prototype','fc-tunnel-invoke','internetAccess','AccessKeyID','request','97zCZCjc','sessionId','access','deleteSession','substring','@serverless-devs/core','fail','\x20failed!\x0aError:\x20','Put\x20provision\x20config\x20error:\x20','aliyunfc','label','__importStar','writeEventToStreamAndClose','putProvisionConfig','Deleting\x20session:\x20','v0.10','CreateSessionRequest','split','generateProxyContainerDebugOpts','java','pycharm','TUNNEL_SERVICE_HELPER_IMAGE_LATEST_VERSION','hasOwnProperty','Fail\x20to\x20set\x20provison\x20and\x20elasticity\x20for\x20helper\x20function.','./component/fc-remote-invoke','11159oMVrSs','userFunctionConfig','AccessKeySecret','cacheDirPath','certConfig','pullImageIfNeed','./utils/time','value','ensureDir','Creating\x20session...','AlicloudClient','ops','__setModuleDefault','Close\x20stderr\x20file\x20of\x20proxy\x20container:\x20','session','\x20stdout\x20to:\x20','status','warning','getFcClient','__createBinding','\x20debug\x20config\x20only\x20support\x20for\x20runtime\x20[python2.7,\x20python3]','runProxyContainer','On-demand\x20config\x20delete\x20result:\x20','create','__generator','getHttpTrigger','devsapp/fc-deploy','fcClient','mark','unsetProxyContainerId','pop','Tunnel\x20service\x20proxy\x20container\x20options:\x20','saveProxyContainerId','assign','Generator\x20is\x20already\x20executing.','stdoutFileWriteStream','sleep','cloneDeep','cn-hangzhou','debugIde','env','\x20times.','22214YadfIj','LATEST','Helper\x20function\x20generated\x20by\x20fc-tunnel-invoke\x20component','stderrFilePath','DELETE','getSession','iterator','Env','userCustomDomainConfigList','isEmpty','setHelperFunctionConfig','helperConfig','body','\x20error:\x20','genHelperCustomDomainConfig','python','instanceLifecycleConfig','SESSION-','unsetKVInState','./utils/stream','createSession','registry.cn-hangzhou.aliyuncs.com','startsWith','1OdLUsI','./client','@alicloud/tunnel-service20210509','228056bGqjuT','On-demand\x20config\x20put\x20result:\x20','invoke','helperImageVersion','domainName','triggers','throw','close','Start\x20proxy\x20container\x20failed.','setKVInState','stop\x20proxy\x20container'];var a35_0x1f2ea1=a35_0x51f1;(function(_0x48538e,_0x45f6a9){var _0xed2f19=a35_0x51f1;while(!![]){try{var _0x9db3cb=-parseInt(_0xed2f19(0x10c))*parseInt(_0xed2f19(0x132))+parseInt(_0xed2f19(0x14a))+-parseInt(_0xed2f19(0x17b))*parseInt(_0xed2f19(0x12f))+parseInt(_0xed2f19(0xe3))*-parseInt(_0xed2f19(0xb8))+parseInt(_0xed2f19(0x118))*parseInt(_0xed2f19(0x194))+parseInt(_0xed2f19(0xcf))*-parseInt(_0xed2f19(0x141))+-parseInt(_0xed2f19(0xd2))*-parseInt(_0xed2f19(0x11a));if(_0x9db3cb===_0x45f6a9)break;else _0x48538e['push'](_0x48538e['shift']());}catch(_0x2fa653){_0x48538e['push'](_0x48538e['shift']());}}}(a35_0x2cf3,0xec23f));function a35_0x51f1(_0x570b8b,_0x3d7199){return a35_0x51f1=function(_0x2cf330,_0x51f1fe){_0x2cf330=_0x2cf330-0xa1;var _0x596962=a35_0x2cf3[_0x2cf330];return _0x596962;},a35_0x51f1(_0x570b8b,_0x3d7199);}var __createBinding=this&&this[a35_0x1f2ea1(0xa1)]||(Object[a35_0x1f2ea1(0xa5)]?function(_0x46c8b0,_0x1f9bc0,_0xb6a0e7,_0x42a0f3){var _0x4af592=a35_0x1f2ea1;if(_0x42a0f3===undefined)_0x42a0f3=_0xb6a0e7;Object[_0x4af592(0x15b)](_0x46c8b0,_0x42a0f3,{'enumerable':!![],'get':function(){return _0x1f9bc0[_0xb6a0e7];}});}:function(_0x3becfd,_0x42afe6,_0x43846b,_0x559b6a){if(_0x559b6a===undefined)_0x559b6a=_0x43846b;_0x3becfd[_0x559b6a]=_0x42afe6[_0x43846b];}),__setModuleDefault=this&&this[a35_0x1f2ea1(0x1a0)]||(Object[a35_0x1f2ea1(0xa5)]?function(_0x379dcf,_0x3b43bb){Object['defineProperty'](_0x379dcf,'default',{'enumerable':!![],'value':_0x3b43bb});}:function(_0x55c891,_0xe0d170){var _0x53cfbb=a35_0x1f2ea1;_0x55c891[_0x53cfbb(0xfa)]=_0xe0d170;}),__importStar=this&&this[a35_0x1f2ea1(0x186)]||function(_0x1f7d46){var _0x2133dc=a35_0x1f2ea1;if(_0x1f7d46&&_0x1f7d46['__esModule'])return _0x1f7d46;var _0x1579e3={};if(_0x1f7d46!=null){for(var _0x3e03bc in _0x1f7d46)if(_0x3e03bc!=='default'&&Object[_0x2133dc(0x191)][_0x2133dc(0x172)](_0x1f7d46,_0x3e03bc))__createBinding(_0x1579e3,_0x1f7d46,_0x3e03bc);}return __setModuleDefault(_0x1579e3,_0x1f7d46),_0x1579e3;},__awaiter=this&&this[a35_0x1f2ea1(0xed)]||function(_0x59e20f,_0x10df5f,_0x5bc936,_0x3caeed){function _0x5ab0fc(_0x385b7e){return _0x385b7e instanceof _0x5bc936?_0x385b7e:new _0x5bc936(function(_0x59a34e){_0x59a34e(_0x385b7e);});}return new(_0x5bc936||(_0x5bc936=Promise))(function(_0x4bcaac,_0x590f75){var _0x46173f=a35_0x51f1;function _0x2eb475(_0x2c9c73){var _0xc87aae=a35_0x51f1;try{_0x557d8c(_0x3caeed[_0xc87aae(0x111)](_0x2c9c73));}catch(_0x162f65){_0x590f75(_0x162f65);}}function _0x507279(_0x137e25){var _0x13b395=a35_0x51f1;try{_0x557d8c(_0x3caeed[_0x13b395(0xd8)](_0x137e25));}catch(_0x261cb8){_0x590f75(_0x261cb8);}}function _0x557d8c(_0x24d642){var _0x4cbe8e=a35_0x51f1;_0x24d642[_0x4cbe8e(0x150)]?_0x4bcaac(_0x24d642[_0x4cbe8e(0x19b)]):_0x5ab0fc(_0x24d642['value'])[_0x4cbe8e(0x11f)](_0x2eb475,_0x507279);}_0x557d8c((_0x3caeed=_0x3caeed[_0x46173f(0x144)](_0x59e20f,_0x10df5f||[]))[_0x46173f(0x111)]());});},__generator=this&&this[a35_0x1f2ea1(0xa6)]||function(_0x53879b,_0x481648){var _0x18f240=a35_0x1f2ea1,_0x41c451={'label':0x0,'sent':function(){if(_0x4b6044[0x0]&0x1)throw _0x4b6044[0x1];return _0x4b6044[0x1];},'trys':[],'ops':[]},_0xe24c42,_0x499f06,_0x4b6044,_0x50b263;return _0x50b263={'next':_0x5b2178(0x0),'throw':_0x5b2178(0x1),'return':_0x5b2178(0x2)},typeof Symbol==='function'&&(_0x50b263[Symbol[_0x18f240(0xbe)]]=function(){return this;}),_0x50b263;function _0x5b2178(_0xebedec){return function(_0x43540b){return _0x4299ca([_0xebedec,_0x43540b]);};}function _0x4299ca(_0x313d66){var _0xe9e302=_0x18f240;if(_0xe24c42)throw new TypeError(_0xe9e302(0xb0));while(_0x41c451)try{if(_0xe24c42=0x1,_0x499f06&&(_0x4b6044=_0x313d66[0x0]&0x2?_0x499f06[_0xe9e302(0x130)]:_0x313d66[0x0]?_0x499f06['throw']||((_0x4b6044=_0x499f06[_0xe9e302(0x130)])&&_0x4b6044['call'](_0x499f06),0x0):_0x499f06[_0xe9e302(0x111)])&&!(_0x4b6044=_0x4b6044[_0xe9e302(0x172)](_0x499f06,_0x313d66[0x1]))['done'])return _0x4b6044;if(_0x499f06=0x0,_0x4b6044)_0x313d66=[_0x313d66[0x0]&0x2,_0x4b6044[_0xe9e302(0x19b)]];switch(_0x313d66[0x0]){case 0x0:case 0x1:_0x4b6044=_0x313d66;break;case 0x4:_0x41c451[_0xe9e302(0x185)]++;return{'value':_0x313d66[0x1],'done':![]};case 0x5:_0x41c451[_0xe9e302(0x185)]++,_0x499f06=_0x313d66[0x1],_0x313d66=[0x0];continue;case 0x7:_0x313d66=_0x41c451[_0xe9e302(0x19f)][_0xe9e302(0xac)](),_0x41c451[_0xe9e302(0xf1)][_0xe9e302(0xac)]();continue;default:if(!(_0x4b6044=_0x41c451[_0xe9e302(0xf1)],_0x4b6044=_0x4b6044[_0xe9e302(0x15a)]>0x0&&_0x4b6044[_0x4b6044[_0xe9e302(0x15a)]-0x1])&&(_0x313d66[0x0]===0x6||_0x313d66[0x0]===0x2)){_0x41c451=0x0;continue;}if(_0x313d66[0x0]===0x3&&(!_0x4b6044||_0x313d66[0x1]>_0x4b6044[0x0]&&_0x313d66[0x1]<_0x4b6044[0x3])){_0x41c451[_0xe9e302(0x185)]=_0x313d66[0x1];break;}if(_0x313d66[0x0]===0x6&&_0x41c451['label']<_0x4b6044[0x1]){_0x41c451[_0xe9e302(0x185)]=_0x4b6044[0x1],_0x4b6044=_0x313d66;break;}if(_0x4b6044&&_0x41c451[_0xe9e302(0x185)]<_0x4b6044[0x2]){_0x41c451[_0xe9e302(0x185)]=_0x4b6044[0x2],_0x41c451['ops'][_0xe9e302(0x127)](_0x313d66);break;}if(_0x4b6044[0x2])_0x41c451[_0xe9e302(0x19f)][_0xe9e302(0xac)]();_0x41c451['trys']['pop']();continue;}_0x313d66=_0x481648[_0xe9e302(0x172)](_0x53879b,_0x41c451);}catch(_0x160bed){_0x313d66=[0x6,_0x160bed],_0x499f06=0x0;}finally{_0xe24c42=_0x4b6044=0x0;}if(_0x313d66[0x0]&0x5)throw _0x313d66[0x1];return{'value':_0x313d66[0x0]?_0x313d66[0x1]:void 0x0,'done':!![]};}},__importDefault=this&&this['__importDefault']||function(_0x3224e8){var _0x42509a=a35_0x1f2ea1;return _0x3224e8&&_0x3224e8[_0x42509a(0x126)]?_0x3224e8:{'default':_0x3224e8};};Object[a35_0x1f2ea1(0x15b)](exports,a35_0x1f2ea1(0x126),{'value':!![]});var logger_1=__importDefault(require('../common/logger')),core=__importStar(require(a35_0x1f2ea1(0x180))),client_1=require(a35_0x1f2ea1(0xd0)),lodash_1=__importDefault(require(a35_0x1f2ea1(0x16e))),fc_deploy_1=require(a35_0x1f2ea1(0x16c)),time_1=require(a35_0x1f2ea1(0x19a)),docker_1=require(a35_0x1f2ea1(0x14c)),nested_object_assign_1=__importDefault(require('nested-object-assign')),utils_1=require('./utils/utils'),path=__importStar(require('path')),os=__importStar(require('os')),fse=__importStar(require(a35_0x1f2ea1(0xf9))),tunnel_service20210509_1=require(a35_0x1f2ea1(0xd1)),tunnel_service20210509_2=__importDefault(require(a35_0x1f2ea1(0xd1))),definition_1=require(a35_0x1f2ea1(0x119)),process_1=require('./utils/process'),stream_1=require(a35_0x1f2ea1(0xcb)),fc_remote_invoke_1=require(a35_0x1f2ea1(0x193)),devs_1=require(a35_0x1f2ea1(0x15e)),dockerode_1=__importDefault(require('dockerode')),runtime_1=require('./utils/runtime'),stdout_formatter_1=__importDefault(require(a35_0x1f2ea1(0x114))),docker=new dockerode_1[(a35_0x1f2ea1(0xfa))](),IDE_PYCHARM=a35_0x1f2ea1(0x18f),TunnelService=function(){var _0x8b4eaf=a35_0x1f2ea1;function _0xd17cfe(_0x2f37a7,_0x598db0,_0xf10064,_0x18c6a7,_0x24dd06,_0x2d2afb,_0x46e82a,_0x1b6e93,_0x3a6d1e,_0x3b550e,_0x1aa507){var _0x260be7=a35_0x51f1,_0x4b10d4=this,_0x531984,_0x2f1425;this[_0x260be7(0x138)]=_0x2f37a7,this[_0x260be7(0xdd)]=_0x598db0,this['userFunctionConfig']=_0xf10064,this[_0x260be7(0xe1)]=_0x1b6e93,this[_0x260be7(0xc0)]=_0x3a6d1e;if(!_0xd17cfe[_0x260be7(0x10b)]['includes'](_0x18c6a7))throw new Error('Region:\x20'+_0x18c6a7+'\x20not\x20support\x20now,\x20supported\x20regions:\x20'+_0xd17cfe[_0x260be7(0x10b)]);this[_0x260be7(0x13a)]=_0x3b550e,this[_0x260be7(0xb5)]=_0x1aa507,this['region']=_0x18c6a7,this[_0x260be7(0x17d)]=_0x24dd06,this[_0x260be7(0x106)]=_0x2d2afb,this[_0x260be7(0xde)]=_0x46e82a;var _0x40a6d4={'accessKeyId':(_0x531984=this[_0x260be7(0x138)])===null||_0x531984===void 0x0?void 0x0:_0x531984[_0x260be7(0x179)],'accessKeySecret':(_0x2f1425=this[_0x260be7(0x138)])===null||_0x2f1425===void 0x0?void 0x0:_0x2f1425[_0x260be7(0x196)],'regionId':this[_0x260be7(0x11d)],'endpoint':_0xd17cfe[_0x260be7(0x14f)]};this[_0x260be7(0x122)]=new tunnel_service20210509_2[(_0x260be7(0xfa))](_0x40a6d4),process_1['setSigint'](),process['on']('SIGINT',function(){return __awaiter(_0x4b10d4,void 0x0,void 0x0,function(){var _0x4ce4e1,_0x236a1b,_0x52222a;return __generator(this,function(_0x2073ef){var _0x3bc803=a35_0x51f1;switch(_0x2073ef[_0x3bc803(0x185)]){case 0x0:this['streamOfRunner']&&stream_1[_0x3bc803(0x187)](this[_0x3bc803(0x139)]);if(!this[_0x3bc803(0xdf)])return[0x3,0x3];logger_1[_0x3bc803(0xfa)]['info'](_0x3bc803(0xee));return[0x4,docker_1[_0x3bc803(0x13e)](this[_0x3bc803(0xdf)])];case 0x1:_0x2073ef['sent']();return[0x4,this[_0x3bc803(0xab)]()];case 0x2:_0x2073ef[_0x3bc803(0x133)](),_0x2073ef[_0x3bc803(0x185)]=0x3;case 0x3:_0x4ce4e1=this[_0x3bc803(0x12b)](),_0x236a1b=_0x4ce4e1[_0x3bc803(0x101)],_0x52222a=_0x4ce4e1[_0x3bc803(0xbb)];this['stdoutFileWriteStream']&&this[_0x3bc803(0xb1)]['close'](function(_0x109887){var _0x325e98=_0x3bc803;_0x109887&&logger_1[_0x325e98(0xfa)][_0x325e98(0x1a5)](_0x325e98(0x109)+_0x236a1b+'\x20failed!\x0aError:\x20'+_0x109887);});this[_0x3bc803(0x167)]&&this['stderrFileWriteStream'][_0x3bc803(0xd9)](function(_0x5d2c86){var _0x386575=_0x3bc803;_0x5d2c86&&logger_1['default'][_0x386575(0x1a5)](_0x386575(0x1a1)+_0x52222a+_0x386575(0x182)+_0x5d2c86);});return[0x2];}});});});}return _0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0xf7)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x33ffec,_0x4bf27f,_0x9644bf,_0x19a590,_0x22bb80,_0x213e1d,_0x38e793,_0x3b3ded,_0x47b45f;return __generator(this,function(_0x208946){var _0x91a633=a35_0x51f1;switch(_0x208946[_0x91a633(0x185)]){case 0x0:_0x33ffec=new client_1[(_0x91a633(0x19e))](this['credentials']),_0x4bf27f=this;return[0x4,_0x33ffec['getFcClient'](this[_0x91a633(0x11d)])];case 0x1:_0x4bf27f[_0x91a633(0xa9)]=_0x208946['sent'](),_0x9644bf=core[_0x91a633(0xfd)](_0x91a633(0x19d)),_0x208946[_0x91a633(0x185)]=0x2;case 0x2:_0x208946[_0x91a633(0xf1)][_0x91a633(0x127)]([0x2,0x5,,0x6]),_0x19a590=this;return[0x4,this[_0x91a633(0xcc)]()];case 0x3:_0x19a590[_0x91a633(0x1a2)]=_0x208946[_0x91a633(0x133)](),_0x9644bf[_0x91a633(0x166)]('Session\x20created,\x20session\x20id:\x20'+this['session']['sessionId']+'.');return[0x4,this[_0x91a633(0x153)]()];case 0x4:_0x208946[_0x91a633(0x133)]();return[0x3,0x6];case 0x5:_0x22bb80=_0x208946['sent'](),_0x9644bf[_0x91a633(0x181)](_0x91a633(0x14d));throw _0x22bb80;case 0x6:logger_1['default']['info'](_0x91a633(0xf4));return[0x4,this['makeHelperFunction']()];case 0x7:_0x208946[_0x91a633(0x133)](),_0x213e1d=core[_0x91a633(0xfd)]('Starting\x20proxy\x20container...'),_0x208946[_0x91a633(0x185)]=0x8;case 0x8:_0x208946[_0x91a633(0xf1)][_0x91a633(0x127)]([0x8,0xa,,0xb]);return[0x4,this[_0x91a633(0xa3)]()];case 0x9:_0x208946[_0x91a633(0x133)](),_0x213e1d[_0x91a633(0x166)]('Proxy\x20container\x20is\x20running.');return[0x3,0xb];case 0xa:_0x38e793=_0x208946[_0x91a633(0x133)](),_0x213e1d['fail'](_0x91a633(0xda));throw _0x38e793;case 0xb:_0x3b3ded=core[_0x91a633(0xfd)](_0x91a633(0x142)),_0x208946[_0x91a633(0x185)]=0xc;case 0xc:_0x208946[_0x91a633(0xf1)][_0x91a633(0x127)]([0xc,0xe,,0xf]);return[0x4,this['queryUntilSessionEstablished']()];case 0xd:_0x208946[_0x91a633(0x133)](),_0x3b3ded[_0x91a633(0x166)]('Session\x20established!');return[0x3,0xf];case 0xe:_0x47b45f=_0x208946['sent'](),_0x3b3ded[_0x91a633(0x181)](_0x91a633(0x165));throw _0x47b45f;case 0xf:return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x163)]=function(){var _0x150cf7=_0x8b4eaf;return _0x150cf7(0x15f)+this['region']+'_'+this[_0x150cf7(0xdd)][_0x150cf7(0xf6)];},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0xcc)]=function(){var _0xe15be4;return __awaiter(this,void 0x0,void 0x0,function(){var _0x1340fc,_0x2bea42,_0x3d982e,_0x36ce3c;return __generator(this,function(_0x5d4e04){var _0x204895=a35_0x51f1;switch(_0x5d4e04[_0x204895(0x185)]){case 0x0:_0x1340fc=this['generateSessionName'](),_0x2bea42=new tunnel_service20210509_1[(_0x204895(0x18b))]({'sessionName':_0x1340fc}),logger_1[_0x204895(0xfa)][_0x204895(0xf0)](_0x204895(0x102)+_0x1340fc);return[0x4,this[_0x204895(0x122)]['createSession'](_0x2bea42)];case 0x1:_0x3d982e=_0x5d4e04['sent'](),_0x36ce3c=(_0xe15be4=_0x3d982e===null||_0x3d982e===void 0x0?void 0x0:_0x3d982e[_0x204895(0xc4)])===null||_0xe15be4===void 0x0?void 0x0:_0xe15be4[_0x204895(0x104)],logger_1[_0x204895(0xfa)][_0x204895(0xf0)](_0x204895(0x148)+JSON[_0x204895(0x140)](_0x36ce3c,null,'\x20\x20'));return[0x2,{'name':_0x36ce3c===null||_0x36ce3c===void 0x0?void 0x0:_0x36ce3c['sessionName'],'sessionId':_0x36ce3c===null||_0x36ce3c===void 0x0?void 0x0:_0x36ce3c[_0x204895(0x17c)],'localInstanceId':_0x36ce3c===null||_0x36ce3c===void 0x0?void 0x0:_0x36ce3c[_0x204895(0x10f)],'remoteInstanceId':_0x36ce3c===null||_0x36ce3c===void 0x0?void 0x0:_0x36ce3c[_0x204895(0x128)]}];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x17e)]=function(_0x4910df){return __awaiter(this,void 0x0,void 0x0,function(){var _0x68aae7,_0x38d15d;return __generator(this,function(_0x4423be){var _0x5311d1=a35_0x51f1;switch(_0x4423be[_0x5311d1(0x185)]){case 0x0:return[0x4,this[_0x5311d1(0x122)][_0x5311d1(0x17e)](_0x4910df)];case 0x1:_0x68aae7=_0x4423be[_0x5311d1(0x133)](),_0x38d15d=_0x68aae7===null||_0x68aae7===void 0x0?void 0x0:_0x68aae7[_0x5311d1(0xc4)],logger_1[_0x5311d1(0xfa)]['debug'](_0x5311d1(0x125)+JSON['stringify'](_0x38d15d,null,'\x20\x20'));return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x10e)]=function(){var _0x4b9e21=_0x8b4eaf,_0x4696a6,_0x37652b=lodash_1[_0x4b9e21(0xfa)][_0x4b9e21(0xb3)](this[_0x4b9e21(0xdd)]);return _0x37652b[_0x4b9e21(0xf6)]=_0x4b9e21(0xc9)+((_0x4696a6=this[_0x4b9e21(0x1a2)])===null||_0x4696a6===void 0x0?void 0x0:_0x4696a6[_0x4b9e21(0x17c)][_0x4b9e21(0x17f)](0x0,0x7)),_0x37652b[_0x4b9e21(0x178)]=!![],definition_1[_0x4b9e21(0x147)](_0x37652b===null||_0x37652b===void 0x0?void 0x0:_0x37652b['nasConfig'])&&delete _0x37652b['nasConfig'],_0x37652b;},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x129)]=function(){var _0x4236e5=_0x8b4eaf,_0x3de2af=this,_0x29f0a0,_0x7bfe22,_0x1022f1,_0x401ffc,_0x5562c9,_0x22153c,_0x3b6569,_0x2bcc95,_0x41d111,_0x5219e2,_0x210380,_0x5889bc,_0x114fc5={'name':(_0x29f0a0=this[_0x4236e5(0x195)])===null||_0x29f0a0===void 0x0?void 0x0:_0x29f0a0[_0x4236e5(0xf6)],'description':_0x4236e5(0xba),'runtime':_0x4236e5(0xea),'handler':(_0x7bfe22=this[_0x4236e5(0x195)])===null||_0x7bfe22===void 0x0?void 0x0:_0x7bfe22[_0x4236e5(0xef)],'timeout':0x258,'memorySize':0x200,'customContainerConfig':{'image':_0x4236e5(0xe0)+this[_0x4236e5(0x11d)]+'.aliyuncs.com/aliyunfc/ts-remote:'+_0xd17cfe[_0x4236e5(0xd5)]},'environmentVariables':{'TUNNEL_SERVICE_HOST':_0xd17cfe['tunnerServiceHost'],'TUNNEL_SERVICE_INSTANCE_ID':(_0x1022f1=this['session'])===null||_0x1022f1===void 0x0?void 0x0:_0x1022f1['remoteInstanceId'],'TUNNEL_SERVICE_SESSION_ID':(_0x401ffc=this[_0x4236e5(0x1a2)])===null||_0x401ffc===void 0x0?void 0x0:_0x401ffc[_0x4236e5(0x17c)],'TUNNEL_SERVICE_AK_ID':(_0x5562c9=this['credentials'])===null||_0x5562c9===void 0x0?void 0x0:_0x5562c9[_0x4236e5(0x179)],'TUNNEL_SERVICE_AK_SECRET':(_0x22153c=this[_0x4236e5(0x138)])===null||_0x22153c===void 0x0?void 0x0:_0x22153c[_0x4236e5(0x196)]}};return!lodash_1['default']['isEmpty'](definition_1[_0x4236e5(0xa7)](this[_0x4236e5(0xe1)]))&&_0xd17cfe['runtimeListNeedSetTsAdjustFLag'][_0x4236e5(0x11e)](function(_0x574b46){var _0x1d3cac=_0x4236e5,_0xf0f369;((_0xf0f369=_0x3de2af[_0x1d3cac(0x195)])===null||_0xf0f369===void 0x0?void 0x0:_0xf0f369[_0x1d3cac(0x12d)]['indexOf'](_0x574b46))!==-0x1&&Object['assign'](_0x114fc5[_0x1d3cac(0x14b)],{'TS_DEBUG_HTTP_TRIGGER_ADJUST':!![]});}),((_0x3b6569=this['userFunctionConfig'])===null||_0x3b6569===void 0x0?void 0x0:_0x3b6569[_0x4236e5(0x103)])&&((_0x2bcc95=this[_0x4236e5(0x195)])===null||_0x2bcc95===void 0x0?void 0x0:_0x2bcc95[_0x4236e5(0x131)])&&Object[_0x4236e5(0xaf)](_0x114fc5,{'initializationTimeout':(_0x41d111=this['userFunctionConfig'])===null||_0x41d111===void 0x0?void 0x0:_0x41d111['initializationTimeout'],'initializer':(_0x5219e2=this[_0x4236e5(0x195)])===null||_0x5219e2===void 0x0?void 0x0:_0x5219e2[_0x4236e5(0x131)]}),((_0x210380=this[_0x4236e5(0x195)])===null||_0x210380===void 0x0?void 0x0:_0x210380[_0x4236e5(0xc8)])&&Object[_0x4236e5(0xaf)](_0x114fc5,{'instanceLifecycleConfig':(_0x5889bc=this[_0x4236e5(0x195)])===null||_0x5889bc===void 0x0?void 0x0:_0x5889bc[_0x4236e5(0xc8)]}),_0x114fc5;},_0xd17cfe[_0x8b4eaf(0x176)]['genHelperCustomDomainConfig']=function(){var _0x2c14c9=_0x8b4eaf,_0x1dd33c=this;if(lodash_1[_0x2c14c9(0xfa)][_0x2c14c9(0xc1)](this['userCustomDomainConfigList']))return[];var _0x13affb=[];for(var _0x4f10eb=0x0,_0x5bb133=this[_0x2c14c9(0xc0)];_0x4f10eb<_0x5bb133[_0x2c14c9(0x15a)];_0x4f10eb++){var _0x4d3f71=_0x5bb133[_0x4f10eb],_0x151c94=_0x4d3f71===null||_0x4d3f71===void 0x0?void 0x0:_0x4d3f71['routeConfigs'][_0x2c14c9(0xe9)](function(_0x20ff35){var _0x13eaa4=_0x2c14c9,_0x4e6859,_0x45692c;if((_0x20ff35===null||_0x20ff35===void 0x0?void 0x0:_0x20ff35[_0x13eaa4(0x164)])&&(_0x20ff35===null||_0x20ff35===void 0x0?void 0x0:_0x20ff35['serviceName'])===((_0x4e6859=_0x1dd33c['userServiceConfig'])===null||_0x4e6859===void 0x0?void 0x0:_0x4e6859[_0x13eaa4(0xf6)])&&(_0x20ff35===null||_0x20ff35===void 0x0?void 0x0:_0x20ff35['functionName'])&&(_0x20ff35===null||_0x20ff35===void 0x0?void 0x0:_0x20ff35['functionName'])===((_0x45692c=_0x1dd33c[_0x13eaa4(0x195)])===null||_0x45692c===void 0x0?void 0x0:_0x45692c[_0x13eaa4(0xf6)])){var _0x259e8c=lodash_1[_0x13eaa4(0xfa)][_0x13eaa4(0xb3)](_0x20ff35);return _0x259e8c===null||_0x259e8c===void 0x0?!![]:delete _0x259e8c['serviceName'],_0x259e8c===null||_0x259e8c===void 0x0?!![]:delete _0x259e8c[_0x13eaa4(0x159)],_0x259e8c;}if(!(_0x20ff35===null||_0x20ff35===void 0x0?void 0x0:_0x20ff35[_0x13eaa4(0x164)])&&!(_0x20ff35===null||_0x20ff35===void 0x0?void 0x0:_0x20ff35['functionName']))return _0x20ff35;}),_0x27c596={'domainName':_0x4d3f71===null||_0x4d3f71===void 0x0?void 0x0:_0x4d3f71[_0x2c14c9(0xd6)],'protocol':_0x4d3f71===null||_0x4d3f71===void 0x0?void 0x0:_0x4d3f71['protocol'],'routeConfigs':_0x151c94};(_0x4d3f71===null||_0x4d3f71===void 0x0?void 0x0:_0x4d3f71[_0x2c14c9(0x198)])&&Object[_0x2c14c9(0xaf)](_0x27c596,{'certConfig':_0x27c596===null||_0x27c596===void 0x0?void 0x0:_0x27c596['certConfig']}),_0x13affb[_0x2c14c9(0x127)](_0x27c596);}return _0x13affb;},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x134)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x1f87d6,_0x532b9a,_0x43d013,_0x3dbb03,_0x507832,_0x5ac99d,_0x559958,_0xfc6f24,_0x5d1328,_0x5c15cb;return __generator(this,function(_0x3293d6){var _0x294b8d=a35_0x51f1;switch(_0x3293d6[_0x294b8d(0x185)]){case 0x0:_0x1f87d6=this[_0x294b8d(0x10e)](),_0x532b9a=this[_0x294b8d(0x129)](),_0x43d013=this[_0x294b8d(0xe1)],_0x3dbb03=this[_0x294b8d(0xc6)](),_0x507832=new fc_deploy_1[(_0x294b8d(0x11b))](this['region'],_0x1f87d6,this['access'],this[_0x294b8d(0x106)],this[_0x294b8d(0xde)],_0x532b9a,_0x43d013,_0x3dbb03),_0x5ac99d=_0x507832[_0x294b8d(0x15d)](_0x294b8d(0x174),_0x294b8d(0x151),'','deploy');return[0x4,core[_0x294b8d(0x124)]('devsapp/fc-deploy')];case 0x1:_0x559958=_0x3293d6['sent']();return[0x4,_0x559958[_0x294b8d(0x162)](_0x5ac99d)];case 0x2:_0xfc6f24=_0x3293d6[_0x294b8d(0x133)]();return[0x4,this['saveHelperFunctionDeployRes'](_0xfc6f24)];case 0x3:_0x3293d6[_0x294b8d(0x133)](),_0x5d1328=core[_0x294b8d(0xfd)]('Setting\x20helper\x20function\x20with\x201\x20provison\x20and\x200\x20elasticity'),_0x3293d6['label']=0x4;case 0x4:_0x3293d6[_0x294b8d(0xf1)][_0x294b8d(0x127)]([0x4,0x6,,0x7]);return[0x4,this[_0x294b8d(0xc2)](_0x1f87d6['name'],_0x532b9a[_0x294b8d(0xf6)])];case 0x5:_0x3293d6[_0x294b8d(0x133)](),_0x5d1328[_0x294b8d(0x166)]('Helper\x20function\x20is\x20set\x20to\x201\x20provison\x20and\x200\x20elasticity.');return[0x3,0x7];case 0x6:_0x5c15cb=_0x3293d6['sent'](),_0x5d1328['fail'](_0x294b8d(0x192));throw _0x5c15cb;case 0x7:return[0x2];}});});},_0xd17cfe['prototype']['saveHelperFunctionDeployRes']=function(_0x6c2f39){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x9a1cdf){var _0x5c7e15=a35_0x51f1;switch(_0x9a1cdf[_0x5c7e15(0x185)]){case 0x0:return[0x4,devs_1[_0x5c7e15(0xdb)](_0x5c7e15(0xc3),_0x6c2f39,this[_0x5c7e15(0xec)]())];case 0x1:_0x9a1cdf[_0x5c7e15(0x133)]();return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x153)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x4a4e2f){var _0x5bfe2d=a35_0x51f1;switch(_0x4a4e2f[_0x5bfe2d(0x185)]){case 0x0:return[0x4,devs_1[_0x5bfe2d(0xdb)](_0x5bfe2d(0x1a2),this[_0x5bfe2d(0x1a2)],this[_0x5bfe2d(0xec)]())];case 0x1:_0x4a4e2f[_0x5bfe2d(0x133)]();return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0xec)]=function(){var _0x4aa969=_0x8b4eaf,_0x65dbd8,_0x3797f0;return this[_0x4aa969(0x138)][_0x4aa969(0x16d)]+'-'+this['region']+'-'+((_0x65dbd8=this[_0x4aa969(0xdd)])===null||_0x65dbd8===void 0x0?void 0x0:_0x65dbd8[_0x4aa969(0xf6)])+'-'+((_0x3797f0=this[_0x4aa969(0x195)])===null||_0x3797f0===void 0x0?void 0x0:_0x3797f0[_0x4aa969(0xf6)]);},_0xd17cfe[_0x8b4eaf(0x176)]['setHelperFunctionProvision']=function(_0x48b422,_0x540aa0,_0x1b75f4,_0x3edaf8){var _0xaba324,_0x5d17e8;return __awaiter(this,void 0x0,void 0x0,function(){var _0x1aac3b,_0x4fa690,_0x4cb24a,_0x3f4710,_0x386f19,_0x5dd8e6;return __generator(this,function(_0x3594f5){var _0x1052b2=a35_0x51f1;switch(_0x3594f5[_0x1052b2(0x185)]){case 0x0:_0x1aac3b=_0x3edaf8||'LATEST';if(!!this[_0x1052b2(0xa9)])return[0x3,0x2];_0x4fa690=new client_1[(_0x1052b2(0x19e))](this[_0x1052b2(0x138)]),_0x4cb24a=this;return[0x4,_0x4fa690[_0x1052b2(0x1a6)](this[_0x1052b2(0x11d)])];case 0x1:_0x4cb24a[_0x1052b2(0xa9)]=_0x3594f5[_0x1052b2(0x133)](),_0x3594f5[_0x1052b2(0x185)]=0x2;case 0x2:_0x3594f5['trys'][_0x1052b2(0x127)]([0x2,0x4,,0x5]);return[0x4,this[_0x1052b2(0xa9)][_0x1052b2(0x188)](_0x48b422,_0x540aa0,_0x1aac3b,{'target':_0x1b75f4})];case 0x3:_0x3594f5['sent']();return[0x3,0x5];case 0x4:_0x3f4710=_0x3594f5['sent']();throw new Error(_0x1052b2(0x183)+_0x3f4710+_0x1052b2(0x112));case 0x5:return[0x4,this[_0x1052b2(0xa9)][_0x1052b2(0xe5)](_0x48b422,_0x540aa0,_0x1aac3b)];case 0x6:_0x386f19=_0x3594f5[_0x1052b2(0x133)](),_0x5dd8e6=0x0,_0x3594f5[_0x1052b2(0x185)]=0x7;case 0x7:if(!(((_0xaba324=_0x386f19===null||_0x386f19===void 0x0?void 0x0:_0x386f19[_0x1052b2(0x104)])===null||_0xaba324===void 0x0?void 0x0:_0xaba324['current'])!==0x1&&_0x5dd8e6<=_0xd17cfe[_0x1052b2(0x169)]))return[0x3,0xa];return[0x4,this[_0x1052b2(0xa9)]['getProvisionConfig'](_0x48b422,_0x540aa0,_0x1aac3b)];case 0x8:_0x386f19=_0x3594f5[_0x1052b2(0x133)](),_0x5dd8e6=_0x5dd8e6+0x1,logger_1[_0x1052b2(0xfa)][_0x1052b2(0xf0)]('Retry\x20setting\x20provision\x20'+_0x5dd8e6+_0x1052b2(0xb7));return[0x4,time_1[_0x1052b2(0xb2)](0x3e8)];case 0x9:_0x3594f5[_0x1052b2(0x133)]();return[0x3,0x7];case 0xa:if(((_0x5d17e8=_0x386f19===null||_0x386f19===void 0x0?void 0x0:_0x386f19[_0x1052b2(0x104)])===null||_0x5d17e8===void 0x0?void 0x0:_0x5d17e8[_0x1052b2(0x16a)])!==0x1){logger_1['default']['debug'](JSON[_0x1052b2(0x140)](_0x386f19,null,'\x20\x20'));throw new Error(_0x1052b2(0x13b));}logger_1[_0x1052b2(0xfa)][_0x1052b2(0xf0)]('Set\x20provision\x20result:\x20'+JSON[_0x1052b2(0x140)](_0x386f19===null||_0x386f19===void 0x0?void 0x0:_0x386f19[_0x1052b2(0x104)]));return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x168)]=function(_0x2c4e63,_0x407fa5,_0x17067b){return __awaiter(this,void 0x0,void 0x0,function(){var _0x3f76da,_0x3a5a2b,_0x35dc0d,_0x4d0693,_0xa99b25;return __generator(this,function(_0x12f425){var _0xa14416=a35_0x51f1;switch(_0x12f425['label']){case 0x0:return[0x4,this['setHelperFunctionProvision'](_0x2c4e63,_0x407fa5,0x0,_0x17067b)];case 0x1:_0x12f425[_0xa14416(0x133)](),_0x3f76da=_0xa14416(0xbc),_0x3a5a2b=_0xa14416(0xf5)+_0x2c4e63+'.'+_0x17067b+'/functions/'+_0x407fa5+'/on-demand-config';if(!!this[_0xa14416(0x122)])return[0x3,0x3];_0x35dc0d=new client_1[(_0xa14416(0x19e))](this['credentials']),_0x4d0693=this;return[0x4,_0x35dc0d[_0xa14416(0x1a6)](this['region'])];case 0x2:_0x4d0693[_0xa14416(0xa9)]=_0x12f425[_0xa14416(0x133)](),_0x12f425[_0xa14416(0x185)]=0x3;case 0x3:return[0x4,this['fcClient'][_0xa14416(0x17a)](_0x3f76da,_0x3a5a2b,null,JSON[_0xa14416(0x140)]({}))];case 0x4:_0xa99b25=_0x12f425['sent'](),logger_1[_0xa14416(0xfa)][_0xa14416(0xf0)](_0xa14416(0xa4)+(_0xa99b25===null||_0xa99b25===void 0x0?void 0x0:_0xa99b25[_0xa14416(0x15c)]));return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)]['setHelperFunctionConfig']=function(_0x55ac62,_0x41e4d8){return __awaiter(this,void 0x0,void 0x0,function(){var _0x622f3f,_0xbe9f,_0x1108e0,_0x47c13f,_0x182f49,_0x5e1a78;return __generator(this,function(_0xdd80e8){var _0x5337cb=a35_0x51f1;switch(_0xdd80e8[_0x5337cb(0x185)]){case 0x0:_0x622f3f=_0x5337cb(0xb9);return[0x4,this['setHelperFunctionProvision'](_0x55ac62,_0x41e4d8,0x1,_0x622f3f)];case 0x1:_0xdd80e8[_0x5337cb(0x133)](),_0xbe9f='PUT',_0x1108e0=_0x5337cb(0xf5)+_0x55ac62+'.'+_0x622f3f+'/functions/'+_0x41e4d8+'/on-demand-config';if(!!this[_0x5337cb(0xa9)])return[0x3,0x3];_0x47c13f=new client_1[(_0x5337cb(0x19e))](this['credentials']),_0x182f49=this;return[0x4,_0x47c13f[_0x5337cb(0x1a6)](this[_0x5337cb(0x11d)])];case 0x2:_0x182f49[_0x5337cb(0xa9)]=_0xdd80e8[_0x5337cb(0x133)](),_0xdd80e8[_0x5337cb(0x185)]=0x3;case 0x3:return[0x4,this['fcClient'][_0x5337cb(0x17a)](_0xbe9f,_0x1108e0,null,JSON['stringify']({'maximumInstanceCount':0x0}))];case 0x4:_0x5e1a78=_0xdd80e8['sent'](),logger_1[_0x5337cb(0xfa)][_0x5337cb(0xf0)](_0x5337cb(0xd3)+(_0x5e1a78===null||_0x5e1a78===void 0x0?void 0x0:_0x5e1a78[_0x5337cb(0x15c)]));return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x12b)]=function(){var _0x39b7d2=_0x8b4eaf,_0x1da455;if(!lodash_1[_0x39b7d2(0xfa)][_0x39b7d2(0xc1)](this[_0x39b7d2(0x1a2)])){var _0x46876d=path['join'](_0xd17cfe[_0x39b7d2(0x197)],(_0x1da455=this['session'])===null||_0x1da455===void 0x0?void 0x0:_0x1da455[_0x39b7d2(0x17c)]),_0x19aa34=path['join'](_0x46876d,_0x39b7d2(0x12a)),_0x22d5f0=path[_0x39b7d2(0x152)](_0x46876d,'stderr.log');return{'stdoutFilePath':_0x19aa34,'stderrFilePath':_0x22d5f0};}return{};},_0xd17cfe[_0x8b4eaf(0x176)]['runProxyContainer']=function(){var _0x4cbc78;return __awaiter(this,void 0x0,void 0x0,function(){var _0x11ab26,_0x31610e,_0x59b1d7,_0x504323,_0x5d57a4;return __generator(this,function(_0x2393be){var _0x51c6af=a35_0x51f1;switch(_0x2393be['label']){case 0x0:return[0x4,docker_1[_0x51c6af(0x199)](_0xd17cfe['proxyImaggeRegistry'],_0xd17cfe['proxyImageRepo'],_0xd17cfe['proxyImageName'],_0xd17cfe[_0x51c6af(0x107)])];case 0x1:_0x2393be['sent'](),_0x11ab26=this[_0x51c6af(0xfe)](),(_0x31610e=this['genOutputFileOfProxyContainer'](),_0x59b1d7=_0x31610e[_0x51c6af(0x101)],_0x504323=_0x31610e[_0x51c6af(0xbb)]);return[0x4,fse[_0x51c6af(0x19c)](path[_0x51c6af(0x149)](_0x59b1d7))];case 0x2:_0x2393be['sent'](),logger_1[_0x51c6af(0xfa)][_0x51c6af(0xf0)](_0x51c6af(0x121)+(_0x11ab26===null||_0x11ab26===void 0x0?void 0x0:_0x11ab26[_0x51c6af(0xf6)])+_0x51c6af(0x1a3)+_0x59b1d7+_0x51c6af(0x146)+_0x504323),this['stdoutFileWriteStream']=fse['createWriteStream'](_0x59b1d7,{'flag':'w+','encoding':_0x51c6af(0x108),'autoClose':!![]}),this[_0x51c6af(0x167)]=fse[_0x51c6af(0x136)](_0x504323,{'flag':'w+','encoding':_0x51c6af(0x108),'autoClose':!![]});return[0x4,docker_1['runContainer'](_0x11ab26,this[_0x51c6af(0xb1)],this[_0x51c6af(0x167)])];case 0x3:_0x5d57a4=_0x2393be['sent'](),this['streamOfRunner']=_0x5d57a4===null||_0x5d57a4===void 0x0?void 0x0:_0x5d57a4['stream'],this[_0x51c6af(0xdf)]=_0x5d57a4===null||_0x5d57a4===void 0x0?void 0x0:_0x5d57a4[_0x51c6af(0x143)];return[0x4,this[_0x51c6af(0xae)]((_0x4cbc78=this[_0x51c6af(0xdf)])===null||_0x4cbc78===void 0x0?void 0x0:_0x4cbc78['id'])];case 0x4:_0x2393be[_0x51c6af(0x133)]();return[0x2];}});});},_0xd17cfe['prototype'][_0x8b4eaf(0xae)]=function(_0x2665bd){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x1134ef){var _0x138e33=a35_0x51f1;switch(_0x1134ef[_0x138e33(0x185)]){case 0x0:return[0x4,devs_1[_0x138e33(0xdb)](_0x138e33(0x115),_0x2665bd,this[_0x138e33(0xec)]())];case 0x1:_0x1134ef['sent']();return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)]['unsetProxyContainerId']=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x240ead){var _0x9c99ab=a35_0x51f1;switch(_0x240ead[_0x9c99ab(0x185)]){case 0x0:return[0x4,devs_1[_0x9c99ab(0xca)](_0x9c99ab(0x115),this[_0x9c99ab(0xec)]())];case 0x1:_0x240ead['sent']();return[0x2];}});});},_0xd17cfe['prototype'][_0x8b4eaf(0x18d)]=function(){var _0x3afaf2=_0x8b4eaf,_0x5c5dec,_0xd0bffa,_0x2ceb14,_0x360dc3=(_0x2ceb14=this['userFunctionConfig'])===null||_0x2ceb14===void 0x0?void 0x0:_0x2ceb14[_0x3afaf2(0x12d)];if(runtime_1[_0x3afaf2(0x156)](_0x360dc3))return{};var _0x108bd5=this[_0x3afaf2(0x13a)]+_0x3afaf2(0xfb);if(this['debugIde']===IDE_PYCHARM){if(_0x360dc3!=='python2.7'&&_0x360dc3!=='python3')throw new Error(IDE_PYCHARM+_0x3afaf2(0xa2));else return{};}else return _0x360dc3===_0x3afaf2(0x123)?{}:{'ExposedPorts':(_0x5c5dec={},_0x5c5dec[_0x108bd5]={},_0x5c5dec),'HostConfig':{'PortBindings':(_0xd0bffa={},_0xd0bffa[_0x108bd5]=[{'HostIp':'','HostPort':''+this[_0x3afaf2(0x13a)]}],_0xd0bffa)}};},_0xd17cfe[_0x8b4eaf(0x176)]['generateProxyContainerOpts']=function(){var _0x397f3b=_0x8b4eaf,_0x1e3151,_0x2f654c=_0xd17cfe['proxyImaggeRegistry']+'/'+_0xd17cfe['proxyImageRepo']+'/'+_0xd17cfe['proxyImageName']+':'+_0xd17cfe[_0x397f3b(0x107)],_0x3af000=definition_1['genProxyContainerName']((_0x1e3151=this[_0x397f3b(0x1a2)])===null||_0x1e3151===void 0x0?void 0x0:_0x1e3151[_0x397f3b(0x17c)]),_0x302784={'OpenStdin':![],'Tty':![],'StdinOnce':!![],'AttachStdin':!![],'AttachStdout':!![],'AttachStderr':!![]},_0x3890e1={'HostConfig':{'AutoRemove':!![],'Privileged':!![],'Mounts':[]}},_0x5ba4bf={};this[_0x397f3b(0x13a)]&&(_0x5ba4bf=this[_0x397f3b(0x18d)]());var _0x351e5c=nested_object_assign_1['default']({'Env':this[_0x397f3b(0x12e)](),'Image':_0x2f654c,'name':_0x3af000,'User':_0x397f3b(0x110)},_0x302784,_0x3890e1,_0x5ba4bf),_0x18f83f=lodash_1['default'][_0x397f3b(0xb3)](_0x351e5c);if(_0x18f83f===null||_0x18f83f===void 0x0?void 0x0:_0x18f83f[_0x397f3b(0xbf)]){var _0x55805d=_0x18f83f[_0x397f3b(0xbf)]['map'](function(_0x42e217){var _0x24431b=_0x397f3b;if(_0x42e217['startsWith']('TUNNEL_SERVICE_AK_ID')||_0x42e217[_0x24431b(0xce)](_0x24431b(0x171))){var _0x154566=_0x42e217[_0x24431b(0x18c)]('='),_0x5f240f=utils_1[_0x24431b(0xaa)](_0x154566[0x1]);return _0x154566[0x0]+'='+_0x5f240f;}else return _0x42e217;});_0x18f83f[_0x397f3b(0xbf)]=_0x55805d;}return logger_1['default'][_0x397f3b(0xf0)](_0x397f3b(0xad)+JSON['stringify'](_0x18f83f,null,'\x20\x20')),_0x351e5c;},_0xd17cfe['prototype']['generateProxyContainerEnv']=function(){var _0x228a79=_0x8b4eaf,_0x303630,_0x9d266d,_0x8f8316,_0x467d8b,_0x840bfc={'TUNNEL_SERVICE_HOST':_0xd17cfe[_0x228a79(0x14f)],'TUNNEL_SERVICE_SESSION_ID':(_0x303630=this[_0x228a79(0x1a2)])===null||_0x303630===void 0x0?void 0x0:_0x303630['sessionId'],'TUNNEL_SERVICE_INSTANCE_ID':(_0x9d266d=this['session'])===null||_0x9d266d===void 0x0?void 0x0:_0x9d266d[_0x228a79(0x10f)],'TUNNEL_SERVICE_AK_ID':(_0x8f8316=this['credentials'])===null||_0x8f8316===void 0x0?void 0x0:_0x8f8316['AccessKeyID'],'TUNNEL_SERVICE_AK_SECRET':(_0x467d8b=this[_0x228a79(0x138)])===null||_0x467d8b===void 0x0?void 0x0:_0x467d8b[_0x228a79(0x196)]};return lodash_1['default'][_0x228a79(0xe9)](_0x840bfc||{},function(_0x3545a8,_0x302689){return _0x302689+'='+_0x3545a8;});},_0xd17cfe[_0x8b4eaf(0x176)]['queryUntilSessionEstablished']=function(){var _0x2f3e23,_0x274acc,_0x5ae61b,_0x42cc8f,_0xad9784,_0x30234e;return __awaiter(this,void 0x0,void 0x0,function(){var _0x3e7605,_0x27a6d9,_0x1504e8;return __generator(this,function(_0x27b7d7){var _0x4e10c4=a35_0x51f1;switch(_0x27b7d7['label']){case 0x0:return[0x4,this[_0x4e10c4(0x122)][_0x4e10c4(0xbd)]((_0x2f3e23=this['session'])===null||_0x2f3e23===void 0x0?void 0x0:_0x2f3e23[_0x4e10c4(0x17c)])];case 0x1:_0x3e7605=_0x27b7d7[_0x4e10c4(0x133)](),_0x27a6d9=(_0x5ae61b=(_0x274acc=_0x3e7605===null||_0x3e7605===void 0x0?void 0x0:_0x3e7605[_0x4e10c4(0xc4)])===null||_0x274acc===void 0x0?void 0x0:_0x274acc['data'])===null||_0x5ae61b===void 0x0?void 0x0:_0x5ae61b[_0x4e10c4(0x1a4)],_0x1504e8=0x0,_0x27b7d7[_0x4e10c4(0x185)]=0x2;case 0x2:if(!(_0x27a6d9!==_0x4e10c4(0x157)&&_0x1504e8<_0xd17cfe[_0x4e10c4(0x169)]))return[0x3,0x5];return[0x4,time_1[_0x4e10c4(0xb2)](0x3e8)];case 0x3:_0x27b7d7[_0x4e10c4(0x133)]();return[0x4,this[_0x4e10c4(0x122)]['getSession']((_0x42cc8f=this[_0x4e10c4(0x1a2)])===null||_0x42cc8f===void 0x0?void 0x0:_0x42cc8f[_0x4e10c4(0x17c)])];case 0x4:_0x3e7605=_0x27b7d7['sent'](),_0x27a6d9=(_0x30234e=(_0xad9784=_0x3e7605===null||_0x3e7605===void 0x0?void 0x0:_0x3e7605[_0x4e10c4(0xc4)])===null||_0xad9784===void 0x0?void 0x0:_0xad9784['data'])===null||_0x30234e===void 0x0?void 0x0:_0x30234e[_0x4e10c4(0x1a4)],_0x1504e8=_0x1504e8+0x1;return[0x3,0x2];case 0x5:if(_0x27a6d9!==_0x4e10c4(0x157))throw new Error(_0x4e10c4(0x170)+JSON[_0x4e10c4(0x140)](_0x3e7605===null||_0x3e7605===void 0x0?void 0x0:_0x3e7605[_0x4e10c4(0xc4)],null,'\x20\x20'));return[0x2];}});});},_0xd17cfe['prototype'][_0x8b4eaf(0xe6)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x55f6e6;return __generator(this,function(_0x1f0381){var _0x2571e8=a35_0x51f1;switch(_0x1f0381[_0x2571e8(0x185)]){case 0x0:_0x55f6e6=this['genStateId']();return[0x4,core[_0x2571e8(0xe6)](_0x55f6e6)];case 0x1:return[0x2,_0x1f0381[_0x2571e8(0x133)]()];}});});},_0xd17cfe[_0x8b4eaf(0x176)]['getSessionFromState']=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x511373;return __generator(this,function(_0x26da01){var _0x1bda2d=a35_0x51f1;switch(_0x26da01[_0x1bda2d(0x185)]){case 0x0:return[0x4,this[_0x1bda2d(0xe6)]()];case 0x1:_0x511373=_0x26da01['sent']();lodash_1['default'][_0x1bda2d(0xc1)](_0x511373===null||_0x511373===void 0x0?void 0x0:_0x511373[_0x1bda2d(0x1a2)])&&logger_1[_0x1bda2d(0xfa)][_0x1bda2d(0x155)](_0x1bda2d(0x137));return[0x2,_0x511373===null||_0x511373===void 0x0?void 0x0:_0x511373[_0x1bda2d(0x1a2)]];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0xeb)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x54b5ac;return __generator(this,function(_0x12528e){var _0x43596e=a35_0x51f1;switch(_0x12528e[_0x43596e(0x185)]){case 0x0:return[0x4,this[_0x43596e(0xe6)]()];case 0x1:_0x54b5ac=_0x12528e[_0x43596e(0x133)]();lodash_1[_0x43596e(0xfa)][_0x43596e(0xc1)](_0x54b5ac===null||_0x54b5ac===void 0x0?void 0x0:_0x54b5ac['helperConfig'])&&logger_1['default'][_0x43596e(0x155)]('Helper\x20resource\x20has\x20not\x20been\x20deployed.\x20Please\x20exec\x20\x27s\x20setup\x27\x20first.');return[0x2,_0x54b5ac===null||_0x54b5ac===void 0x0?void 0x0:_0x54b5ac['helperConfig']];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x116)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x4417ab;return __generator(this,function(_0x6d0093){var _0x4fe68b=a35_0x51f1;switch(_0x6d0093[_0x4fe68b(0x185)]){case 0x0:return[0x4,this[_0x4fe68b(0xe6)]()];case 0x1:_0x4417ab=_0x6d0093[_0x4fe68b(0x133)]();lodash_1['default'][_0x4fe68b(0xc1)](_0x4417ab===null||_0x4417ab===void 0x0?void 0x0:_0x4417ab[_0x4fe68b(0x115)])&&logger_1[_0x4fe68b(0xfa)][_0x4fe68b(0x155)](_0x4fe68b(0x117));return[0x2,_0x4417ab===null||_0x4417ab===void 0x0?void 0x0:_0x4417ab[_0x4fe68b(0x115)]];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0x16b)]=function(_0x4f24a8){return __awaiter(this,void 0x0,void 0x0,function(){var _0x3c87fb,_0x276731,_0xe8b26e,_0x513ed8,_0x37b2c4,_0x22fc7c,_0x217bbb,_0x5506ca;return __generator(this,function(_0x29be31){var _0x208536=a35_0x51f1;switch(_0x29be31[_0x208536(0x185)]){case 0x0:return[0x4,this[_0x208536(0xeb)]()];case 0x1:_0x3c87fb=_0x29be31[_0x208536(0x133)](),_0x276731=_0x3c87fb===null||_0x3c87fb===void 0x0?void 0x0:_0x3c87fb[_0x208536(0x10d)],_0xe8b26e=_0x3c87fb===null||_0x3c87fb===void 0x0?void 0x0:_0x3c87fb[_0x208536(0x12c)],_0x513ed8=_0x3c87fb===null||_0x3c87fb===void 0x0?void 0x0:_0x3c87fb[_0x208536(0xd7)],_0x37b2c4=new fc_remote_invoke_1[(_0x208536(0x113))](this[_0x208536(0x11d)],_0x276731===null||_0x276731===void 0x0?void 0x0:_0x276731[_0x208536(0xf6)],this[_0x208536(0x17d)],this['appName'],this[_0x208536(0xde)],_0xe8b26e===null||_0xe8b26e===void 0x0?void 0x0:_0xe8b26e['name']),_0x22fc7c=_0x208536(0x13f);!lodash_1['default'][_0x208536(0xc1)](_0x513ed8)&&lodash_1[_0x208536(0xfa)][_0x208536(0xc1)](definition_1[_0x208536(0xa7)](_0x513ed8))&&(_0x22fc7c=_0x208536(0x11c));!lodash_1[_0x208536(0xfa)][_0x208536(0xc1)](_0x4f24a8)&&(_0x22fc7c=_0x22fc7c+'\x20'+_0x4f24a8);_0x217bbb=_0x37b2c4[_0x208536(0x15d)](_0x208536(0x16f),_0x208536(0x161),_0x22fc7c,_0x208536(0xd4));return[0x4,core[_0x208536(0x124)]('devsapp/fc-remote-invoke')];case 0x2:_0x5506ca=_0x29be31[_0x208536(0x133)]();return[0x4,_0x5506ca[_0x208536(0xd4)](_0x217bbb)];case 0x3:_0x29be31[_0x208536(0x133)]();return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)]['clean']=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x395ab8,_0x467c3f,_0x594178,_0x214260,_0xa5c37b,_0x5ed98b,_0x4e89e8,_0x305965,_0xe9c84,_0x1fe8e3,_0x2fef4b,_0x154e05,_0x276d49,_0x357c10,_0x37822e,_0x16d957;return __generator(this,function(_0x3aef65){var _0x4f0850=a35_0x51f1;switch(_0x3aef65[_0x4f0850(0x185)]){case 0x0:return[0x4,this['getHelperConfigFromState']()];case 0x1:_0x395ab8=_0x3aef65[_0x4f0850(0x133)]();return[0x4,this[_0x4f0850(0x160)]()];case 0x2:_0x467c3f=_0x3aef65[_0x4f0850(0x133)]();return[0x4,this[_0x4f0850(0x116)]()];case 0x3:_0x594178=_0x3aef65[_0x4f0850(0x133)](),_0x214260=_0x395ab8===null||_0x395ab8===void 0x0?void 0x0:_0x395ab8['service'],_0xa5c37b=_0x395ab8===null||_0x395ab8===void 0x0?void 0x0:_0x395ab8[_0x4f0850(0x12c)],_0x5ed98b=_0x395ab8===null||_0x395ab8===void 0x0?void 0x0:_0x395ab8[_0x4f0850(0xd7)];if(!_0x594178)return[0x3,0x8];_0x3aef65[_0x4f0850(0x185)]=0x4;case 0x4:_0x3aef65[_0x4f0850(0xf1)]['push']([0x4,0x7,,0x8]),_0x4e89e8=docker['getContainer'](_0x594178);return[0x4,docker_1[_0x4f0850(0x13e)](_0x4e89e8)];case 0x5:_0x3aef65[_0x4f0850(0x133)]();return[0x4,this[_0x4f0850(0xab)]()];case 0x6:_0x3aef65['sent']();return[0x3,0x8];case 0x7:_0x305965=_0x3aef65[_0x4f0850(0x133)](),logger_1[_0x4f0850(0xfa)][_0x4f0850(0x1a5)](stdout_formatter_1[_0x4f0850(0xfa)][_0x4f0850(0x100)][_0x4f0850(0xff)](_0x4f0850(0xdc),'containerId:\x20'+_0x594178,_0x305965===null||_0x305965===void 0x0?void 0x0:_0x305965[_0x4f0850(0x13d)])),logger_1[_0x4f0850(0xfa)][_0x4f0850(0xf0)](_0x4f0850(0xe8)+_0x594178+_0x4f0850(0xc5)+_0x305965);return[0x3,0x8];case 0x8:_0xe9c84=core['spinner'](_0x4f0850(0xfc)),_0x3aef65['label']=0x9;case 0x9:_0x3aef65[_0x4f0850(0xf1)][_0x4f0850(0x127)]([0x9,0xb,,0xc]);return[0x4,this['unsetHelperFunctionConfig'](_0x214260===null||_0x214260===void 0x0?void 0x0:_0x214260['name'],_0xa5c37b===null||_0xa5c37b===void 0x0?void 0x0:_0xa5c37b[_0x4f0850(0xf6)],'LATEST')];case 0xa:_0x3aef65[_0x4f0850(0x133)](),_0xe9c84['succeed'](_0x4f0850(0xe4));return[0x3,0xc];case 0xb:_0x1fe8e3=_0x3aef65['sent'](),_0xe9c84['fail'](_0x4f0850(0x175)),logger_1[_0x4f0850(0xfa)][_0x4f0850(0x155)](_0x1fe8e3===null||_0x1fe8e3===void 0x0?void 0x0:_0x1fe8e3[_0x4f0850(0x13d)]),logger_1[_0x4f0850(0xfa)][_0x4f0850(0xf0)](_0x4f0850(0xf3)+_0x1fe8e3);return[0x3,0xc];case 0xc:_0x3aef65[_0x4f0850(0xf1)][_0x4f0850(0x127)]([0xc,0xf,,0x10]),_0x2fef4b=new fc_deploy_1['FcDeployComponent'](this[_0x4f0850(0x11d)],_0x214260,this[_0x4f0850(0x17d)],this['appName'],this[_0x4f0850(0xde)],_0xa5c37b,_0x5ed98b);return[0x4,core['loadComponent'](_0x4f0850(0xa8))];case 0xd:_0x154e05=_0x3aef65[_0x4f0850(0x133)](),_0x276d49=_0x2fef4b[_0x4f0850(0x15d)](_0x4f0850(0x174),_0x4f0850(0x151),_0x4f0850(0x154),_0x4f0850(0xe2));return[0x4,_0x154e05['remove'](_0x276d49)];case 0xe:_0x3aef65[_0x4f0850(0x133)]();return[0x3,0x10];case 0xf:_0x357c10=_0x3aef65[_0x4f0850(0x133)](),logger_1[_0x4f0850(0xfa)][_0x4f0850(0x1a5)](stdout_formatter_1['default'][_0x4f0850(0x100)][_0x4f0850(0xff)](_0x4f0850(0x145),_0x4f0850(0x135)+(_0x214260===null||_0x214260===void 0x0?void 0x0:_0x214260[_0x4f0850(0xf6)])+_0x4f0850(0x105)+(_0xa5c37b===null||_0xa5c37b===void 0x0?void 0x0:_0xa5c37b[_0x4f0850(0xf6)]),_0x357c10===null||_0x357c10===void 0x0?void 0x0:_0x357c10['message'])),logger_1['default'][_0x4f0850(0xf0)](_0x4f0850(0xf3)+_0x357c10);return[0x3,0x10];case 0x10:_0x37822e=core[_0x4f0850(0xfd)](_0x4f0850(0x189)+(_0x467c3f===null||_0x467c3f===void 0x0?void 0x0:_0x467c3f[_0x4f0850(0x17c)])+'...');;_0x3aef65['label']=0x11;case 0x11:_0x3aef65['trys'][_0x4f0850(0x127)]([0x11,0x13,,0x14]);return[0x4,this[_0x4f0850(0x17e)](_0x467c3f===null||_0x467c3f===void 0x0?void 0x0:_0x467c3f['sessionId'])];case 0x12:_0x3aef65[_0x4f0850(0x133)](),_0x37822e['succeed'](_0x4f0850(0xf2));return[0x3,0x14];case 0x13:_0x16d957=_0x3aef65[_0x4f0850(0x133)](),_0x37822e[_0x4f0850(0x181)](_0x4f0850(0xf8)),logger_1['default'][_0x4f0850(0x155)](_0x16d957===null||_0x16d957===void 0x0?void 0x0:_0x16d957[_0x4f0850(0x13d)]),logger_1[_0x4f0850(0xfa)]['debug'](_0x4f0850(0xf3)+_0x16d957);return[0x3,0x14];case 0x14:return[0x2];}});});},_0xd17cfe[_0x8b4eaf(0x176)][_0x8b4eaf(0xbd)]=function(){var _0x5bfbdf=_0x8b4eaf;return this[_0x5bfbdf(0x1a2)];},_0xd17cfe[_0x8b4eaf(0x169)]=0x14,_0xd17cfe[_0x8b4eaf(0x14f)]=_0x8b4eaf(0x120),_0xd17cfe[_0x8b4eaf(0x10b)]=[_0x8b4eaf(0xb4)],_0xd17cfe['proxyImageName']=_0x8b4eaf(0x13c),_0xd17cfe['proxyImageStableVersion']='v0.5',_0xd17cfe[_0x8b4eaf(0x158)]=_0x8b4eaf(0x18a),_0xd17cfe[_0x8b4eaf(0xd5)]=process[_0x8b4eaf(0xb6)][_0x8b4eaf(0x190)]||_0xd17cfe[_0x8b4eaf(0x158)],_0xd17cfe[_0x8b4eaf(0x107)]=process['env'][_0x8b4eaf(0x14e)]||_0xd17cfe['proxyImageStableVersion'],_0xd17cfe['proxyImageRepo']=_0x8b4eaf(0x184),_0xd17cfe['proxyImaggeRegistry']=_0x8b4eaf(0xcd),_0xd17cfe[_0x8b4eaf(0x197)]=path[_0x8b4eaf(0x152)](os['homedir'](),'.s',_0x8b4eaf(0x10a),_0x8b4eaf(0x177)),_0xd17cfe[_0x8b4eaf(0x173)]=[_0x8b4eaf(0xe7),_0x8b4eaf(0xc7),'php',_0x8b4eaf(0x18e)],_0xd17cfe;}();exports['default']=TunnelService;