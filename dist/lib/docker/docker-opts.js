'use strict';var a12_0x264c=['/mock','generateDockerDebugOpts','label','FC_ACCESS_KEY_ID','addEnv','__esModule','iterator','debug','custom','resolveDockerRegistry','__setModuleDefault','call','../../common/logger','run','value','910232DLVkBD','debugPort','replace','resolveMockScript','pop','isArray','docker\x20options\x20for\x20custom\x20container:\x20','mark','../definition','__importDefault','745370XluPMa','nodejs6','generateContainerName','race','docker\x20options:\x20','php7.2','HostConfig','caPort','Env','python3.6','registry.cn-beijing.aliyuncs.com','push','length','FC_ACCOUNT_ID','startsWith','-inited\x22]}','java8','837968rxbNkU','return','cloneDeep','transformMountsForToolbox','188722JNEpdz','debugIde','https://','cmd','NetworkMode','-run','trys','hostname','__importStar','registry.hub.docker.com','lodash','Source','isEmpty','20166ZTMcDP','DOCKER_REGISTRIES','../local-invoke/env','mounts','function','imageName','/v2/aliyunfc/runtime-nodejs8/tags/list','generateLocalStartOpts','BOOTSTRAP_FILE','1bqaDfW','\x22]}','invalid\x20runtime\x20name\x20','next','__awaiter','default','getUserIdAndGroupId','resolveRuntimeToDockerImage','generateLocalInvokeOpts','nested-object-assign','transformPathForVirtualBox','warn','userId','isCustomContainerRuntime',':build-','map','{\x22name\x22:\x20[\x22','/bin/bash','nodejs8','2ODPtuO','resolveDockerEnv','generateSboxOpts','sent','AGENT_SCRIPT','imageName:\x20','hasOwnProperty','11HVsxvA','For\x20linux\x20platform,\x20Fc\x20will\x20use\x20host\x20userId\x20and\x20groupId\x20to\x20build\x20or\x20run\x20your\x20functions','getgid','FC_DOCKER_VERSION','FC_ACCESS_KEY_SECRET','python2.7','done','request','stringify','We\x20detected\x20that\x20you\x20are\x20using\x20docker\x20toolbox.\x20For\x20a\x20better\x20experience,\x20please\x20upgrade\x20\x27docker\x20for\x20windows\x27.\x0aYou\x20can\x20refer\x20to\x20Chinese\x20doc\x20https://github.com/alibaba/funcraft/blob/master/docs/usage/installation-zh.md#windows-%E5%AE%89%E8%A3%85-docker\x20or\x20English\x20doc\x20https://github.com/alibaba/funcraft/blob/master/docs/usage/installation.md.\x0a','resolveImageNameForPull','httpx','create','java11','isTty','aliyunfc/runtime-','join','Cmd','ops','fc-docker\x20docker\x20options:\x20','473629jVUFGi','__generator','defineProperty','__createBinding','throw','resolveDockerUser','1.9.18','split','1187607ObbZsF','then','generateContainerNameFilter','sbox'];var a12_0x16a965=a12_0x1d30;(function(_0x2bb257,_0x8292b1){var _0x5e92a3=a12_0x1d30;while(!![]){try{var _0x2d5ae6=parseInt(_0x5e92a3(0x120))+parseInt(_0x5e92a3(0x118))*parseInt(_0x5e92a3(0xfd))+parseInt(_0x5e92a3(0x104))*-parseInt(_0x5e92a3(0x15f))+-parseInt(_0x5e92a3(0x152))*parseInt(_0x5e92a3(0x168))+-parseInt(_0x5e92a3(0x13d))+-parseInt(_0x5e92a3(0x133))+parseInt(_0x5e92a3(0x14e));if(_0x2d5ae6===_0x8292b1)break;else _0x2bb257['push'](_0x2bb257['shift']());}catch(_0x3e052a){_0x2bb257['push'](_0x2bb257['shift']());}}}(a12_0x264c,0xdd5bb));var __createBinding=this&&this[a12_0x16a965(0x11b)]||(Object[a12_0x16a965(0x110)]?function(_0x49c7e6,_0x1a19aa,_0x4eaa95,_0x1afe37){var _0x43c893=a12_0x16a965;if(_0x1afe37===undefined)_0x1afe37=_0x4eaa95;Object[_0x43c893(0x11a)](_0x49c7e6,_0x1afe37,{'enumerable':!![],'get':function(){return _0x1a19aa[_0x4eaa95];}});}:function(_0x5a41d6,_0x1a982e,_0x46ff21,_0x42370f){if(_0x42370f===undefined)_0x42370f=_0x46ff21;_0x5a41d6[_0x42370f]=_0x1a982e[_0x46ff21];}),__setModuleDefault=this&&this[a12_0x16a965(0x12e)]||(Object['create']?function(_0x5b7a15,_0x21f888){var _0x494afc=a12_0x16a965;Object[_0x494afc(0x11a)](_0x5b7a15,_0x494afc(0x16d),{'enumerable':!![],'value':_0x21f888});}:function(_0x50c57a,_0xf3097c){var _0x49d2e0=a12_0x16a965;_0x50c57a[_0x49d2e0(0x16d)]=_0xf3097c;}),__importStar=this&&this[a12_0x16a965(0x15a)]||function(_0x55947c){var _0x58cc9d=a12_0x16a965;if(_0x55947c&&_0x55947c['__esModule'])return _0x55947c;var _0x51906c={};if(_0x55947c!=null){for(var _0x48659b in _0x55947c)if(_0x48659b!=='default'&&Object[_0x58cc9d(0x103)]['call'](_0x55947c,_0x48659b))__createBinding(_0x51906c,_0x55947c,_0x48659b);}return __setModuleDefault(_0x51906c,_0x55947c),_0x51906c;},__awaiter=this&&this[a12_0x16a965(0x16c)]||function(_0x2df2e7,_0x46c923,_0x1936a0,_0xef645d){function _0x3b3050(_0x51f26a){return _0x51f26a instanceof _0x1936a0?_0x51f26a:new _0x1936a0(function(_0x193071){_0x193071(_0x51f26a);});}return new(_0x1936a0||(_0x1936a0=Promise))(function(_0x15a897,_0x1f6972){function _0x187423(_0x425271){var _0x39d56d=a12_0x1d30;try{_0x163d30(_0xef645d[_0x39d56d(0x16b)](_0x425271));}catch(_0x552625){_0x1f6972(_0x552625);}}function _0x2b477e(_0x4e287b){var _0x59864e=a12_0x1d30;try{_0x163d30(_0xef645d[_0x59864e(0x11c)](_0x4e287b));}catch(_0x316fa7){_0x1f6972(_0x316fa7);}}function _0x163d30(_0x1e0edd){var _0x4ffe8f=a12_0x1d30;_0x1e0edd[_0x4ffe8f(0x10a)]?_0x15a897(_0x1e0edd[_0x4ffe8f(0x132)]):_0x3b3050(_0x1e0edd[_0x4ffe8f(0x132)])[_0x4ffe8f(0x121)](_0x187423,_0x2b477e);}_0x163d30((_0xef645d=_0xef645d['apply'](_0x2df2e7,_0x46c923||[]))['next']());});},__generator=this&&this[a12_0x16a965(0x119)]||function(_0x35213e,_0x399de3){var _0x3863c2=a12_0x16a965,_0x3cf51f={'label':0x0,'sent':function(){if(_0x26bfe3[0x0]&0x1)throw _0x26bfe3[0x1];return _0x26bfe3[0x1];},'trys':[],'ops':[]},_0x1ee492,_0x3875c6,_0x26bfe3,_0x261e84;return _0x261e84={'next':_0x33f926(0x0),'throw':_0x33f926(0x1),'return':_0x33f926(0x2)},typeof Symbol===_0x3863c2(0x163)&&(_0x261e84[Symbol[_0x3863c2(0x12a)]]=function(){return this;}),_0x261e84;function _0x33f926(_0x927faf){return function(_0x251b11){return _0x1191ee([_0x927faf,_0x251b11]);};}function _0x1191ee(_0x20d973){var _0xbc8664=_0x3863c2;if(_0x1ee492)throw new TypeError('Generator\x20is\x20already\x20executing.');while(_0x3cf51f)try{if(_0x1ee492=0x1,_0x3875c6&&(_0x26bfe3=_0x20d973[0x0]&0x2?_0x3875c6[_0xbc8664(0x14f)]:_0x20d973[0x0]?_0x3875c6[_0xbc8664(0x11c)]||((_0x26bfe3=_0x3875c6['return'])&&_0x26bfe3['call'](_0x3875c6),0x0):_0x3875c6[_0xbc8664(0x16b)])&&!(_0x26bfe3=_0x26bfe3[_0xbc8664(0x12f)](_0x3875c6,_0x20d973[0x1]))[_0xbc8664(0x10a)])return _0x26bfe3;if(_0x3875c6=0x0,_0x26bfe3)_0x20d973=[_0x20d973[0x0]&0x2,_0x26bfe3[_0xbc8664(0x132)]];switch(_0x20d973[0x0]){case 0x0:case 0x1:_0x26bfe3=_0x20d973;break;case 0x4:_0x3cf51f[_0xbc8664(0x126)]++;return{'value':_0x20d973[0x1],'done':![]};case 0x5:_0x3cf51f[_0xbc8664(0x126)]++,_0x3875c6=_0x20d973[0x1],_0x20d973=[0x0];continue;case 0x7:_0x20d973=_0x3cf51f[_0xbc8664(0x116)][_0xbc8664(0x137)](),_0x3cf51f[_0xbc8664(0x158)][_0xbc8664(0x137)]();continue;default:if(!(_0x26bfe3=_0x3cf51f['trys'],_0x26bfe3=_0x26bfe3[_0xbc8664(0x149)]>0x0&&_0x26bfe3[_0x26bfe3[_0xbc8664(0x149)]-0x1])&&(_0x20d973[0x0]===0x6||_0x20d973[0x0]===0x2)){_0x3cf51f=0x0;continue;}if(_0x20d973[0x0]===0x3&&(!_0x26bfe3||_0x20d973[0x1]>_0x26bfe3[0x0]&&_0x20d973[0x1]<_0x26bfe3[0x3])){_0x3cf51f[_0xbc8664(0x126)]=_0x20d973[0x1];break;}if(_0x20d973[0x0]===0x6&&_0x3cf51f['label']<_0x26bfe3[0x1]){_0x3cf51f[_0xbc8664(0x126)]=_0x26bfe3[0x1],_0x26bfe3=_0x20d973;break;}if(_0x26bfe3&&_0x3cf51f[_0xbc8664(0x126)]<_0x26bfe3[0x2]){_0x3cf51f[_0xbc8664(0x126)]=_0x26bfe3[0x2],_0x3cf51f[_0xbc8664(0x116)][_0xbc8664(0x148)](_0x20d973);break;}if(_0x26bfe3[0x2])_0x3cf51f['ops']['pop']();_0x3cf51f[_0xbc8664(0x158)][_0xbc8664(0x137)]();continue;}_0x20d973=_0x399de3[_0xbc8664(0x12f)](_0x35213e,_0x3cf51f);}catch(_0x918c24){_0x20d973=[0x6,_0x918c24],_0x3875c6=0x0;}finally{_0x1ee492=_0x26bfe3=0x0;}if(_0x20d973[0x0]&0x5)throw _0x20d973[0x1];return{'value':_0x20d973[0x0]?_0x20d973[0x1]:void 0x0,'done':!![]};}},__importDefault=this&&this[a12_0x16a965(0x13c)]||function(_0x1a366e){var _0x24b386=a12_0x16a965;return _0x1a366e&&_0x1a366e[_0x24b386(0x129)]?_0x1a366e:{'default':_0x1a366e};};Object[a12_0x16a965(0x11a)](exports,a12_0x16a965(0x129),{'value':!![]}),exports[a12_0x16a965(0x16f)]=exports['resolveDockerEnv']=exports[a12_0x16a965(0x12d)]=exports[a12_0x16a965(0x136)]=exports[a12_0x16a965(0x166)]=exports[a12_0x16a965(0x13f)]=exports[a12_0x16a965(0x122)]=exports[a12_0x16a965(0x170)]=exports[a12_0x16a965(0x172)]=exports[a12_0x16a965(0x151)]=exports['generateInstallOpts']=exports['resolveDockerUser']=exports['generateSboxOpts']=exports[a12_0x16a965(0x10e)]=exports['DOCKER_REGISTRIES']=void 0x0;var httpx=__importStar(require(a12_0x16a965(0x10f))),_=__importStar(require(a12_0x16a965(0x15c))),env_1=require(a12_0x16a965(0x161)),logger_1=__importDefault(require(a12_0x16a965(0x130))),definition_1=require(a12_0x16a965(0x13b)),nested_object_assign_1=__importDefault(require(a12_0x16a965(0x171))),debug_1=require('../local-invoke/debug'),runtime_1=require('../utils/runtime'),utils_1=require('../utils/utils'),REGISTRY_DEFAULT=a12_0x16a965(0x147),DEFAULT_REGISTRY=REGISTRY_DEFAULT||a12_0x16a965(0x15b);exports[a12_0x16a965(0x160)]=[a12_0x16a965(0x147),a12_0x16a965(0x15b)];var IMAGE_VERSION=process['env'][a12_0x16a965(0x107)]||a12_0x16a965(0x11e),DOCKER_REGISTRY_CACHE,NAS_UID=0x2713,NAS_GID=0x2713,runtimeImageMap={'nodejs6':a12_0x16a965(0x13e),'nodejs8':a12_0x16a965(0xfc),'nodejs10':'nodejs10','nodejs12':'nodejs12','python2.7':a12_0x16a965(0x109),'python3':a12_0x16a965(0x146),'java8':a12_0x16a965(0x14d),'java11':a12_0x16a965(0x111),'php7.2':a12_0x16a965(0x142),'dotnetcore2.1':'dotnetcore2.1','custom':a12_0x16a965(0x12c)};function resolveImageNameForPull(_0x2235a8){return __awaiter(this,void 0x0,void 0x0,function(){var _0x492fe1;return __generator(this,function(_0xaa5070){var _0x1c2edb=a12_0x1d30;switch(_0xaa5070[_0x1c2edb(0x126)]){case 0x0:return[0x4,resolveDockerRegistry()];case 0x1:_0x492fe1=_0xaa5070[_0x1c2edb(0x100)]();_0x492fe1&&(_0x2235a8=_0x492fe1+'/'+_0x2235a8);return[0x2,_0x2235a8];}});});}exports[a12_0x16a965(0x10e)]=resolveImageNameForPull;function generateSboxOpts(_0x17384e){var _0xd870d4=a12_0x16a965,_0x237556=_0x17384e[_0xd870d4(0x164)],_0x475166=_0x17384e[_0xd870d4(0x159)],_0x8e62f7=_0x17384e[_0xd870d4(0x162)],_0x25e475=_0x17384e['envs'],_0x2a47a9=_0x17384e[_0xd870d4(0x155)],_0x3dc84b=_0x2a47a9===void 0x0?[]:_0x2a47a9,_0x34334d=_0x17384e[_0xd870d4(0x112)],_0x583158=_0x17384e['isInteractive'];return{'Image':_0x237556,'Hostname':_0x475166,'AttachStdin':_0x583158,'AttachStdout':!![],'AttachStderr':!![],'User':resolveDockerUser({'stage':_0xd870d4(0x123)}),'Tty':_0x34334d,'OpenStdin':_0x583158,'StdinOnce':!![],'Env':resolveDockerEnv(_0x25e475),'Cmd':_0x3dc84b[_0xd870d4(0x149)]?_0x3dc84b:[_0xd870d4(0xfb)],'HostConfig':{'AutoRemove':!![],'Mounts':_0x8e62f7}};}exports[a12_0x16a965(0xff)]=generateSboxOpts;function resolveDockerUser(_0x5ea708){var _0x1c243f=a12_0x16a965,_0x15b405=_0x5ea708['nasConfig'],_0x4906f7=_0x5ea708['stage'],_0xc95013=_0x4906f7===void 0x0?_0x1c243f(0x131):_0x4906f7,_0x5c1a47=definition_1[_0x1c243f(0x16e)](_0x15b405),_0x1511a1=_0x5c1a47[_0x1c243f(0x174)],_0x22d0a7=_0x5c1a47['groupId'];return process['platform']==='linux'?(logger_1[_0x1c243f(0x16d)][_0x1c243f(0x12b)](_0x1c243f(0x105)),_0x1511a1=process['getuid'](),_0x22d0a7=process[_0x1c243f(0x106)]()):_0xc95013==='run'?((_0x1511a1===-0x1||_0x1511a1===undefined)&&(_0x1511a1=NAS_UID),(_0x22d0a7===-0x1||_0x22d0a7===undefined)&&(_0x22d0a7=NAS_GID)):(_0x1511a1=0x0,_0x22d0a7=0x0),_0x1511a1+':'+_0x22d0a7;}exports[a12_0x16a965(0x11d)]=resolveDockerUser;function generateInstallOpts(_0x15438b,_0x415b2c,_0x2d9861){return{'Image':_0x15438b,'Tty':!![],'Env':resolveDockerEnv(_0x2d9861),'Cmd':['/bin/bash'],'HostConfig':{'AutoRemove':!![],'Mounts':_0x415b2c}};}exports['generateInstallOpts']=generateInstallOpts;function transformMountsForToolbox(_0x57ce01){var _0xa5d3bd=a12_0x16a965;console[_0xa5d3bd(0x173)](_0xa5d3bd(0x10d));if(Array[_0xa5d3bd(0x138)](_0x57ce01))return _0x57ce01[_0xa5d3bd(0xf9)](function(_0x2fc211){return transformSourcePathOfMount(_0x2fc211);});return transformSourcePathOfMount(_0x57ce01);}exports[a12_0x16a965(0x151)]=transformMountsForToolbox;function transformSourcePathOfMount(_0x4d926a){var _0x44e0d9=a12_0x16a965;if(!_[_0x44e0d9(0x15e)](_0x4d926a)){var _0x57429d=Object['assign']({},_0x4d926a);return _0x57429d[_0x44e0d9(0x15d)]=transformPathForVirtualBox(_0x4d926a[_0x44e0d9(0x15d)]),_0x57429d;}return{};}function transformPathForVirtualBox(_0x41f2e4){var _0x9ef9eb=a12_0x16a965,_0x38a4be=_0x41f2e4[_0x9ef9eb(0x11f)](':')['join'](''),_0x3ca400=_['lowerFirst'](_0x38a4be['split']('\x5c')[_0x9ef9eb(0x114)]('/'));return'/'+_0x3ca400;}exports[a12_0x16a965(0x172)]=transformPathForVirtualBox;function generateLocalInvokeOpts(_0x3bb9c8,_0x389cd3,_0x2edc07,_0x520dfd,_0x111cf7,_0x328d56,_0x4dd456,_0x1070c8){return __awaiter(this,void 0x0,void 0x0,function(){var _0x5cc9c3,_0x5dc6e0,_0x55c5dc,_0x562260,_0x521986,_0x10e3cc,_0x4c7958;return __generator(this,function(_0x53acaf){var _0x2f8a6f=a12_0x1d30;switch(_0x53acaf[_0x2f8a6f(0x126)]){case 0x0:_0x5cc9c3={'HostConfig':{'AutoRemove':!![],'Mounts':_0x2edc07}},_0x5dc6e0={};_0x111cf7&&(_0x5dc6e0=debug_1[_0x2f8a6f(0x125)](_0x3bb9c8,_0x111cf7,_0x1070c8));_0x55c5dc={'OpenStdin':!![],'Tty':![],'StdinOnce':!![],'AttachStdin':!![],'AttachStdout':!![],'AttachStderr':!![]};return[0x4,resolveRuntimeToDockerImage(_0x3bb9c8)];case 0x1:_0x562260=_0x53acaf[_0x2f8a6f(0x100)](),supportCustomBootstrapFile(_0x3bb9c8,_0x328d56),_0x521986=nested_object_assign_1[_0x2f8a6f(0x16d)]({'Env':resolveDockerEnv(_0x328d56),'Image':_0x562260,'name':_0x389cd3,'Cmd':_0x520dfd,'User':_0x4dd456},_0x55c5dc,_0x5cc9c3,_0x5dc6e0),_0x10e3cc=_[_0x2f8a6f(0x150)](_0x521986);(_0x10e3cc===null||_0x10e3cc===void 0x0?void 0x0:_0x10e3cc[_0x2f8a6f(0x145)])&&(_0x4c7958=_0x10e3cc['Env'][_0x2f8a6f(0xf9)](function(_0x1a4491){var _0xa40d74=_0x2f8a6f;if(_0x1a4491['startsWith'](_0xa40d74(0x127))||_0x1a4491[_0xa40d74(0x14b)]('FC_ACCESS_KEY_SECRET')||_0x1a4491[_0xa40d74(0x14b)](_0xa40d74(0x14a))){var _0x3436ba=_0x1a4491[_0xa40d74(0x11f)]('='),_0x262b54=utils_1['mark'](_0x3436ba[0x1]);return _0x3436ba[0x0]+'='+_0x262b54;}else return _0x1a4491;}),_0x10e3cc[_0x2f8a6f(0x145)]=_0x4c7958);logger_1['default'][_0x2f8a6f(0x12b)](_0x2f8a6f(0x117)+JSON['stringify'](_0x10e3cc,null,'\x20\x20'));return[0x2,_0x521986];}});});}exports[a12_0x16a965(0x170)]=generateLocalInvokeOpts;function generateContainerNameFilter(_0x293869,_0x2fca0f){var _0x2139d1=a12_0x16a965;if(_0x2fca0f)return _0x2139d1(0xfa)+_0x293869+_0x2139d1(0x14c);return'{\x22name\x22:\x20[\x22'+_0x293869+_0x2139d1(0x169);}exports[a12_0x16a965(0x122)]=generateContainerNameFilter;function generateContainerName(_0xe975a9,_0x11d7b3,_0x765b0b){var _0x1183bf=a12_0x16a965;return('fc-local-'+_0xe975a9+'-'+_0x11d7b3)[_0x1183bf(0x135)](/ /g,'')+(_0x765b0b?'-debug':_0x1183bf(0x157));}exports[a12_0x16a965(0x13f)]=generateContainerName;function a12_0x1d30(_0x508538,_0x5a413b){return a12_0x1d30=function(_0x264c88,_0x1d3099){_0x264c88=_0x264c88-0xf7;var _0x58e457=a12_0x264c[_0x264c88];return _0x58e457;},a12_0x1d30(_0x508538,_0x5a413b);}function generateLocalStartOpts(_0x3a08a2,_0x1c5c87,_0x1a944c,_0x3c9b87,_0xe9b5bb,_0x33905d,_0x3a25a6){var _0x1ba61e=a12_0x16a965,_0x1314bd=_0x3a25a6[_0x1ba61e(0x134)],_0x45ad5e=_0x3a25a6['dockerUser'],_0x4d61a3=_0x3a25a6[_0x1ba61e(0x153)],_0x957d0b=_0x4d61a3===void 0x0?null:_0x4d61a3,_0x5b334c=_0x3a25a6[_0x1ba61e(0x164)],_0x29da85=_0x3a25a6[_0x1ba61e(0x144)],_0x2fa04c=_0x29da85===void 0x0?0x2328:_0x29da85;return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x3c3764){var _0x41dbc2=a12_0x1d30;switch(_0x3c3764['label']){case 0x0:if(runtime_1[_0x41dbc2(0xf7)](_0x1c5c87))return[0x2,genCustomContainerLocalStartOpts(_0x3a08a2,_0x1a944c,_0x3c9b87,_0xe9b5bb,_0x33905d,_0x5b334c,_0x2fa04c)];return[0x4,genNonCustomContainerLocalStartOpts(_0x3a08a2,_0x1c5c87,_0x1a944c,_0x3c9b87,_0xe9b5bb,_0x1314bd,_0x33905d,_0x45ad5e,_0x957d0b)];case 0x1:return[0x2,_0x3c3764[_0x41dbc2(0x100)]()];}});});}exports['generateLocalStartOpts']=generateLocalStartOpts;function genNonCustomContainerLocalStartOpts(_0x5cf1af,_0x18fb13,_0x538c8b,_0x3f504a,_0xc68b57,_0x32c2bf,_0x4c321e,_0x4739b9,_0x47042c){return __awaiter(this,void 0x0,void 0x0,function(){var _0x40b804,_0x5211e7,_0x54b95c,_0xa5825e,_0x4bde53;return __generator(this,function(_0x52103a){var _0x100748=a12_0x1d30;switch(_0x52103a[_0x100748(0x126)]){case 0x0:_0x40b804={'HostConfig':{'AutoRemove':!![],'Mounts':_0x3f504a}};!_[_0x100748(0x15e)](_0x5cf1af)&&(_0x40b804[_0x100748(0x143)][_0x100748(0x156)]='container:'+_0x5cf1af);return[0x4,resolveRuntimeToDockerImage(_0x18fb13)];case 0x1:_0x5211e7=_0x52103a[_0x100748(0x100)](),supportCustomBootstrapFile(_0x18fb13,_0x4c321e),_0x54b95c=nested_object_assign_1[_0x100748(0x16d)]({'Env':resolveDockerEnv(_0x4c321e),'Image':_0x5211e7,'name':_0x538c8b,'Cmd':_0xc68b57,'User':_0x4739b9,'Entrypoint':[resolveMockScript(_0x18fb13)]},_0x40b804),_0xa5825e=_[_0x100748(0x150)](_0x54b95c);(_0xa5825e===null||_0xa5825e===void 0x0?void 0x0:_0xa5825e[_0x100748(0x145)])&&(_0x4bde53=_0xa5825e[_0x100748(0x145)][_0x100748(0xf9)](function(_0x441771){var _0x2901d5=_0x100748;if(_0x441771[_0x2901d5(0x14b)](_0x2901d5(0x127))||_0x441771[_0x2901d5(0x14b)](_0x2901d5(0x108))||_0x441771[_0x2901d5(0x14b)](_0x2901d5(0x14a))){var _0x2e2e2c=_0x441771['split']('='),_0xafeeb9=utils_1[_0x2901d5(0x13a)](_0x2e2e2c[0x1]);return _0x2e2e2c[0x0]+'='+_0xafeeb9;}else return _0x441771;}),_0xa5825e[_0x100748(0x145)]=_0x4bde53);logger_1[_0x100748(0x16d)]['debug'](_0x100748(0x141)+JSON[_0x100748(0x10c)](_0xa5825e,null,'\x20\x20'));return[0x2,_0x54b95c];}});});}function supportCustomBootstrapFile(_0xd2d8af,_0x686d1d){var _0xa531f3=a12_0x16a965;_0xd2d8af==='custom'&&(_0x686d1d[_0xa531f3(0x167)]&&(_0x686d1d[_0xa531f3(0x101)]=_0x686d1d[_0xa531f3(0x167)]));}function resolveMockScript(_0x4509ad){var _0x573732=a12_0x16a965;return'/var/fc/runtime/'+_0x4509ad+_0x573732(0x124);}exports[a12_0x16a965(0x136)]=resolveMockScript;function genCustomContainerLocalStartOpts(_0x299b83,_0x143579,_0x51d3d3,_0x14278d,_0x5e084d,_0x145c15,_0xe747b8){var _0x4aa35e=a12_0x16a965,_0x2eeb27,_0x312895;_0xe747b8===void 0x0&&(_0xe747b8=0x2328);var _0x2f854f=_0xe747b8+'/tcp',_0x5788ef={'ExposedPorts':(_0x2eeb27={},_0x2eeb27[_0x2f854f]={},_0x2eeb27),'HostConfig':{'AutoRemove':!![],'Mounts':_0x51d3d3,'PortBindings':(_0x312895={},_0x312895[_0x2f854f]=[{'HostIp':'','HostPort':''+_0xe747b8}],_0x312895)}};!_['isEmpty'](_0x299b83)&&(_0x5788ef[_0x4aa35e(0x143)][_0x4aa35e(0x156)]='container:'+_0x299b83);var _0x40bf25={'Env':resolveDockerEnv(_0x5e084d,!![]),'Image':_0x145c15,'name':_0x143579};_0x14278d!==[]&&(_0x40bf25[_0x4aa35e(0x115)]=_0x14278d);var _0x5e3020={'OpenStdin':!![],'Tty':![],'StdinOnce':!![],'AttachStdin':!![],'AttachStdout':!![],'AttachStderr':!![]},_0x4f5657=nested_object_assign_1['default'](_0x40bf25,_0x5788ef,_0x5e3020),_0x298861=_[_0x4aa35e(0x150)](_0x4f5657);if(_0x298861===null||_0x298861===void 0x0?void 0x0:_0x298861[_0x4aa35e(0x145)]){var _0x5a3cee=_0x298861[_0x4aa35e(0x145)]['map'](function(_0x4b1985){var _0x11da31=_0x4aa35e;if(_0x4b1985['startsWith'](_0x11da31(0x127))||_0x4b1985[_0x11da31(0x14b)](_0x11da31(0x108))||_0x4b1985[_0x11da31(0x14b)]('FC_ACCOUNT_ID')){var _0x1a11c5=_0x4b1985[_0x11da31(0x11f)]('='),_0x1d0d57=utils_1[_0x11da31(0x13a)](_0x1a11c5[0x1]);return _0x1a11c5[0x0]+'='+_0x1d0d57;}else return _0x4b1985;});_0x298861['Env']=_0x5a3cee;}return logger_1[_0x4aa35e(0x16d)][_0x4aa35e(0x12b)](_0x4aa35e(0x139)+JSON[_0x4aa35e(0x10c)](_0x298861,null,'\x20\x20')),_0x4f5657;}function resolveDockerRegistry(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x5e2614,_0x2d469d;return __generator(this,function(_0x3970af){var _0x556078=a12_0x1d30;switch(_0x3970af['label']){case 0x0:if(DOCKER_REGISTRY_CACHE)return[0x2,DOCKER_REGISTRY_CACHE];_0x5e2614=exports[_0x556078(0x160)][_0x556078(0xf9)](function(_0x42ad75){var _0x4a8c8f=_0x556078;return httpx[_0x4a8c8f(0x10b)](_0x4a8c8f(0x154)+_0x42ad75+_0x4a8c8f(0x165),{'timeout':0xbb8})['then'](function(){return _0x42ad75;});}),_0x3970af['label']=0x1;case 0x1:_0x3970af[_0x556078(0x158)][_0x556078(0x148)]([0x1,0x3,,0x4]);return[0x4,Promise[_0x556078(0x140)](_0x5e2614)];case 0x2:DOCKER_REGISTRY_CACHE=_0x3970af[_0x556078(0x100)]();return[0x3,0x4];case 0x3:_0x2d469d=_0x3970af[_0x556078(0x100)](),DOCKER_REGISTRY_CACHE=DEFAULT_REGISTRY;return[0x3,0x4];case 0x4:return[0x2,DOCKER_REGISTRY_CACHE];}});});}exports[a12_0x16a965(0x12d)]=resolveDockerRegistry;function resolveDockerEnv(_0xd0bc82,_0x2aa10e){var _0x563774=a12_0x16a965;_0xd0bc82===void 0x0&&(_0xd0bc82={});_0x2aa10e===void 0x0&&(_0x2aa10e=![]);if(_0x2aa10e)return _[_0x563774(0xf9)](_0xd0bc82||{},function(_0x52d784,_0x4376b2){return _0x4376b2+'='+_0x52d784;});return _[_0x563774(0xf9)](env_1[_0x563774(0x128)](_0xd0bc82||{}),function(_0x1ea1e9,_0x15b59b){return _0x15b59b+'='+_0x1ea1e9;});}exports[a12_0x16a965(0xfe)]=resolveDockerEnv;function resolveRuntimeToDockerImage(_0x5508ae,_0x1d2892){return __awaiter(this,void 0x0,void 0x0,function(){var _0x100d80,_0x268e47;return __generator(this,function(_0x1b199b){var _0x5c8303=a12_0x1d30;if(runtimeImageMap[_0x5508ae])return _0x100d80=runtimeImageMap[_0x5508ae],_0x1d2892?_0x268e47=_0x5c8303(0x113)+_0x100d80+_0x5c8303(0xf8)+IMAGE_VERSION:_0x268e47=_0x5c8303(0x113)+_0x100d80+':'+IMAGE_VERSION,logger_1[_0x5c8303(0x16d)]['debug'](_0x5c8303(0x102)+_0x268e47),[0x2,_0x268e47];throw new Error(_0x5c8303(0x16a)+_0x5508ae);});});}exports['resolveRuntimeToDockerImage']=resolveRuntimeToDockerImage;