'use strict';var a32_0x1f3e=['lodash','iterator','__importDefault','function','__generator','pop','478359mdZeWC','cleanUnzippedCodeDir','compact','containerName','debuggerMount','passwdMount','functionName','push','debugPort','log','runtime','defineProperty','name','join','__awaiter','beforeInvoke','codeUri','__setModuleDefault','__importStar','call','dockerUser','99XDUieN','path','rimraf','unzippedCodeDir','serviceConfig','1377157HGgCYH','endsWith','sync','tunnelService','resolveDebuggerPathToMount','label','debugArgs','customContainerConfig','DEFAULT_NAS_PATH_SUFFIX','pullFcImageIfNeed','Source','stringify','../../utils/runtime','return','634788SQDocc','image','nasBaseDir','resolveNasConfigToMounts','696269dSnild','functionConfig','uuid','mounts','region','next','debug','nasMounts','ops','1947815ooUzwr','debugIde','done','transformMountsForToolbox','codeMount','extract-zip','writeDebugIdeConfigForVscode','showDebugIdeTips','serviceName','default','generateRamdomContainerName','init','sessionId','throw','resolveDockerUser','codeUri\x20is\x20a\x20zip\x20format,\x20will\x20unzipping\x20to\x20','tmpDir','inited','trys','value','toLowerCase','baseDir','creds','length','debuggerPath','fs-extra','hasOwnProperty','248wnMnYz','sent','imageName','resolveRuntimeToDockerImage','.jar','10646cImCrA','1jQxXtb','../../devs','resolveCodeUriToMount','.zip','tmpDirMount','prototype','isCustomContainerRuntime','resolvePasswdMount','__esModule','vscode','resolveTmpDirToMount','nasConfig','create','.war','1487PIORpG','../../docker/docker'];var a32_0x591315=a32_0x34ba;(function(_0x282e48,_0x47a8ec){var _0x1ad344=a32_0x34ba;while(!![]){try{var _0x5c6a50=-parseInt(_0x1ad344(0x1f7))*-parseInt(_0x1ad344(0x1e3))+parseInt(_0x1ad344(0x1ad))+-parseInt(_0x1ad344(0x1bb))+-parseInt(_0x1ad344(0x1bf))+-parseInt(_0x1ad344(0x1ff))+parseInt(_0x1ad344(0x1e8))*-parseInt(_0x1ad344(0x1a8))+parseInt(_0x1ad344(0x1c8))*parseInt(_0x1ad344(0x1e9));if(_0x5c6a50===_0x47a8ec)break;else _0x282e48['push'](_0x282e48['shift']());}catch(_0x2c45e2){_0x282e48['push'](_0x282e48['shift']());}}}(a32_0x1f3e,0xcabaa));var __createBinding=this&&this['__createBinding']||(Object[a32_0x591315(0x1f5)]?function(_0x5c3dac,_0x5e6c57,_0x23cdc8,_0x2975c){var _0x44d576=a32_0x591315;if(_0x2975c===undefined)_0x2975c=_0x23cdc8;Object[_0x44d576(0x20a)](_0x5c3dac,_0x2975c,{'enumerable':!![],'get':function(){return _0x5e6c57[_0x23cdc8];}});}:function(_0x29d26a,_0x23fe3e,_0x444789,_0x21d8b9){if(_0x21d8b9===undefined)_0x21d8b9=_0x444789;_0x29d26a[_0x21d8b9]=_0x23fe3e[_0x444789];}),__setModuleDefault=this&&this[a32_0x591315(0x1a4)]||(Object[a32_0x591315(0x1f5)]?function(_0x3d1532,_0x3454fe){Object['defineProperty'](_0x3d1532,'default',{'enumerable':!![],'value':_0x3454fe});}:function(_0x1f1541,_0x5c7669){var _0x23c114=a32_0x591315;_0x1f1541[_0x23c114(0x1d1)]=_0x5c7669;}),__importStar=this&&this[a32_0x591315(0x1a5)]||function(_0x457de4){var _0x5053d6=a32_0x591315;if(_0x457de4&&_0x457de4[_0x5053d6(0x1f1)])return _0x457de4;var _0x33e522={};if(_0x457de4!=null){for(var _0xc9a42f in _0x457de4)if(_0xc9a42f!==_0x5053d6(0x1d1)&&Object[_0x5053d6(0x1e2)][_0x5053d6(0x1a6)](_0x457de4,_0xc9a42f))__createBinding(_0x33e522,_0x457de4,_0xc9a42f);}return __setModuleDefault(_0x33e522,_0x457de4),_0x33e522;},__awaiter=this&&this[a32_0x591315(0x1a1)]||function(_0xbb503d,_0x180903,_0x5d3d13,_0x260395){function _0x521f0a(_0x42b415){return _0x42b415 instanceof _0x5d3d13?_0x42b415:new _0x5d3d13(function(_0x3360e9){_0x3360e9(_0x42b415);});}return new(_0x5d3d13||(_0x5d3d13=Promise))(function(_0x2292d7,_0x3c644a){var _0xa0fdbd=a32_0x34ba;function _0x5885bd(_0x1725ed){try{_0x3ddd74(_0x260395['next'](_0x1725ed));}catch(_0x4a0fd1){_0x3c644a(_0x4a0fd1);}}function _0x1cae67(_0x1e5934){var _0x38666b=a32_0x34ba;try{_0x3ddd74(_0x260395[_0x38666b(0x1d5)](_0x1e5934));}catch(_0x48fc64){_0x3c644a(_0x48fc64);}}function _0x3ddd74(_0x4a2579){var _0x4d9644=a32_0x34ba;_0x4a2579[_0x4d9644(0x1ca)]?_0x2292d7(_0x4a2579['value']):_0x521f0a(_0x4a2579[_0x4d9644(0x1db)])['then'](_0x5885bd,_0x1cae67);}_0x3ddd74((_0x260395=_0x260395['apply'](_0xbb503d,_0x180903||[]))[_0xa0fdbd(0x1c4)]());});},__generator=this&&this[a32_0x591315(0x1fd)]||function(_0x2aead8,_0x37976d){var _0xda0b0c=a32_0x591315,_0x4610ba={'label':0x0,'sent':function(){if(_0x397313[0x0]&0x1)throw _0x397313[0x1];return _0x397313[0x1];},'trys':[],'ops':[]},_0x3a881e,_0x33a42e,_0x397313,_0x1879e3;return _0x1879e3={'next':_0x561866(0x0),'throw':_0x561866(0x1),'return':_0x561866(0x2)},typeof Symbol===_0xda0b0c(0x1fc)&&(_0x1879e3[Symbol[_0xda0b0c(0x1fa)]]=function(){return this;}),_0x1879e3;function _0x561866(_0x294a95){return function(_0x4dcdba){return _0x270a48([_0x294a95,_0x4dcdba]);};}function _0x270a48(_0x27ea8c){var _0x2f1920=_0xda0b0c;if(_0x3a881e)throw new TypeError('Generator\x20is\x20already\x20executing.');while(_0x4610ba)try{if(_0x3a881e=0x1,_0x33a42e&&(_0x397313=_0x27ea8c[0x0]&0x2?_0x33a42e[_0x2f1920(0x1ba)]:_0x27ea8c[0x0]?_0x33a42e['throw']||((_0x397313=_0x33a42e[_0x2f1920(0x1ba)])&&_0x397313[_0x2f1920(0x1a6)](_0x33a42e),0x0):_0x33a42e['next'])&&!(_0x397313=_0x397313['call'](_0x33a42e,_0x27ea8c[0x1]))[_0x2f1920(0x1ca)])return _0x397313;if(_0x33a42e=0x0,_0x397313)_0x27ea8c=[_0x27ea8c[0x0]&0x2,_0x397313[_0x2f1920(0x1db)]];switch(_0x27ea8c[0x0]){case 0x0:case 0x1:_0x397313=_0x27ea8c;break;case 0x4:_0x4610ba[_0x2f1920(0x1b2)]++;return{'value':_0x27ea8c[0x1],'done':![]};case 0x5:_0x4610ba[_0x2f1920(0x1b2)]++,_0x33a42e=_0x27ea8c[0x1],_0x27ea8c=[0x0];continue;case 0x7:_0x27ea8c=_0x4610ba[_0x2f1920(0x1c7)][_0x2f1920(0x1fe)](),_0x4610ba['trys']['pop']();continue;default:if(!(_0x397313=_0x4610ba[_0x2f1920(0x1da)],_0x397313=_0x397313[_0x2f1920(0x1df)]>0x0&&_0x397313[_0x397313['length']-0x1])&&(_0x27ea8c[0x0]===0x6||_0x27ea8c[0x0]===0x2)){_0x4610ba=0x0;continue;}if(_0x27ea8c[0x0]===0x3&&(!_0x397313||_0x27ea8c[0x1]>_0x397313[0x0]&&_0x27ea8c[0x1]<_0x397313[0x3])){_0x4610ba[_0x2f1920(0x1b2)]=_0x27ea8c[0x1];break;}if(_0x27ea8c[0x0]===0x6&&_0x4610ba[_0x2f1920(0x1b2)]<_0x397313[0x1]){_0x4610ba[_0x2f1920(0x1b2)]=_0x397313[0x1],_0x397313=_0x27ea8c;break;}if(_0x397313&&_0x4610ba[_0x2f1920(0x1b2)]<_0x397313[0x2]){_0x4610ba[_0x2f1920(0x1b2)]=_0x397313[0x2],_0x4610ba[_0x2f1920(0x1c7)][_0x2f1920(0x206)](_0x27ea8c);break;}if(_0x397313[0x2])_0x4610ba['ops'][_0x2f1920(0x1fe)]();_0x4610ba[_0x2f1920(0x1da)][_0x2f1920(0x1fe)]();continue;}_0x27ea8c=_0x37976d[_0x2f1920(0x1a6)](_0x2aead8,_0x4610ba);}catch(_0x146c5b){_0x27ea8c=[0x6,_0x146c5b],_0x33a42e=0x0;}finally{_0x3a881e=_0x397313=0x0;}if(_0x27ea8c[0x0]&0x5)throw _0x27ea8c[0x1];return{'value':_0x27ea8c[0x0]?_0x27ea8c[0x1]:void 0x0,'done':!![]};}},__spreadArrays=this&&this['__spreadArrays']||function(){var _0x4f710c=a32_0x591315;for(var _0x3fa96f=0x0,_0x2f415a=0x0,_0x55cafd=arguments[_0x4f710c(0x1df)];_0x2f415a<_0x55cafd;_0x2f415a++)_0x3fa96f+=arguments[_0x2f415a][_0x4f710c(0x1df)];for(var _0x21cc95=Array(_0x3fa96f),_0x571b3a=0x0,_0x2f415a=0x0;_0x2f415a<_0x55cafd;_0x2f415a++)for(var _0x2cd18a=arguments[_0x2f415a],_0x58add5=0x0,_0x2f7302=_0x2cd18a[_0x4f710c(0x1df)];_0x58add5<_0x2f7302;_0x58add5++,_0x571b3a++)_0x21cc95[_0x571b3a]=_0x2cd18a[_0x58add5];return _0x21cc95;},__importDefault=this&&this[a32_0x591315(0x1fb)]||function(_0x41f2bb){return _0x41f2bb&&_0x41f2bb['__esModule']?_0x41f2bb:{'default':_0x41f2bb};};Object[a32_0x591315(0x20a)](exports,a32_0x591315(0x1f1),{'value':!![]});var path=__importStar(require(a32_0x591315(0x1a9))),_=__importStar(require(a32_0x591315(0x1f9))),docker=__importStar(require(a32_0x591315(0x1f8))),logger_1=__importDefault(require('../../../common/logger')),dockerOpts=__importStar(require('../../docker/docker-opts')),fs=__importStar(require(a32_0x591315(0x1e1))),uuid_1=require(a32_0x591315(0x1c1)),rimraf=__importStar(require(a32_0x591315(0x1aa))),extract_zip_1=__importDefault(require(a32_0x591315(0x1cd))),tmpDir=__importStar(require('temp-dir')),devs_1=require(a32_0x591315(0x1ea)),runtime_1=require(a32_0x591315(0x1b9)),docker_1=require(a32_0x591315(0x1f8));function isZipArchive(_0x2cd956){var _0x1a5bdf=a32_0x591315;return _0x2cd956?_0x2cd956[_0x1a5bdf(0x1ae)](_0x1a5bdf(0x1ec))||_0x2cd956['endsWith'](_0x1a5bdf(0x1e7))||_0x2cd956[_0x1a5bdf(0x1ae)](_0x1a5bdf(0x1f6)):![];}function a32_0x34ba(_0x57249f,_0x2e8970){return a32_0x34ba=function(_0x1f3e7f,_0x34baf8){_0x1f3e7f=_0x1f3e7f-0x1a0;var _0x27746e=a32_0x1f3e[_0x1f3e7f];return _0x27746e;},a32_0x34ba(_0x57249f,_0x2e8970);}function processZipCodeIfNecessary(_0xb665d9){return __awaiter(this,void 0x0,void 0x0,function(){var _0x1bd210;return __generator(this,function(_0x286a5e){var _0x91ef15=a32_0x34ba;switch(_0x286a5e[_0x91ef15(0x1b2)]){case 0x0:if(!isZipArchive(_0xb665d9))return[0x2,null];_0x1bd210=path[_0x91ef15(0x1a0)](tmpDir,uuid_1['v4']());return[0x4,fs['ensureDir'](_0x1bd210)];case 0x1:_0x286a5e[_0x91ef15(0x1e4)](),logger_1['default']['log'](_0x91ef15(0x1d7)+_0x1bd210);return[0x4,extract_zip_1[_0x91ef15(0x1d1)](_0xb665d9,{'dir':_0x1bd210})];case 0x2:_0x286a5e[_0x91ef15(0x1e4)]();return[0x2,_0x1bd210];}});});}var Invoke=function(){var _0x5d94e0=a32_0x591315;function _0xd38f1d(_0x308265,_0x535bbe,_0x4412eb,_0x3e2b57,_0xd73059,_0x476648,_0x41ae70,_0x46d463,_0x45492b,_0x4edc00,_0x479ec5,_0x3f8f0f,_0x3933d8,_0x31ea96){var _0x2a1a97=a32_0x34ba;this[_0x2a1a97(0x1b0)]=_0x308265,this[_0x2a1a97(0x1d4)]=_0x535bbe,this[_0x2a1a97(0x1de)]=_0x4412eb,this[_0x2a1a97(0x1c3)]=_0x3e2b57,this[_0x2a1a97(0x1d0)]=_0x476648[_0x2a1a97(0x20b)],this[_0x2a1a97(0x1ac)]=_0x476648,this[_0x2a1a97(0x205)]=_0x41ae70[_0x2a1a97(0x20b)],this[_0x2a1a97(0x1c0)]=_0x41ae70,this['triggerConfig']=_0x46d463,this[_0x2a1a97(0x207)]=_0x45492b,this['debugIde']=_0x4edc00,this[_0x2a1a97(0x1bd)]=_0x31ea96,this[_0x2a1a97(0x209)]=this[_0x2a1a97(0x1c0)][_0x2a1a97(0x209)],this[_0x2a1a97(0x1dd)]=_0xd73059,this['codeUri']=this[_0x2a1a97(0x1c0)][_0x2a1a97(0x1a3)]?path['resolve'](this[_0x2a1a97(0x1dd)],this[_0x2a1a97(0x1c0)][_0x2a1a97(0x1a3)]):null,this['tmpDir']=_0x479ec5,this[_0x2a1a97(0x1e0)]=_0x3f8f0f,this[_0x2a1a97(0x1b3)]=_0x3933d8;}return _0xd38f1d[_0x5d94e0(0x1ee)][_0x5d94e0(0x1d3)]=function(){var _0x7e1e73;return __awaiter(this,void 0x0,void 0x0,function(){var _0x397dad,_0x102cb0,_0xa0e2a3,_0x2fe61b,_0x429086,_0x19f7e1,_0x3d58aa,_0x478bb0,_0x3b8463,_0x428c7c,_0x1289c5;return __generator(this,function(_0x22b26a){var _0x2d6665=a32_0x34ba;switch(_0x22b26a['label']){case 0x0:this[_0x2d6665(0x1f4)]=(_0x7e1e73=this[_0x2d6665(0x1ac)])===null||_0x7e1e73===void 0x0?void 0x0:_0x7e1e73['nasConfig'],_0x397dad=this;return[0x4,dockerOpts[_0x2d6665(0x1d6)]({'nasConfig':this['nasConfig']})];case 0x1:_0x397dad[_0x2d6665(0x1a7)]=_0x22b26a[_0x2d6665(0x1e4)](),_0x102cb0=this;return[0x4,docker[_0x2d6665(0x1be)](this[_0x2d6665(0x1dd)],this[_0x2d6665(0x1d0)],this[_0x2d6665(0x1f4)],this[_0x2d6665(0x1bd)]||path['join'](this['baseDir'],devs_1[_0x2d6665(0x1b5)]))];case 0x2:_0x102cb0[_0x2d6665(0x1c6)]=_0x22b26a[_0x2d6665(0x1e4)](),_0xa0e2a3=this;return[0x4,processZipCodeIfNecessary(this[_0x2d6665(0x1a3)])];case 0x3:_0xa0e2a3[_0x2d6665(0x1ab)]=_0x22b26a[_0x2d6665(0x1e4)](),_0x2fe61b=this;return[0x4,docker[_0x2d6665(0x1eb)](this[_0x2d6665(0x1ab)]||this[_0x2d6665(0x1a3)])];case 0x4:_0x2fe61b[_0x2d6665(0x1cc)]=_0x22b26a[_0x2d6665(0x1e4)](),_0x429086=this;return[0x4,docker[_0x2d6665(0x1f3)](this[_0x2d6665(0x1d8)])];case 0x5:_0x429086[_0x2d6665(0x1ed)]=_0x22b26a[_0x2d6665(0x1e4)](),_0x19f7e1=this;return[0x4,docker[_0x2d6665(0x1b1)](this[_0x2d6665(0x1e0)])];case 0x6:_0x19f7e1['debuggerMount']=_0x22b26a['sent'](),_0x3d58aa=this;return[0x4,docker[_0x2d6665(0x1f0)]()];case 0x7:_0x3d58aa[_0x2d6665(0x204)]=_0x22b26a[_0x2d6665(0x1e4)](),_0x478bb0=_[_0x2d6665(0x201)](__spreadArrays([this[_0x2d6665(0x1cc)]],this[_0x2d6665(0x1c6)],[this[_0x2d6665(0x204)]]));!_['isEmpty'](this[_0x2d6665(0x1ed)])&&_0x478bb0[_0x2d6665(0x206)](this['tmpDirMount']);!_['isEmpty'](this['debuggerMount'])&&_0x478bb0[_0x2d6665(0x206)](this[_0x2d6665(0x203)]);return[0x4,docker['isDockerToolBoxAndEnsureDockerVersion']()];case 0x8:_0x3b8463=_0x22b26a[_0x2d6665(0x1e4)]();_0x3b8463?this[_0x2d6665(0x1c2)]=dockerOpts[_0x2d6665(0x1cb)](_0x478bb0):this[_0x2d6665(0x1c2)]=_0x478bb0;logger_1[_0x2d6665(0x1d1)][_0x2d6665(0x1c5)]('docker\x20mounts:\x20'+JSON[_0x2d6665(0x1b8)](this[_0x2d6665(0x1c2)],null,0x4)),this[_0x2d6665(0x202)]=docker[_0x2d6665(0x1d2)](),_0x428c7c=runtime_1[_0x2d6665(0x1ef)](this['runtime']);if(!_0x428c7c)return[0x3,0x9];this[_0x2d6665(0x1e5)]=this['functionConfig'][_0x2d6665(0x1b4)][_0x2d6665(0x1bc)];return[0x3,0xb];case 0x9:_0x1289c5=this;return[0x4,dockerOpts[_0x2d6665(0x1e6)](this[_0x2d6665(0x209)])];case 0xa:_0x1289c5[_0x2d6665(0x1e5)]=_0x22b26a[_0x2d6665(0x1e4)](),_0x22b26a[_0x2d6665(0x1b2)]=0xb;case 0xb:return[0x4,docker[_0x2d6665(0x1b6)](this['imageName'])];case 0xc:_0x22b26a[_0x2d6665(0x1e4)](),this[_0x2d6665(0x1d9)]=!![];return[0x2];}});});},_0xd38f1d['prototype'][_0x5d94e0(0x1a2)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x381bb7){return[0x2];});});},_0xd38f1d[_0x5d94e0(0x1ee)][_0x5d94e0(0x1cf)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x3df378){var _0x79b17b=a32_0x34ba;switch(_0x3df378[_0x79b17b(0x1b2)]){case 0x0:if(!(this[_0x79b17b(0x207)]&&this[_0x79b17b(0x1c9)]))return[0x3,0x4];if(!(this[_0x79b17b(0x1c9)][_0x79b17b(0x1dc)]()===_0x79b17b(0x1f2)))return[0x3,0x2];return[0x4,docker['showDebugIdeTipsForVscode'](this[_0x79b17b(0x1d0)],this['functionName'],this['runtime'],this[_0x79b17b(0x1cc)][_0x79b17b(0x1b7)],this[_0x79b17b(0x207)])];case 0x1:_0x3df378[_0x79b17b(0x1e4)]();return[0x3,0x4];case 0x2:if(!(this[_0x79b17b(0x1c9)]['toLowerCase']()==='pycharm'))return[0x3,0x4];return[0x4,docker['showDebugIdeTipsForPycharm'](this[_0x79b17b(0x1cc)][_0x79b17b(0x1b7)],this[_0x79b17b(0x207)])];case 0x3:_0x3df378[_0x79b17b(0x1e4)](),_0x3df378[_0x79b17b(0x1b2)]=0x4;case 0x4:return[0x2];}});});},_0xd38f1d['prototype']['setDebugIdeConfig']=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x13bc26){var _0x23fd1e=a32_0x34ba;switch(_0x13bc26['label']){case 0x0:if(!(this[_0x23fd1e(0x207)]&&this[_0x23fd1e(0x1c9)]))return[0x3,0x2];if(!(this[_0x23fd1e(0x1c9)][_0x23fd1e(0x1dc)]()===_0x23fd1e(0x1f2)))return[0x3,0x2];return[0x4,docker_1[_0x23fd1e(0x1ce)](this[_0x23fd1e(0x1dd)],this['serviceName'],this[_0x23fd1e(0x205)],this[_0x23fd1e(0x209)],this[_0x23fd1e(0x1cc)][_0x23fd1e(0x1b7)],this['debugPort'])];case 0x1:_0x13bc26[_0x23fd1e(0x1e4)](),_0x13bc26[_0x23fd1e(0x1b2)]=0x2;case 0x2:return[0x2];}});});},_0xd38f1d['prototype'][_0x5d94e0(0x200)]=function(){var _0x1ad646=_0x5d94e0;this['unzippedCodeDir']&&(rimraf[_0x1ad646(0x1af)](this['unzippedCodeDir']),console[_0x1ad646(0x208)]('clean\x20tmp\x20code\x20dir\x20'+this['unzippedCodeDir']+'\x20successfully'),this[_0x1ad646(0x1ab)]=null);},_0xd38f1d['prototype']['afterInvoke']=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x3e6f25){var _0x2ce208=a32_0x34ba;return this[_0x2ce208(0x200)](),[0x2];});});},_0xd38f1d;}();exports['default']=Invoke;