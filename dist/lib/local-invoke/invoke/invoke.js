'use strict';var a32_0x5c23=['debuggerMount','transformMountsForToolbox','DISABLE_BIND_MOUNT_TMP_DIR','rimraf','__esModule','fs-extra','afterInvoke','../../docker/docker','\x20successfully','toLowerCase','resolveDockerUser','customContainerConfig','creds','codeUri','tunnelService','resolvePasswdMount','__awaiter','257084bNxEPf','resolveNasConfigToMounts','__createBinding','debug','590028YLpBxM','tmpDir','iterator','__importDefault','sessionId','debugIde','nasBaseDir','cleanUnzippedCodeDir','resolveRuntimeToDockerImage','../../../common/logger','functionConfig','1ixqufh','tmpDirMount','isFalseValue','.jar','stringify','length','serviceName','imageName','sent','clean\x20tmp\x20code\x20dir\x20','trys','label','nasConfig','codeUri\x20is\x20a\x20zip\x20format,\x20will\x20unzipping\x20to\x20','return','temp-dir','generateRamdomContainerName','env','docker\x20mounts:\x20','push','isCustomContainerRuntime','DEFAULT_NAS_PATH_SUFFIX','functionName','apply','function','lodash','name','debugPort','resolve','serviceConfig','writeDebugIdeConfigForVscode','981TRjlHB','mounts','done','create','2bYQOGW','pycharm','Source','ops','containerName','endsWith','__importStar','527416JWhabR','value','vscode','baseDir','../../docker/docker-opts','.zip','runtime','throw','hasOwnProperty','unzippedCodeDir','debugArgs','isEmpty','next','path','call','then','1483161OKmhaA','triggerConfig','../../utils/runtime','pop','nasMounts','uuid','showDebugIdeTipsForPycharm','passwdMount','isDockerToolBoxAndEnsureDockerVersion','704381XMlLAv','pullFcImageIfNeed','prototype','dockerUser','join','originalCodeUri','debuggerPath','extract-zip','default','353681gGoUtT','inited','codeMount','defineProperty','compact','543EwijGL','setDebugIdeConfig','__spreadArrays','log'];var a32_0xab682f=a32_0x4ee2;(function(_0x1c9c88,_0x837ffe){var _0x2f90a1=a32_0x4ee2;while(!![]){try{var _0x308ffa=parseInt(_0x2f90a1(0x1d8))+parseInt(_0x2f90a1(0x1ba))*-parseInt(_0x2f90a1(0x191))+parseInt(_0x2f90a1(0x18d))*-parseInt(_0x2f90a1(0x1bf))+-parseInt(_0x2f90a1(0x1e3))*-parseInt(_0x2f90a1(0x198))+-parseInt(_0x2f90a1(0x1d4))+-parseInt(_0x2f90a1(0x1b1))+parseInt(_0x2f90a1(0x1a8));if(_0x308ffa===_0x837ffe)break;else _0x1c9c88['push'](_0x1c9c88['shift']());}catch(_0x5451dc){_0x1c9c88['push'](_0x1c9c88['shift']());}}}(a32_0x5c23,0x616f7));function a32_0x4ee2(_0x359176,_0x2ade85){return a32_0x4ee2=function(_0x5c2379,_0x4ee264){_0x5c2379=_0x5c2379-0x18c;var _0x13ef4a=a32_0x5c23[_0x5c2379];return _0x13ef4a;},a32_0x4ee2(_0x359176,_0x2ade85);}var __createBinding=this&&this[a32_0xab682f(0x1d6)]||(Object[a32_0xab682f(0x190)]?function(_0x1aaba1,_0x595b5,_0x586f2c,_0x1d0c88){var _0x4c3812=a32_0xab682f;if(_0x1d0c88===undefined)_0x1d0c88=_0x586f2c;Object[_0x4c3812(0x1bd)](_0x1aaba1,_0x1d0c88,{'enumerable':!![],'get':function(){return _0x595b5[_0x586f2c];}});}:function(_0xb95676,_0x2a1709,_0x2ebaf0,_0x3daed1){if(_0x3daed1===undefined)_0x3daed1=_0x2ebaf0;_0xb95676[_0x3daed1]=_0x2a1709[_0x2ebaf0];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a32_0xab682f(0x190)]?function(_0x57a76e,_0x3f93fe){var _0xa7864a=a32_0xab682f;Object[_0xa7864a(0x1bd)](_0x57a76e,_0xa7864a(0x1b9),{'enumerable':!![],'value':_0x3f93fe});}:function(_0x16a731,_0x294124){var _0x4c42be=a32_0xab682f;_0x16a731[_0x4c42be(0x1b9)]=_0x294124;}),__importStar=this&&this[a32_0xab682f(0x197)]||function(_0x4e7dea){var _0x532683=a32_0xab682f;if(_0x4e7dea&&_0x4e7dea['__esModule'])return _0x4e7dea;var _0x4d3994={};if(_0x4e7dea!=null){for(var _0x2e88a7 in _0x4e7dea)if(_0x2e88a7!=='default'&&Object[_0x532683(0x1a0)][_0x532683(0x1a6)](_0x4e7dea,_0x2e88a7))__createBinding(_0x4d3994,_0x4e7dea,_0x2e88a7);}return __setModuleDefault(_0x4d3994,_0x4e7dea),_0x4d3994;},__awaiter=this&&this[a32_0xab682f(0x1d3)]||function(_0x1f4ea6,_0x1baa26,_0x5865c8,_0x24b9ff){function _0x27657b(_0x2d3ccd){return _0x2d3ccd instanceof _0x5865c8?_0x2d3ccd:new _0x5865c8(function(_0x5a9b97){_0x5a9b97(_0x2d3ccd);});}return new(_0x5865c8||(_0x5865c8=Promise))(function(_0x2e4280,_0x2cfe00){var _0x447d37=a32_0x4ee2;function _0x4424de(_0x32a177){try{_0x411cc9(_0x24b9ff['next'](_0x32a177));}catch(_0x37b807){_0x2cfe00(_0x37b807);}}function _0x34725c(_0x330af2){var _0x2ffb9c=a32_0x4ee2;try{_0x411cc9(_0x24b9ff[_0x2ffb9c(0x19f)](_0x330af2));}catch(_0x46d9b8){_0x2cfe00(_0x46d9b8);}}function _0x411cc9(_0x4a6dd3){var _0x3f1eed=a32_0x4ee2;_0x4a6dd3[_0x3f1eed(0x18f)]?_0x2e4280(_0x4a6dd3[_0x3f1eed(0x199)]):_0x27657b(_0x4a6dd3[_0x3f1eed(0x199)])[_0x3f1eed(0x1a7)](_0x4424de,_0x34725c);}_0x411cc9((_0x24b9ff=_0x24b9ff[_0x447d37(0x1fa)](_0x1f4ea6,_0x1baa26||[]))[_0x447d37(0x1a4)]());});},__generator=this&&this['__generator']||function(_0x24a8c2,_0x5705e1){var _0xd8080e=a32_0xab682f,_0x10c901={'label':0x0,'sent':function(){if(_0x4e8be1[0x0]&0x1)throw _0x4e8be1[0x1];return _0x4e8be1[0x1];},'trys':[],'ops':[]},_0x5595c4,_0x49277b,_0x4e8be1,_0x3135bf;return _0x3135bf={'next':_0x3b4c62(0x0),'throw':_0x3b4c62(0x1),'return':_0x3b4c62(0x2)},typeof Symbol===_0xd8080e(0x1fb)&&(_0x3135bf[Symbol[_0xd8080e(0x1da)]]=function(){return this;}),_0x3135bf;function _0x3b4c62(_0x4aa00c){return function(_0x1ea9ac){return _0x51f290([_0x4aa00c,_0x1ea9ac]);};}function _0x51f290(_0x27b182){var _0x19f99c=_0xd8080e;if(_0x5595c4)throw new TypeError('Generator\x20is\x20already\x20executing.');while(_0x10c901)try{if(_0x5595c4=0x1,_0x49277b&&(_0x4e8be1=_0x27b182[0x0]&0x2?_0x49277b[_0x19f99c(0x1f1)]:_0x27b182[0x0]?_0x49277b['throw']||((_0x4e8be1=_0x49277b[_0x19f99c(0x1f1)])&&_0x4e8be1[_0x19f99c(0x1a6)](_0x49277b),0x0):_0x49277b[_0x19f99c(0x1a4)])&&!(_0x4e8be1=_0x4e8be1[_0x19f99c(0x1a6)](_0x49277b,_0x27b182[0x1]))['done'])return _0x4e8be1;if(_0x49277b=0x0,_0x4e8be1)_0x27b182=[_0x27b182[0x0]&0x2,_0x4e8be1[_0x19f99c(0x199)]];switch(_0x27b182[0x0]){case 0x0:case 0x1:_0x4e8be1=_0x27b182;break;case 0x4:_0x10c901[_0x19f99c(0x1ee)]++;return{'value':_0x27b182[0x1],'done':![]};case 0x5:_0x10c901['label']++,_0x49277b=_0x27b182[0x1],_0x27b182=[0x0];continue;case 0x7:_0x27b182=_0x10c901[_0x19f99c(0x194)][_0x19f99c(0x1ab)](),_0x10c901[_0x19f99c(0x1ed)][_0x19f99c(0x1ab)]();continue;default:if(!(_0x4e8be1=_0x10c901[_0x19f99c(0x1ed)],_0x4e8be1=_0x4e8be1['length']>0x0&&_0x4e8be1[_0x4e8be1[_0x19f99c(0x1e8)]-0x1])&&(_0x27b182[0x0]===0x6||_0x27b182[0x0]===0x2)){_0x10c901=0x0;continue;}if(_0x27b182[0x0]===0x3&&(!_0x4e8be1||_0x27b182[0x1]>_0x4e8be1[0x0]&&_0x27b182[0x1]<_0x4e8be1[0x3])){_0x10c901['label']=_0x27b182[0x1];break;}if(_0x27b182[0x0]===0x6&&_0x10c901['label']<_0x4e8be1[0x1]){_0x10c901[_0x19f99c(0x1ee)]=_0x4e8be1[0x1],_0x4e8be1=_0x27b182;break;}if(_0x4e8be1&&_0x10c901[_0x19f99c(0x1ee)]<_0x4e8be1[0x2]){_0x10c901[_0x19f99c(0x1ee)]=_0x4e8be1[0x2],_0x10c901[_0x19f99c(0x194)][_0x19f99c(0x1f6)](_0x27b182);break;}if(_0x4e8be1[0x2])_0x10c901[_0x19f99c(0x194)][_0x19f99c(0x1ab)]();_0x10c901[_0x19f99c(0x1ed)][_0x19f99c(0x1ab)]();continue;}_0x27b182=_0x5705e1[_0x19f99c(0x1a6)](_0x24a8c2,_0x10c901);}catch(_0x2a3e90){_0x27b182=[0x6,_0x2a3e90],_0x49277b=0x0;}finally{_0x5595c4=_0x4e8be1=0x0;}if(_0x27b182[0x0]&0x5)throw _0x27b182[0x1];return{'value':_0x27b182[0x0]?_0x27b182[0x1]:void 0x0,'done':!![]};}},__spreadArrays=this&&this[a32_0xab682f(0x1c1)]||function(){var _0x3f79f9=a32_0xab682f;for(var _0x222a5b=0x0,_0x8e21e=0x0,_0xe8ce13=arguments['length'];_0x8e21e<_0xe8ce13;_0x8e21e++)_0x222a5b+=arguments[_0x8e21e][_0x3f79f9(0x1e8)];for(var _0x3ea61b=Array(_0x222a5b),_0x366c2c=0x0,_0x8e21e=0x0;_0x8e21e<_0xe8ce13;_0x8e21e++)for(var _0x174d0a=arguments[_0x8e21e],_0x323bf6=0x0,_0x1fef0f=_0x174d0a['length'];_0x323bf6<_0x1fef0f;_0x323bf6++,_0x366c2c++)_0x3ea61b[_0x366c2c]=_0x174d0a[_0x323bf6];return _0x3ea61b;},__importDefault=this&&this[a32_0xab682f(0x1db)]||function(_0x190486){var _0x2fc6b0=a32_0xab682f;return _0x190486&&_0x190486[_0x2fc6b0(0x1c7)]?_0x190486:{'default':_0x190486};};Object[a32_0xab682f(0x1bd)](exports,a32_0xab682f(0x1c7),{'value':!![]});var path=__importStar(require(a32_0xab682f(0x1a5))),_=__importStar(require(a32_0xab682f(0x1fc))),docker=__importStar(require(a32_0xab682f(0x1ca))),logger_1=__importDefault(require(a32_0xab682f(0x1e1))),dockerOpts=__importStar(require(a32_0xab682f(0x19c))),fs=__importStar(require(a32_0xab682f(0x1c8))),uuid_1=require(a32_0xab682f(0x1ad)),rimraf=__importStar(require(a32_0xab682f(0x1c6))),extract_zip_1=__importDefault(require(a32_0xab682f(0x1b8))),tmpDir=__importStar(require(a32_0xab682f(0x1f2))),devs_1=require('../../devs'),runtime_1=require(a32_0xab682f(0x1aa)),docker_1=require(a32_0xab682f(0x1ca)),utils_1=require('../../utils/utils');function isZipArchive(_0x1bfa67){var _0x68b92=a32_0xab682f;return _0x1bfa67?_0x1bfa67['endsWith'](_0x68b92(0x19d))||_0x1bfa67[_0x68b92(0x196)](_0x68b92(0x1e6))||_0x1bfa67[_0x68b92(0x196)]('.war'):![];}function processZipCodeIfNecessary(_0x2c3f57){return __awaiter(this,void 0x0,void 0x0,function(){var _0x4590b2;return __generator(this,function(_0xfda388){var _0x546922=a32_0x4ee2;switch(_0xfda388[_0x546922(0x1ee)]){case 0x0:if(!isZipArchive(_0x2c3f57))return[0x2,null];_0x4590b2=path[_0x546922(0x1b5)](tmpDir,uuid_1['v4']());return[0x4,fs['ensureDir'](_0x4590b2)];case 0x1:_0xfda388[_0x546922(0x1eb)](),logger_1['default']['log'](_0x546922(0x1f0)+_0x4590b2);return[0x4,extract_zip_1[_0x546922(0x1b9)](_0x2c3f57,{'dir':_0x4590b2})];case 0x2:_0xfda388[_0x546922(0x1eb)]();return[0x2,_0x4590b2];}});});}var Invoke=function(){var _0x2845c0=a32_0xab682f;function _0x3cd878(_0x58f870,_0x9a32dd,_0x264681,_0x1b1983,_0x42d17a,_0x2bae9c,_0x1c67e0,_0x29d3ed,_0x4f9eed,_0x34b65d,_0x7274d8,_0x2fc4d6,_0x3dc3cf,_0x503a79){var _0x29f1b7=a32_0x4ee2;this[_0x29f1b7(0x1d1)]=_0x58f870,this[_0x29f1b7(0x1dc)]=_0x9a32dd,this[_0x29f1b7(0x1cf)]=_0x264681,this['region']=_0x1b1983,this[_0x29f1b7(0x1e9)]=_0x2bae9c[_0x29f1b7(0x1fd)],this[_0x29f1b7(0x200)]=_0x2bae9c,this[_0x29f1b7(0x1f9)]=_0x1c67e0['name'],this['functionConfig']=_0x1c67e0,this[_0x29f1b7(0x1a9)]=_0x29d3ed,this[_0x29f1b7(0x1fe)]=_0x4f9eed,this[_0x29f1b7(0x1dd)]=_0x34b65d,this['nasBaseDir']=_0x503a79,this[_0x29f1b7(0x19e)]=this[_0x29f1b7(0x1e2)]['runtime'],this[_0x29f1b7(0x19b)]=_0x42d17a,this[_0x29f1b7(0x1d0)]=this[_0x29f1b7(0x1e2)][_0x29f1b7(0x1d0)]?path[_0x29f1b7(0x1ff)](this[_0x29f1b7(0x19b)],this['functionConfig'][_0x29f1b7(0x1d0)]):null,this[_0x29f1b7(0x1d9)]=_0x7274d8,this[_0x29f1b7(0x1b7)]=_0x2fc4d6,this[_0x29f1b7(0x1a2)]=_0x3dc3cf;}return _0x3cd878[_0x2845c0(0x1b3)]['init']=function(){var _0xa93b18,_0x31a74b;return __awaiter(this,void 0x0,void 0x0,function(){var _0x3ce81e,_0xbe542d,_0x1c1ed8,_0x28d348,_0x3b5c39,_0x114fce,_0x1d534c,_0x1612c8,_0x277b58,_0x597fa8,_0x3c5e3b,_0x1dbedf;return __generator(this,function(_0x5dd9c7){var _0x235b67=a32_0x4ee2;switch(_0x5dd9c7[_0x235b67(0x1ee)]){case 0x0:this[_0x235b67(0x1ef)]=(_0xa93b18=this[_0x235b67(0x200)])===null||_0xa93b18===void 0x0?void 0x0:_0xa93b18[_0x235b67(0x1ef)],_0x3ce81e=this;return[0x4,dockerOpts[_0x235b67(0x1cd)]({'nasConfig':this['nasConfig']})];case 0x1:_0x3ce81e[_0x235b67(0x1b4)]=_0x5dd9c7['sent'](),_0xbe542d=this;return[0x4,docker[_0x235b67(0x1d5)](this['baseDir'],this[_0x235b67(0x1e9)],this[_0x235b67(0x1ef)],this[_0x235b67(0x1de)]||path[_0x235b67(0x1b5)](this['baseDir'],devs_1[_0x235b67(0x1f8)]))];case 0x2:_0xbe542d['nasMounts']=_0x5dd9c7[_0x235b67(0x1eb)](),_0x1c1ed8=this;return[0x4,processZipCodeIfNecessary(this[_0x235b67(0x1d0)])];case 0x3:_0x1c1ed8['unzippedCodeDir']=_0x5dd9c7[_0x235b67(0x1eb)](),_0x28d348=this;return[0x4,docker['resolveCodeUriToMount'](this[_0x235b67(0x1a1)]||((_0x31a74b=this['functionConfig'])===null||_0x31a74b===void 0x0?void 0x0:_0x31a74b[_0x235b67(0x1b6)])?path[_0x235b67(0x1b5)](this['baseDir'],this['functionConfig'][_0x235b67(0x1b6)]):null)];case 0x4:_0x28d348[_0x235b67(0x1bc)]=_0x5dd9c7[_0x235b67(0x1eb)](),_0x3b5c39=this;if(!(!process[_0x235b67(0x1f4)][_0x235b67(0x1c5)]||utils_1[_0x235b67(0x1e5)](process[_0x235b67(0x1f4)][_0x235b67(0x1c5)])))return[0x3,0x6];return[0x4,docker['resolveTmpDirToMount'](this['tmpDir'])];case 0x5:_0x114fce=_0x5dd9c7[_0x235b67(0x1eb)]();return[0x3,0x7];case 0x6:_0x114fce=null,_0x5dd9c7[_0x235b67(0x1ee)]=0x7;case 0x7:_0x3b5c39[_0x235b67(0x1e4)]=_0x114fce,_0x1d534c=this;return[0x4,docker['resolveDebuggerPathToMount'](this['debuggerPath'])];case 0x8:_0x1d534c['debuggerMount']=_0x5dd9c7[_0x235b67(0x1eb)](),_0x1612c8=this;return[0x4,docker[_0x235b67(0x1d2)]()];case 0x9:_0x1612c8[_0x235b67(0x1af)]=_0x5dd9c7[_0x235b67(0x1eb)](),_0x277b58=_[_0x235b67(0x1be)](__spreadArrays([this[_0x235b67(0x1bc)]],this[_0x235b67(0x1ac)],[this[_0x235b67(0x1af)]]));!_[_0x235b67(0x1a3)](this[_0x235b67(0x1e4)])&&_0x277b58[_0x235b67(0x1f6)](this[_0x235b67(0x1e4)]);!_[_0x235b67(0x1a3)](this[_0x235b67(0x1c3)])&&_0x277b58['push'](this[_0x235b67(0x1c3)]);return[0x4,docker[_0x235b67(0x1b0)]()];case 0xa:_0x597fa8=_0x5dd9c7[_0x235b67(0x1eb)]();_0x597fa8?this[_0x235b67(0x18e)]=dockerOpts[_0x235b67(0x1c4)](_0x277b58):this['mounts']=_0x277b58;logger_1[_0x235b67(0x1b9)][_0x235b67(0x1d7)](_0x235b67(0x1f5)+JSON[_0x235b67(0x1e7)](this[_0x235b67(0x18e)],null,0x4)),this[_0x235b67(0x195)]=docker[_0x235b67(0x1f3)](),_0x3c5e3b=runtime_1[_0x235b67(0x1f7)](this[_0x235b67(0x19e)]);if(!_0x3c5e3b)return[0x3,0xb];this[_0x235b67(0x1ea)]=this[_0x235b67(0x1e2)][_0x235b67(0x1ce)]['image'];return[0x3,0xd];case 0xb:_0x1dbedf=this;return[0x4,dockerOpts[_0x235b67(0x1e0)](this[_0x235b67(0x19e)])];case 0xc:_0x1dbedf['imageName']=_0x5dd9c7['sent'](),_0x5dd9c7[_0x235b67(0x1ee)]=0xd;case 0xd:return[0x4,docker[_0x235b67(0x1b2)](this[_0x235b67(0x1ea)])];case 0xe:_0x5dd9c7['sent'](),this[_0x235b67(0x1bb)]=!![];return[0x2];}});});},_0x3cd878['prototype']['beforeInvoke']=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x42217d){return[0x2];});});},_0x3cd878[_0x2845c0(0x1b3)]['showDebugIdeTips']=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x584028){var _0x2468ec=a32_0x4ee2;switch(_0x584028[_0x2468ec(0x1ee)]){case 0x0:if(!(this[_0x2468ec(0x1fe)]&&this[_0x2468ec(0x1dd)]))return[0x3,0x4];if(!(this['debugIde'][_0x2468ec(0x1cc)]()===_0x2468ec(0x19a)))return[0x3,0x2];return[0x4,docker['showDebugIdeTipsForVscode'](this[_0x2468ec(0x1e9)],this[_0x2468ec(0x1f9)],this['runtime'],this[_0x2468ec(0x1bc)][_0x2468ec(0x193)],this['debugPort'])];case 0x1:_0x584028['sent']();return[0x3,0x4];case 0x2:if(!(this[_0x2468ec(0x1dd)][_0x2468ec(0x1cc)]()===_0x2468ec(0x192)))return[0x3,0x4];return[0x4,docker[_0x2468ec(0x1ae)](this['codeMount'][_0x2468ec(0x193)],this[_0x2468ec(0x1fe)])];case 0x3:_0x584028[_0x2468ec(0x1eb)](),_0x584028[_0x2468ec(0x1ee)]=0x4;case 0x4:return[0x2];}});});},_0x3cd878[_0x2845c0(0x1b3)][_0x2845c0(0x1c0)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x19121a){var _0x47a399=a32_0x4ee2;switch(_0x19121a[_0x47a399(0x1ee)]){case 0x0:if(!(this[_0x47a399(0x1fe)]&&this[_0x47a399(0x1dd)]))return[0x3,0x2];if(!(this[_0x47a399(0x1dd)][_0x47a399(0x1cc)]()===_0x47a399(0x19a)))return[0x3,0x2];return[0x4,docker_1[_0x47a399(0x18c)](this[_0x47a399(0x19b)],this[_0x47a399(0x1e9)],this['functionName'],this[_0x47a399(0x19e)],this[_0x47a399(0x1bc)][_0x47a399(0x193)],this['debugPort'])];case 0x1:_0x19121a[_0x47a399(0x1eb)](),_0x19121a['label']=0x2;case 0x2:return[0x2];}});});},_0x3cd878[_0x2845c0(0x1b3)][_0x2845c0(0x1df)]=function(){var _0x5858f8=_0x2845c0;this['unzippedCodeDir']&&(rimraf['sync'](this[_0x5858f8(0x1a1)]),console[_0x5858f8(0x1c2)](_0x5858f8(0x1ec)+this['unzippedCodeDir']+_0x5858f8(0x1cb)),this[_0x5858f8(0x1a1)]=null);},_0x3cd878[_0x2845c0(0x1b3)][_0x2845c0(0x1c9)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x38e541){return this['cleanUnzippedCodeDir'](),[0x2];});});},_0x3cd878;}();exports['default']=Invoke;