'use strict';var a31_0x55cb=['tmpDir','pop','iterator','showDebugIdeTipsForVscode','toLowerCase','ensureDir','passwdMount','throw','getState','creds','debuggerMount','image','92703RyYsXK','.zip','imageName','docker\x20mounts:\x20','join','length','sync','customContainerConfig','resolvePasswdMount','3346RxOGXd','debugIde','create','1dzKeNx','codeUri','unzippedCodeDir','rimraf','default','serviceName','function','resolve','__generator','genStateId','isCustomContainerRuntime','return','resolveDockerUser','extract-zip','tmpDirMount','compact','AccountID','cleanUnzippedCodeDir','debugPort','init','525037tTAjaK','14CwqCvI','name','\x20successfully','51283dvbapn','122gbdMHL','isDockerToolBoxAndEnsureDockerVersion','4357AAruSz','nasBaseDir','../../devs','dockerUser','baseDir','codeUri\x20is\x20a\x20zip\x20format,\x20will\x20unzipping\x20to\x20','done','debug','fs-extra','__esModule','transformMountsForToolbox','resolveCodeUriToMount','29553RJSljV','call','Source','2gAmgYo','functionConfig','defineProperty','then','runtime','temp-dir','next','resolveRuntimeToDockerImage','log','showDebugIdeTips','triggerConfig','serviceConfig','__awaiter','label','path','../../../common/logger','ops','codeMount','beforeInvoke','stringify','prototype','nasConfig','debuggerPath','../../utils/runtime','pycharm','@serverless-devs/core','sessionId','mounts','endsWith','afterInvoke','sent','value','Generator\x20is\x20already\x20executing.','resolveDebuggerPathToMount','functionName','debugArgs','548953SXswFF','../../docker/docker-opts','apply','__createBinding','push','trys'];var a31_0x2af4db=a31_0x3a16;(function(_0x2a9d9f,_0x2d28c2){var _0x48ab34=a31_0x3a16;while(!![]){try{var _0x3baca6=parseInt(_0x48ab34(0x203))*-parseInt(_0x48ab34(0x206))+-parseInt(_0x48ab34(0x1f5))*-parseInt(_0x48ab34(0x1f7))+parseInt(_0x48ab34(0x22a))+-parseInt(_0x48ab34(0x1f4))+parseInt(_0x48ab34(0x1dc))*-parseInt(_0x48ab34(0x1f0))+-parseInt(_0x48ab34(0x23c))+parseInt(_0x48ab34(0x1f1))*-parseInt(_0x48ab34(0x1d9));if(_0x3baca6===_0x2d28c2)break;else _0x2a9d9f['push'](_0x2a9d9f['shift']());}catch(_0x3cc926){_0x2a9d9f['push'](_0x2a9d9f['shift']());}}}(a31_0x55cb,0x4a97e));function a31_0x3a16(_0x4f774a,_0x516467){return a31_0x3a16=function(_0x55cb30,_0x3a162a){_0x55cb30=_0x55cb30-0x1d7;var _0x5f1a4b=a31_0x55cb[_0x55cb30];return _0x5f1a4b;},a31_0x3a16(_0x4f774a,_0x516467);}var __createBinding=this&&this[a31_0x2af4db(0x22d)]||(Object[a31_0x2af4db(0x1db)]?function(_0x306840,_0x3cccd5,_0x1577e9,_0x3d9d07){var _0x4d1590=a31_0x2af4db;if(_0x3d9d07===undefined)_0x3d9d07=_0x1577e9;Object[_0x4d1590(0x208)](_0x306840,_0x3d9d07,{'enumerable':!![],'get':function(){return _0x3cccd5[_0x1577e9];}});}:function(_0x23ae44,_0x2ab2ae,_0x5c5272,_0x29beee){if(_0x29beee===undefined)_0x29beee=_0x5c5272;_0x23ae44[_0x29beee]=_0x2ab2ae[_0x5c5272];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a31_0x2af4db(0x1db)]?function(_0x2a069b,_0x24404e){var _0x2a6610=a31_0x2af4db;Object['defineProperty'](_0x2a069b,_0x2a6610(0x1e0),{'enumerable':!![],'value':_0x24404e});}:function(_0x352693,_0x53fb28){_0x352693['default']=_0x53fb28;}),__importStar=this&&this['__importStar']||function(_0x1ef5a1){var _0x54bdd5=a31_0x2af4db;if(_0x1ef5a1&&_0x1ef5a1[_0x54bdd5(0x200)])return _0x1ef5a1;var _0x5307ee={};if(_0x1ef5a1!=null){for(var _0x242178 in _0x1ef5a1)if(_0x242178!==_0x54bdd5(0x1e0)&&Object['hasOwnProperty'][_0x54bdd5(0x204)](_0x1ef5a1,_0x242178))__createBinding(_0x5307ee,_0x1ef5a1,_0x242178);}return __setModuleDefault(_0x5307ee,_0x1ef5a1),_0x5307ee;},__awaiter=this&&this[a31_0x2af4db(0x212)]||function(_0x232bc3,_0x327f2d,_0x1668ce,_0x41b994){function _0x3a84b5(_0x3e8c57){return _0x3e8c57 instanceof _0x1668ce?_0x3e8c57:new _0x1668ce(function(_0x49d540){_0x49d540(_0x3e8c57);});}return new(_0x1668ce||(_0x1668ce=Promise))(function(_0x14b8ba,_0x5babf3){var _0x56dc90=a31_0x3a16;function _0x99b0f4(_0xe1d3f9){try{_0x4a050b(_0x41b994['next'](_0xe1d3f9));}catch(_0x59128c){_0x5babf3(_0x59128c);}}function _0x58b5d4(_0x1ebce0){var _0x35e586=a31_0x3a16;try{_0x4a050b(_0x41b994[_0x35e586(0x237)](_0x1ebce0));}catch(_0x29b392){_0x5babf3(_0x29b392);}}function _0x4a050b(_0x4d42cd){var _0x27a68a=a31_0x3a16;_0x4d42cd[_0x27a68a(0x1fd)]?_0x14b8ba(_0x4d42cd[_0x27a68a(0x225)]):_0x3a84b5(_0x4d42cd[_0x27a68a(0x225)])[_0x27a68a(0x209)](_0x99b0f4,_0x58b5d4);}_0x4a050b((_0x41b994=_0x41b994[_0x56dc90(0x22c)](_0x232bc3,_0x327f2d||[]))[_0x56dc90(0x20c)]());});},__generator=this&&this[a31_0x2af4db(0x1e4)]||function(_0x50edf8,_0x428597){var _0x567a4e=a31_0x2af4db,_0x2a5bf7={'label':0x0,'sent':function(){if(_0x240f0c[0x0]&0x1)throw _0x240f0c[0x1];return _0x240f0c[0x1];},'trys':[],'ops':[]},_0x35b4c9,_0x522779,_0x240f0c,_0x4a4671;return _0x4a4671={'next':_0x2721b8(0x0),'throw':_0x2721b8(0x1),'return':_0x2721b8(0x2)},typeof Symbol===_0x567a4e(0x1e2)&&(_0x4a4671[Symbol[_0x567a4e(0x232)]]=function(){return this;}),_0x4a4671;function _0x2721b8(_0x4778e0){return function(_0x9c1edb){return _0x44c1d8([_0x4778e0,_0x9c1edb]);};}function _0x44c1d8(_0x5a5359){var _0x55fb97=_0x567a4e;if(_0x35b4c9)throw new TypeError(_0x55fb97(0x226));while(_0x2a5bf7)try{if(_0x35b4c9=0x1,_0x522779&&(_0x240f0c=_0x5a5359[0x0]&0x2?_0x522779['return']:_0x5a5359[0x0]?_0x522779[_0x55fb97(0x237)]||((_0x240f0c=_0x522779[_0x55fb97(0x1e7)])&&_0x240f0c[_0x55fb97(0x204)](_0x522779),0x0):_0x522779[_0x55fb97(0x20c)])&&!(_0x240f0c=_0x240f0c[_0x55fb97(0x204)](_0x522779,_0x5a5359[0x1]))['done'])return _0x240f0c;if(_0x522779=0x0,_0x240f0c)_0x5a5359=[_0x5a5359[0x0]&0x2,_0x240f0c[_0x55fb97(0x225)]];switch(_0x5a5359[0x0]){case 0x0:case 0x1:_0x240f0c=_0x5a5359;break;case 0x4:_0x2a5bf7['label']++;return{'value':_0x5a5359[0x1],'done':![]};case 0x5:_0x2a5bf7[_0x55fb97(0x213)]++,_0x522779=_0x5a5359[0x1],_0x5a5359=[0x0];continue;case 0x7:_0x5a5359=_0x2a5bf7[_0x55fb97(0x216)][_0x55fb97(0x231)](),_0x2a5bf7[_0x55fb97(0x22f)]['pop']();continue;default:if(!(_0x240f0c=_0x2a5bf7[_0x55fb97(0x22f)],_0x240f0c=_0x240f0c[_0x55fb97(0x241)]>0x0&&_0x240f0c[_0x240f0c[_0x55fb97(0x241)]-0x1])&&(_0x5a5359[0x0]===0x6||_0x5a5359[0x0]===0x2)){_0x2a5bf7=0x0;continue;}if(_0x5a5359[0x0]===0x3&&(!_0x240f0c||_0x5a5359[0x1]>_0x240f0c[0x0]&&_0x5a5359[0x1]<_0x240f0c[0x3])){_0x2a5bf7['label']=_0x5a5359[0x1];break;}if(_0x5a5359[0x0]===0x6&&_0x2a5bf7[_0x55fb97(0x213)]<_0x240f0c[0x1]){_0x2a5bf7['label']=_0x240f0c[0x1],_0x240f0c=_0x5a5359;break;}if(_0x240f0c&&_0x2a5bf7[_0x55fb97(0x213)]<_0x240f0c[0x2]){_0x2a5bf7[_0x55fb97(0x213)]=_0x240f0c[0x2],_0x2a5bf7[_0x55fb97(0x216)][_0x55fb97(0x22e)](_0x5a5359);break;}if(_0x240f0c[0x2])_0x2a5bf7[_0x55fb97(0x216)]['pop']();_0x2a5bf7['trys']['pop']();continue;}_0x5a5359=_0x428597['call'](_0x50edf8,_0x2a5bf7);}catch(_0x2c399b){_0x5a5359=[0x6,_0x2c399b],_0x522779=0x0;}finally{_0x35b4c9=_0x240f0c=0x0;}if(_0x5a5359[0x0]&0x5)throw _0x5a5359[0x1];return{'value':_0x5a5359[0x0]?_0x5a5359[0x1]:void 0x0,'done':!![]};}},__spreadArrays=this&&this['__spreadArrays']||function(){var _0x3f69cf=a31_0x2af4db;for(var _0x3d1b04=0x0,_0x1c3e12=0x0,_0x4be274=arguments[_0x3f69cf(0x241)];_0x1c3e12<_0x4be274;_0x1c3e12++)_0x3d1b04+=arguments[_0x1c3e12][_0x3f69cf(0x241)];for(var _0xb5777c=Array(_0x3d1b04),_0x5174e0=0x0,_0x1c3e12=0x0;_0x1c3e12<_0x4be274;_0x1c3e12++)for(var _0x5b015f=arguments[_0x1c3e12],_0x546ff1=0x0,_0x50de8b=_0x5b015f[_0x3f69cf(0x241)];_0x546ff1<_0x50de8b;_0x546ff1++,_0x5174e0++)_0xb5777c[_0x5174e0]=_0x5b015f[_0x546ff1];return _0xb5777c;},__importDefault=this&&this['__importDefault']||function(_0x5b212b){var _0x425027=a31_0x2af4db;return _0x5b212b&&_0x5b212b[_0x425027(0x200)]?_0x5b212b:{'default':_0x5b212b};};Object['defineProperty'](exports,a31_0x2af4db(0x200),{'value':!![]});var path=__importStar(require(a31_0x2af4db(0x214))),_=__importStar(require('lodash')),docker=__importStar(require('../../docker/docker')),logger_1=__importDefault(require(a31_0x2af4db(0x215))),dockerOpts=__importStar(require(a31_0x2af4db(0x22b))),fs=__importStar(require(a31_0x2af4db(0x1ff))),uuid_1=require('uuid'),rimraf=__importStar(require(a31_0x2af4db(0x1df))),extract_zip_1=__importDefault(require(a31_0x2af4db(0x1e9))),tmpDir=__importStar(require(a31_0x2af4db(0x20b))),devs_1=require(a31_0x2af4db(0x1f9)),runtime_1=require(a31_0x2af4db(0x21d)),core=__importStar(require(a31_0x2af4db(0x21f)));function isZipArchive(_0x3df954){var _0x20feb8=a31_0x2af4db;return _0x3df954?_0x3df954[_0x20feb8(0x222)](_0x20feb8(0x23d))||_0x3df954[_0x20feb8(0x222)]('.jar')||_0x3df954[_0x20feb8(0x222)]('.war'):![];}function processZipCodeIfNecessary(_0x5b421c){return __awaiter(this,void 0x0,void 0x0,function(){var _0x308a77;return __generator(this,function(_0x2899f5){var _0x1c0850=a31_0x3a16;switch(_0x2899f5[_0x1c0850(0x213)]){case 0x0:if(!isZipArchive(_0x5b421c))return[0x2,null];_0x308a77=path['join'](tmpDir,uuid_1['v4']());return[0x4,fs[_0x1c0850(0x235)](_0x308a77)];case 0x1:_0x2899f5[_0x1c0850(0x224)](),logger_1[_0x1c0850(0x1e0)][_0x1c0850(0x20e)](_0x1c0850(0x1fc)+_0x308a77);return[0x4,extract_zip_1[_0x1c0850(0x1e0)](_0x5b421c,{'dir':_0x308a77})];case 0x2:_0x2899f5['sent']();return[0x2,_0x308a77];}});});}var Invoke=function(){var _0x19209d=a31_0x2af4db;function _0x2b7abb(_0x352331,_0x3dfedc,_0x501157,_0x54c968,_0x1be402,_0x3bc32a,_0x7fb84f,_0xd816ae,_0x33c984,_0xb8ffaf,_0x7a2064,_0x6131d7,_0x5887cd){var _0x97a580=a31_0x3a16;this[_0x97a580(0x220)]=_0x352331,this[_0x97a580(0x239)]=_0x3dfedc,this['region']=_0x501157,this[_0x97a580(0x1e1)]=_0x1be402[_0x97a580(0x1f2)],this[_0x97a580(0x211)]=_0x1be402,this[_0x97a580(0x228)]=_0x3bc32a['name'],this[_0x97a580(0x207)]=_0x3bc32a,this[_0x97a580(0x210)]=_0x7fb84f,this[_0x97a580(0x1ee)]=_0xd816ae,this['debugIde']=_0x33c984,this[_0x97a580(0x1f8)]=_0x5887cd,this[_0x97a580(0x20a)]=this[_0x97a580(0x207)][_0x97a580(0x20a)],this[_0x97a580(0x1fb)]=_0x54c968,this[_0x97a580(0x1dd)]=this[_0x97a580(0x207)][_0x97a580(0x1dd)]?path[_0x97a580(0x1e3)](this['baseDir'],this[_0x97a580(0x207)][_0x97a580(0x1dd)]):null,this[_0x97a580(0x230)]=_0xb8ffaf,this[_0x97a580(0x21c)]=_0x7a2064,this[_0x97a580(0x229)]=_0x6131d7;}return _0x2b7abb['prototype'][_0x19209d(0x1ef)]=function(){var _0x4c7a1f;return __awaiter(this,void 0x0,void 0x0,function(){var _0x19dd83,_0x2c870f,_0x3953f5,_0x1b7f22,_0x37a677,_0x146637,_0x4cabaa,_0x287ca9,_0x36633e,_0x53fd46,_0x504f89;return __generator(this,function(_0x3fc90a){var _0x4c6e85=a31_0x3a16;switch(_0x3fc90a[_0x4c6e85(0x213)]){case 0x0:this[_0x4c6e85(0x21b)]=(_0x4c7a1f=this[_0x4c6e85(0x211)])===null||_0x4c7a1f===void 0x0?void 0x0:_0x4c7a1f[_0x4c6e85(0x21b)],_0x19dd83=this;return[0x4,dockerOpts[_0x4c6e85(0x1e8)]({'nasConfig':this[_0x4c6e85(0x21b)]})];case 0x1:_0x19dd83[_0x4c6e85(0x1fa)]=_0x3fc90a[_0x4c6e85(0x224)](),_0x2c870f=this;return[0x4,docker['resolveNasConfigToMounts'](this[_0x4c6e85(0x1fb)],this[_0x4c6e85(0x1e1)],this[_0x4c6e85(0x21b)],this[_0x4c6e85(0x1f8)]||path[_0x4c6e85(0x240)](this[_0x4c6e85(0x1fb)],devs_1['DEFAULT_NAS_PATH_SUFFIX']))];case 0x2:_0x2c870f['nasMounts']=_0x3fc90a[_0x4c6e85(0x224)](),_0x3953f5=this;return[0x4,processZipCodeIfNecessary(this[_0x4c6e85(0x1dd)])];case 0x3:_0x3953f5['unzippedCodeDir']=_0x3fc90a[_0x4c6e85(0x224)](),_0x1b7f22=this;return[0x4,docker[_0x4c6e85(0x202)](this[_0x4c6e85(0x1de)]||this[_0x4c6e85(0x1dd)])];case 0x4:_0x1b7f22['codeMount']=_0x3fc90a[_0x4c6e85(0x224)](),_0x37a677=this;return[0x4,docker['resolveTmpDirToMount'](this[_0x4c6e85(0x230)])];case 0x5:_0x37a677[_0x4c6e85(0x1ea)]=_0x3fc90a[_0x4c6e85(0x224)](),_0x146637=this;return[0x4,docker[_0x4c6e85(0x227)](this[_0x4c6e85(0x21c)])];case 0x6:_0x146637[_0x4c6e85(0x23a)]=_0x3fc90a['sent'](),_0x4cabaa=this;return[0x4,docker[_0x4c6e85(0x1d8)]()];case 0x7:_0x4cabaa['passwdMount']=_0x3fc90a['sent'](),_0x287ca9=_[_0x4c6e85(0x1eb)](__spreadArrays([this[_0x4c6e85(0x217)]],this['nasMounts'],[this[_0x4c6e85(0x236)]]));!_['isEmpty'](this[_0x4c6e85(0x1ea)])&&_0x287ca9['push'](this[_0x4c6e85(0x1ea)]);!_['isEmpty'](this[_0x4c6e85(0x23a)])&&_0x287ca9['push'](this[_0x4c6e85(0x23a)]);return[0x4,docker[_0x4c6e85(0x1f6)]()];case 0x8:_0x36633e=_0x3fc90a[_0x4c6e85(0x224)]();_0x36633e?this[_0x4c6e85(0x221)]=dockerOpts[_0x4c6e85(0x201)](_0x287ca9):this[_0x4c6e85(0x221)]=_0x287ca9;logger_1[_0x4c6e85(0x1e0)][_0x4c6e85(0x1fe)](_0x4c6e85(0x23f)+JSON[_0x4c6e85(0x219)](this['mounts'],null,0x4)),this['containerName']=docker['generateRamdomContainerName'](),_0x53fd46=runtime_1[_0x4c6e85(0x1e6)](this[_0x4c6e85(0x20a)]);if(!_0x53fd46)return[0x3,0x9];this[_0x4c6e85(0x23e)]=this['functionConfig'][_0x4c6e85(0x1d7)][_0x4c6e85(0x23b)];return[0x3,0xb];case 0x9:_0x504f89=this;return[0x4,dockerOpts[_0x4c6e85(0x20d)](this[_0x4c6e85(0x20a)])];case 0xa:_0x504f89['imageName']=_0x3fc90a[_0x4c6e85(0x224)](),_0x3fc90a[_0x4c6e85(0x213)]=0xb;case 0xb:return[0x4,docker['pullFcImageIfNeed'](this['imageName'])];case 0xc:_0x3fc90a[_0x4c6e85(0x224)](),this['inited']=!![];return[0x2];}});});},_0x2b7abb[_0x19209d(0x21a)][_0x19209d(0x218)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0xb3a852){return[0x2];});});},_0x2b7abb[_0x19209d(0x21a)][_0x19209d(0x20f)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x2997c3){var _0x396741=a31_0x3a16;switch(_0x2997c3['label']){case 0x0:if(!(this['debugPort']&&this['debugIde']))return[0x3,0x4];if(!(this['debugIde']['toLowerCase']()==='vscode'))return[0x3,0x2];return[0x4,docker[_0x396741(0x233)](this[_0x396741(0x1e1)],this[_0x396741(0x228)],this['runtime'],this[_0x396741(0x217)][_0x396741(0x205)],this['debugPort'])];case 0x1:_0x2997c3[_0x396741(0x224)]();return[0x3,0x4];case 0x2:if(!(this[_0x396741(0x1da)][_0x396741(0x234)]()===_0x396741(0x21e)))return[0x3,0x4];return[0x4,docker['showDebugIdeTipsForPycharm'](this[_0x396741(0x217)]['Source'],this[_0x396741(0x1ee)])];case 0x3:_0x2997c3[_0x396741(0x224)](),_0x2997c3['label']=0x4;case 0x4:return[0x2];}});});},_0x2b7abb[_0x19209d(0x21a)][_0x19209d(0x1ed)]=function(){var _0x2a3f33=_0x19209d;this[_0x2a3f33(0x1de)]&&(rimraf[_0x2a3f33(0x242)](this[_0x2a3f33(0x1de)]),console['log']('clean\x20tmp\x20code\x20dir\x20'+this[_0x2a3f33(0x1de)]+_0x2a3f33(0x1f3)),this[_0x2a3f33(0x1de)]=null);},_0x2b7abb[_0x19209d(0x21a)][_0x19209d(0x223)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x29d0f7){var _0x1e5a04=a31_0x3a16;return this[_0x1e5a04(0x1ed)](),[0x2];});});},_0x2b7abb['prototype'][_0x19209d(0x1e5)]=function(){var _0x306b66=_0x19209d,_0x2f8f9b,_0x454039;return this[_0x306b66(0x239)][_0x306b66(0x1ec)]+'-'+this['region']+'-'+((_0x2f8f9b=this[_0x306b66(0x211)])===null||_0x2f8f9b===void 0x0?void 0x0:_0x2f8f9b[_0x306b66(0x1f2)])+'-'+((_0x454039=this[_0x306b66(0x207)])===null||_0x454039===void 0x0?void 0x0:_0x454039[_0x306b66(0x1f2)]);},_0x2b7abb[_0x19209d(0x21a)][_0x19209d(0x238)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x37cb00;return __generator(this,function(_0x920278){var _0x25f0b9=a31_0x3a16;switch(_0x920278[_0x25f0b9(0x213)]){case 0x0:_0x37cb00=this[_0x25f0b9(0x1e5)]();return[0x4,core[_0x25f0b9(0x238)](_0x37cb00)];case 0x1:return[0x2,_0x920278[_0x25f0b9(0x224)]()];}});});},_0x2b7abb;}();exports[a31_0x2af4db(0x1e0)]=Invoke;