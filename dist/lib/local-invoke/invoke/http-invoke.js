'use strict';var a31_0x4ce0=['_startRunner','length','succeed','__setModuleDefault','invokeContainerId','curl','__generator','containerName','Restart\x20function\x20container\x20succeed!\x20Please\x20try\x20\x27invoke\x27\x20again.','--debug','checking\x20server\x20in\x20function\x20container','generateLocalStartOpts','Killing\x20old\x20container...','Stop\x20function\x20container\x20error:\x20','caPort','440298TTzswv','containerId','kill','log','Reloading\x20success,\x20stopping\x20old\x20function\x20container...','clean','\x0aFunction\x20container\x20starts\x20failed.Start\x20cleaning\x20now.','\x20successfully.\x0a','Stop\x20function\x20container\x20failed.','Stop\x20old\x20function\x20container\x20successfully','Function\x20container\x20is\x20closed,\x20exit!','rimraf','cleanUnzippedCodeDir',',\x20auto\x20reloading...','label','stop','setSigint','promiseRetry','includes','stdout','sessionId','mounts','baseDir','stdoutFormatter','function\x20container','../../utils/runtime','ops','Restart\x20function\x20container\x20failed!','../../utils/process','saveInvokeContainerId','Kill\x20function\x20container\x20successfully','node-watch','functionName','value','fail','creds','../../utils/devs','region','debugArgs','setDebugIdeConfig','../../utils/state','constructor','isIgnored','warning','setPrototypeOf','initWatch','406480LNCjyd','unzippedCodeDir','../../retry','generateDockerEnvs','Function\x20container\x20starts\x20failed\x20because\x20proxy\x20container\x20is\x20not\x20running','detect\x20code\x20changes,\x20but\x20no\x20runner\x20found,\x20starting....','115978PvYFRM','apply','push','../../docker/docker-opts','808541plNeLd','default','hasOwnProperty','../../definition','functionConfig','__importDefault','return','getContainer','stderr','1605pYdtlv','watcher','Stop\x20function\x20container\x20successfully','127.0.0.1:','Stop\x20function\x20container\x20failed,\x20error:\x20','../../../common/logger','AccountID','throw','restart','dev-null','sync','close','tunnelService','retry','call','generateRamdomContainerName','__esModule','229nJBunQ','sent','1EafmHh','error','debug','done','prototype','then','init','2073583UnEWzU','defineProperty','getInvokeContainerIdFromState','create','is\x20up.','runtime','startContainer','next','spinner','info','function','pop','__proto__','Generator\x20is\x20already\x20executing.','initAndStartRunner','Restart\x20function\x20container\x20failed,\x20error\x20is:\x20\x0a','imageName','Checking\x20server\x20in\x20function\x20container\x20failed,\x20error:\x20','serviceName','1271806tmUwLq','unsetInvokeContainerId','sleep','__extends','checkIfProxyContainerRunning','check','../ignore','server\x20in\x20function\x20container','runner','Server\x20is\x20not\x20up.\x20Result\x20is\x20:','nasConfig','trys','Kill\x20old\x20container\x20failed,\x20please\x20kill\x20it\x20manually.','11OBYIqJ','genStateId'];var a31_0x41f204=a31_0x21dd;(function(_0xa79c40,_0x32d286){var _0x5f776b=a31_0x21dd;while(!![]){try{var _0x1b8a72=-parseInt(_0x5f776b(0xd9))*-parseInt(_0x5f776b(0xc8))+-parseInt(_0x5f776b(0x113))+parseInt(_0x5f776b(0xbf))+parseInt(_0x5f776b(0xdb))*-parseInt(_0x5f776b(0xf5))+parseInt(_0x5f776b(0x141))+parseInt(_0x5f776b(0x102))*-parseInt(_0x5f776b(0x147))+parseInt(_0x5f776b(0xe2));if(_0x1b8a72===_0x32d286)break;else _0xa79c40['push'](_0xa79c40['shift']());}catch(_0x4c0e91){_0xa79c40['push'](_0xa79c40['shift']());}}}(a31_0x4ce0,0xa327f));var __extends=this&&this[a31_0x41f204(0xf8)]||function(){var _0x43c7a6=function(_0x5c0a75,_0x48cfb6){var _0x545dde=a31_0x21dd;return _0x43c7a6=Object[_0x545dde(0x13f)]||{'__proto__':[]}instanceof Array&&function(_0x460037,_0x552fa2){var _0x303e2d=_0x545dde;_0x460037[_0x303e2d(0xee)]=_0x552fa2;}||function(_0x5cac72,_0x2037bc){var _0x4c09e1=_0x545dde;for(var _0x534ac2 in _0x2037bc)if(_0x2037bc[_0x4c09e1(0xc1)](_0x534ac2))_0x5cac72[_0x534ac2]=_0x2037bc[_0x534ac2];},_0x43c7a6(_0x5c0a75,_0x48cfb6);};return function(_0x45bd67,_0x78eac){var _0x464e8c=a31_0x21dd;_0x43c7a6(_0x45bd67,_0x78eac);function _0x40b822(){var _0x21bdb2=a31_0x21dd;this[_0x21bdb2(0x13c)]=_0x45bd67;}_0x45bd67[_0x464e8c(0xdf)]=_0x78eac===null?Object[_0x464e8c(0xe5)](_0x78eac):(_0x40b822[_0x464e8c(0xdf)]=_0x78eac[_0x464e8c(0xdf)],new _0x40b822());};}(),__createBinding=this&&this['__createBinding']||(Object[a31_0x41f204(0xe5)]?function(_0x3da466,_0x3754ea,_0x21c7fc,_0x505776){var _0x4ed3f4=a31_0x41f204;if(_0x505776===undefined)_0x505776=_0x21c7fc;Object[_0x4ed3f4(0xe3)](_0x3da466,_0x505776,{'enumerable':!![],'get':function(){return _0x3754ea[_0x21c7fc];}});}:function(_0x1cfc36,_0x4045ae,_0x3b27c7,_0x55819d){if(_0x55819d===undefined)_0x55819d=_0x3b27c7;_0x1cfc36[_0x55819d]=_0x4045ae[_0x3b27c7];}),__setModuleDefault=this&&this[a31_0x41f204(0x107)]||(Object[a31_0x41f204(0xe5)]?function(_0x1e2879,_0x2a451e){var _0x18fa85=a31_0x41f204;Object[_0x18fa85(0xe3)](_0x1e2879,_0x18fa85(0xc0),{'enumerable':!![],'value':_0x2a451e});}:function(_0x2f8b79,_0x3ec528){var _0x109aed=a31_0x41f204;_0x2f8b79[_0x109aed(0xc0)]=_0x3ec528;}),__importStar=this&&this['__importStar']||function(_0x33e3eb){var _0x5c6f11=a31_0x41f204;if(_0x33e3eb&&_0x33e3eb[_0x5c6f11(0xd8)])return _0x33e3eb;var _0x5481cf={};if(_0x33e3eb!=null){for(var _0x366fbe in _0x33e3eb)if(_0x366fbe!=='default'&&Object[_0x5c6f11(0xc1)][_0x5c6f11(0xd6)](_0x33e3eb,_0x366fbe))__createBinding(_0x5481cf,_0x33e3eb,_0x366fbe);}return __setModuleDefault(_0x5481cf,_0x33e3eb),_0x5481cf;},__awaiter=this&&this['__awaiter']||function(_0x132937,_0x3b9a61,_0x5961fb,_0x2494ab){function _0x1e79b0(_0x33b7f8){return _0x33b7f8 instanceof _0x5961fb?_0x33b7f8:new _0x5961fb(function(_0x3a18eb){_0x3a18eb(_0x33b7f8);});}return new(_0x5961fb||(_0x5961fb=Promise))(function(_0x2108c5,_0x41eebe){var _0x9d4c52=a31_0x21dd;function _0x5c3e26(_0x492693){var _0x101082=a31_0x21dd;try{_0x2aac6f(_0x2494ab[_0x101082(0xe9)](_0x492693));}catch(_0x3787d7){_0x41eebe(_0x3787d7);}}function _0x116e87(_0x515132){var _0x3e402e=a31_0x21dd;try{_0x2aac6f(_0x2494ab[_0x3e402e(0xcf)](_0x515132));}catch(_0x5c2b16){_0x41eebe(_0x5c2b16);}}function _0x2aac6f(_0x544ad3){var _0x1c58ac=a31_0x21dd;_0x544ad3[_0x1c58ac(0xde)]?_0x2108c5(_0x544ad3[_0x1c58ac(0x134)]):_0x1e79b0(_0x544ad3[_0x1c58ac(0x134)])[_0x1c58ac(0xe0)](_0x5c3e26,_0x116e87);}_0x2aac6f((_0x2494ab=_0x2494ab[_0x9d4c52(0xbc)](_0x132937,_0x3b9a61||[]))['next']());});},__generator=this&&this[a31_0x41f204(0x10a)]||function(_0x24ac82,_0x438a59){var _0x1ec852=a31_0x41f204,_0xcb5e74={'label':0x0,'sent':function(){if(_0x4f647d[0x0]&0x1)throw _0x4f647d[0x1];return _0x4f647d[0x1];},'trys':[],'ops':[]},_0x3ddaf0,_0x1c1f3d,_0x4f647d,_0x382e45;return _0x382e45={'next':_0x383cfc(0x0),'throw':_0x383cfc(0x1),'return':_0x383cfc(0x2)},typeof Symbol===_0x1ec852(0xec)&&(_0x382e45[Symbol['iterator']]=function(){return this;}),_0x382e45;function _0x383cfc(_0x5888ec){return function(_0x4f7853){return _0x4961fa([_0x5888ec,_0x4f7853]);};}function _0x4961fa(_0xf8a3f8){var _0x5bdb8a=_0x1ec852;if(_0x3ddaf0)throw new TypeError(_0x5bdb8a(0xef));while(_0xcb5e74)try{if(_0x3ddaf0=0x1,_0x1c1f3d&&(_0x4f647d=_0xf8a3f8[0x0]&0x2?_0x1c1f3d[_0x5bdb8a(0xc5)]:_0xf8a3f8[0x0]?_0x1c1f3d[_0x5bdb8a(0xcf)]||((_0x4f647d=_0x1c1f3d[_0x5bdb8a(0xc5)])&&_0x4f647d['call'](_0x1c1f3d),0x0):_0x1c1f3d[_0x5bdb8a(0xe9)])&&!(_0x4f647d=_0x4f647d[_0x5bdb8a(0xd6)](_0x1c1f3d,_0xf8a3f8[0x1]))['done'])return _0x4f647d;if(_0x1c1f3d=0x0,_0x4f647d)_0xf8a3f8=[_0xf8a3f8[0x0]&0x2,_0x4f647d['value']];switch(_0xf8a3f8[0x0]){case 0x0:case 0x1:_0x4f647d=_0xf8a3f8;break;case 0x4:_0xcb5e74[_0x5bdb8a(0x121)]++;return{'value':_0xf8a3f8[0x1],'done':![]};case 0x5:_0xcb5e74[_0x5bdb8a(0x121)]++,_0x1c1f3d=_0xf8a3f8[0x1],_0xf8a3f8=[0x0];continue;case 0x7:_0xf8a3f8=_0xcb5e74['ops'][_0x5bdb8a(0xed)](),_0xcb5e74[_0x5bdb8a(0x100)]['pop']();continue;default:if(!(_0x4f647d=_0xcb5e74[_0x5bdb8a(0x100)],_0x4f647d=_0x4f647d[_0x5bdb8a(0x105)]>0x0&&_0x4f647d[_0x4f647d[_0x5bdb8a(0x105)]-0x1])&&(_0xf8a3f8[0x0]===0x6||_0xf8a3f8[0x0]===0x2)){_0xcb5e74=0x0;continue;}if(_0xf8a3f8[0x0]===0x3&&(!_0x4f647d||_0xf8a3f8[0x1]>_0x4f647d[0x0]&&_0xf8a3f8[0x1]<_0x4f647d[0x3])){_0xcb5e74[_0x5bdb8a(0x121)]=_0xf8a3f8[0x1];break;}if(_0xf8a3f8[0x0]===0x6&&_0xcb5e74[_0x5bdb8a(0x121)]<_0x4f647d[0x1]){_0xcb5e74[_0x5bdb8a(0x121)]=_0x4f647d[0x1],_0x4f647d=_0xf8a3f8;break;}if(_0x4f647d&&_0xcb5e74[_0x5bdb8a(0x121)]<_0x4f647d[0x2]){_0xcb5e74['label']=_0x4f647d[0x2],_0xcb5e74[_0x5bdb8a(0x12d)][_0x5bdb8a(0xbd)](_0xf8a3f8);break;}if(_0x4f647d[0x2])_0xcb5e74[_0x5bdb8a(0x12d)]['pop']();_0xcb5e74[_0x5bdb8a(0x100)][_0x5bdb8a(0xed)]();continue;}_0xf8a3f8=_0x438a59[_0x5bdb8a(0xd6)](_0x24ac82,_0xcb5e74);}catch(_0x522df2){_0xf8a3f8=[0x6,_0x522df2],_0x1c1f3d=0x0;}finally{_0x3ddaf0=_0x4f647d=0x0;}if(_0xf8a3f8[0x0]&0x5)throw _0xf8a3f8[0x1];return{'value':_0xf8a3f8[0x0]?_0xf8a3f8[0x1]:void 0x0,'done':!![]};}},__importDefault=this&&this[a31_0x41f204(0xc4)]||function(_0xd482ca){var _0x1a887e=a31_0x41f204;return _0xd482ca&&_0xd482ca[_0x1a887e(0xd8)]?_0xd482ca:{'default':_0xd482ca};};Object[a31_0x41f204(0xe3)](exports,a31_0x41f204(0xd8),{'value':!![]});function a31_0x21dd(_0x2ab13f,_0x84be5f){return a31_0x21dd=function(_0x4ce099,_0x21ddf8){_0x4ce099=_0x4ce099-0xbc;var _0x1d8cfe=a31_0x4ce0[_0x4ce099];return _0x1d8cfe;},a31_0x21dd(_0x2ab13f,_0x84be5f);}var node_watch_1=__importDefault(require(a31_0x41f204(0x132))),rimraf=__importStar(require(a31_0x41f204(0x11e))),ignore_1=require(a31_0x41f204(0xfb)),invoke_1=__importDefault(require('./invoke')),docker=__importStar(require('../../docker/docker')),dockerOpts=__importStar(require(a31_0x41f204(0xbe))),dockerode_1=__importDefault(require('dockerode')),runtime_1=require(a31_0x41f204(0x12c)),logger_1=__importDefault(require(a31_0x41f204(0xcd))),definition_1=require(a31_0x41f204(0xc2)),time_1=require('../../utils/time'),process_1=require(a31_0x41f204(0x12f)),devs_1=require(a31_0x41f204(0x137)),retry_1=require(a31_0x41f204(0x143)),core=__importStar(require('@serverless-devs/core')),stdout_formatter_1=__importDefault(require('../../component/stdout-formatter')),state_1=require(a31_0x41f204(0x13b)),dev_null_1=__importDefault(require(a31_0x41f204(0xd1))),dockerClient=new dockerode_1['default'](),HttpInvoke=function(_0x4cd1fe){var _0x5c6cb8=a31_0x41f204;__extends(_0x3c1df5,_0x4cd1fe);function _0x3c1df5(_0x36ddda,_0x21ec6a,_0x43c3fb,_0x425a1a,_0x59972e,_0x2d3fd8,_0x280bde,_0x2bc960,_0x358448,_0x4080de,_0x2267b2,_0x20dd30,_0xa9ec1d,_0x15ae21){var _0x495848=a31_0x21dd,_0x5aa20d=_0x4cd1fe[_0x495848(0xd6)](this,_0x36ddda,_0x21ec6a,_0x43c3fb,_0x425a1a,_0x59972e,_0x2d3fd8,_0x280bde,_0x2bc960,_0x358448,_0x4080de,_0x2267b2,_0x20dd30,_0xa9ec1d,_0x15ae21)||this;return process_1[_0x495848(0x123)](),process['on']('SIGINT',function(){return __awaiter(_0x5aa20d,void 0x0,void 0x0,function(){var _0x31ca44,_0x3208d1,_0x390550,_0x284684,_0x18429f;return __generator(this,function(_0x4eb301){var _0x39aafc=a31_0x21dd;switch(_0x4eb301[_0x39aafc(0x121)]){case 0x0:this[_0x39aafc(0xc9)]&&this[_0x39aafc(0xc9)][_0x39aafc(0xd3)]();this[_0x39aafc(0x11f)]();if(!this[_0x39aafc(0xfd)])return[0x3,0xa];_0x31ca44=core[_0x39aafc(0xea)]('Received\x20canncel\x20request,\x20stopping\x20running\x20function\x20container...'),_0x4eb301['label']=0x1;case 0x1:_0x4eb301['trys']['push']([0x1,0x3,,0x8]);return[0x4,this[_0x39aafc(0xfd)][_0x39aafc(0x122)]()];case 0x2:_0x4eb301[_0x39aafc(0xda)](),_0x31ca44[_0x39aafc(0x106)](_0x39aafc(0xca));return[0x3,0x8];case 0x3:_0x3208d1=_0x4eb301[_0x39aafc(0xda)](),_0x31ca44[_0x39aafc(0x135)](_0x39aafc(0x11b)),logger_1['default'][_0x39aafc(0xdd)](_0x39aafc(0xcc)+_0x3208d1),_0x390550=core[_0x39aafc(0xea)](_0x39aafc(0x110)),_0x4eb301[_0x39aafc(0x121)]=0x4;case 0x4:_0x4eb301[_0x39aafc(0x100)][_0x39aafc(0xbd)]([0x4,0x6,,0x7]);return[0x4,this[_0x39aafc(0xfd)][_0x39aafc(0x115)]()];case 0x5:_0x4eb301['sent'](),_0x390550[_0x39aafc(0x106)](_0x39aafc(0x131));return[0x3,0x7];case 0x6:_0x284684=_0x4eb301[_0x39aafc(0xda)](),_0x390550[_0x39aafc(0x135)]('Kill\x20old\x20container\x20failed,\x20please\x20kill\x20it\x20manually.'),logger_1[_0x39aafc(0xc0)][_0x39aafc(0xdd)]('Kill\x20function\x20container\x20failed,\x20error:\x20'+_0x284684);return[0x3,0x7];case 0x7:return[0x3,0x8];case 0x8:return[0x4,state_1[_0x39aafc(0xf6)]((_0x18429f=this['creds'])===null||_0x18429f===void 0x0?void 0x0:_0x18429f[_0x39aafc(0xce)],this[_0x39aafc(0x138)],this[_0x39aafc(0xf4)],this[_0x39aafc(0x133)])];case 0x9:_0x4eb301[_0x39aafc(0xda)](),this[_0x39aafc(0xfd)]=null,_0x4eb301[_0x39aafc(0x121)]=0xa;case 0xa:if(!this[_0x39aafc(0xd4)])return[0x3,0xc];return[0x4,this[_0x39aafc(0xd4)]['clean']()];case 0xb:_0x4eb301[_0x39aafc(0xda)](),_0x4eb301[_0x39aafc(0x121)]=0xc;case 0xc:return[0x2];}});});}),_0x5aa20d;}return _0x3c1df5[_0x5c6cb8(0xdf)]['_disableRunner']=function(_0x16649c,_0x248226){var _0x5c90ff;return __awaiter(this,void 0x0,void 0x0,function(){var _0x3be06d,_0x425a0d,_0x2e327b,_0x2c5918,_0x2f7dd0,_0x3b6c35;return __generator(this,function(_0x184858){var _0x11984c=a31_0x21dd;switch(_0x184858[_0x11984c(0x121)]){case 0x0:if(!this['runner'])return[0x2];logger_1['default']['info']('Detect\x20code\x20changes,\x20file\x20is\x20'+_0x248226+',\x20event\x20is\x20'+_0x16649c+_0x11984c(0x120)),_0x3be06d=this[_0x11984c(0xfd)],_0x425a0d=this[_0x11984c(0x142)],this[_0x11984c(0xfd)]=null;return[0x4,this['init']()];case 0x1:_0x184858[_0x11984c(0xda)]();return[0x4,time_1[_0x11984c(0xf7)](0x1f4)];case 0x2:_0x184858['sent'](),_0x2e327b=core[_0x11984c(0xea)](_0x11984c(0x117)),_0x184858[_0x11984c(0x121)]=0x3;case 0x3:_0x184858['trys']['push']([0x3,0x5,,0xa]);return[0x4,_0x3be06d[_0x11984c(0x122)]()];case 0x4:_0x184858[_0x11984c(0xda)](),_0x2e327b[_0x11984c(0x106)](_0x11984c(0x11c));return[0x3,0xa];case 0x5:_0x2c5918=_0x184858[_0x11984c(0xda)](),_0x2e327b[_0x11984c(0x135)](_0x11984c(0x11b)),logger_1['default'][_0x11984c(0xdd)](_0x11984c(0xcc)+_0x2c5918),_0x2f7dd0=core[_0x11984c(0xea)](_0x11984c(0x110)),_0x184858['label']=0x6;case 0x6:_0x184858[_0x11984c(0x100)][_0x11984c(0xbd)]([0x6,0x8,,0x9]);return[0x4,_0x3be06d[_0x11984c(0x115)]()];case 0x7:_0x184858[_0x11984c(0xda)](),_0x2f7dd0['succeed']('Kill\x20old\x20container\x20successfully');return[0x3,0x9];case 0x8:_0x3b6c35=_0x184858['sent'](),_0x2f7dd0[_0x11984c(0x135)](_0x11984c(0x101)),logger_1[_0x11984c(0xc0)][_0x11984c(0xdd)]('Kill\x20function\x20container\x20failed,\x20error:\x20'+_0x3b6c35);return[0x3,0x9];case 0x9:return[0x3,0xa];case 0xa:return[0x4,state_1[_0x11984c(0xf6)]((_0x5c90ff=this[_0x11984c(0x136)])===null||_0x5c90ff===void 0x0?void 0x0:_0x5c90ff['AccountID'],this[_0x11984c(0x138)],this[_0x11984c(0xf4)],this['functionName'])];case 0xb:_0x184858['sent']();_0x425a0d&&(rimraf[_0x11984c(0xd2)](_0x425a0d),logger_1[_0x11984c(0xc0)][_0x11984c(0xeb)]('Clean\x20tmp\x20code\x20dir\x20'+_0x425a0d+_0x11984c(0x11a)));return[0x2];}});});},_0x3c1df5['prototype']['_startRunner']=function(){var _0x560c6c,_0x5d5937,_0x549d0d;return __awaiter(this,void 0x0,void 0x0,function(){var _0x365bc7,_0x513ee2,_0x5a645d,_0xe4f0c4,_0x5b4ac6,_0x249285,_0x465116,_0x155431=this;return __generator(this,function(_0x293230){var _0x55924d=a31_0x21dd;switch(_0x293230[_0x55924d(0x121)]){case 0x0:_0x365bc7=this['tunnelService'];if(!_0x365bc7)return[0x3,0x2];return[0x4,this[_0x55924d(0xd4)][_0x55924d(0xf9)]()];case 0x1:_0x365bc7=!_0x293230[_0x55924d(0xda)](),_0x293230[_0x55924d(0x121)]=0x2;case 0x2:if(!_0x365bc7)return[0x3,0x5];console[_0x55924d(0x116)](),logger_1[_0x55924d(0xc0)][_0x55924d(0xdc)](_0x55924d(0x119));if(!this[_0x55924d(0xd4)])return[0x3,0x4];return[0x4,this[_0x55924d(0xd4)]['clean']()];case 0x3:_0x293230['sent'](),_0x293230[_0x55924d(0x121)]=0x4;case 0x4:throw new Error('Function\x20container\x20starts\x20failed\x20because\x20proxy\x20container\x20is\x20not\x20running,\x20please\x20retry\x20\x27setup\x27\x20method.');case 0x5:return[0x4,docker[_0x55924d(0x144)](this[_0x55924d(0x136)],this['region'],this[_0x55924d(0x129)],this[_0x55924d(0xf4)],this['serviceConfig'],this[_0x55924d(0x133)],this[_0x55924d(0xc3)],this['debugPort'],null,this[_0x55924d(0xff)],this['debugIde'],this[_0x55924d(0x139)])];case 0x6:_0x513ee2=_0x293230[_0x55924d(0xda)](),_0x5a645d=docker['generateDockerCmd'](this[_0x55924d(0xe7)],!![],this[_0x55924d(0xc3)]),_0xe4f0c4=definition_1['genProxyContainerName'](this[_0x55924d(0x127)]),this[_0x55924d(0x10b)]=docker[_0x55924d(0xd7)]();return[0x4,dockerOpts[_0x55924d(0x10f)](_0xe4f0c4,this['runtime'],this['containerName'],this[_0x55924d(0x128)],_0x5a645d,_0x513ee2,{'debugPort':this['debugPort'],'dockerUser':this['dockerUser'],'imageName':this[_0x55924d(0xf2)]})];case 0x7:_0x5b4ac6=_0x293230[_0x55924d(0xda)](),_0x249285=this;return[0x4,docker[_0x55924d(0xe8)](_0x5b4ac6,process[_0x55924d(0x126)],process[_0x55924d(0xc7)],{'serviceName':this[_0x55924d(0xf4)],'functionName':this[_0x55924d(0x133)]})];case 0x8:_0x249285['runner']=_0x293230[_0x55924d(0xda)]();return[0x4,this['saveInvokeContainerId']()];case 0x9:_0x293230[_0x55924d(0xda)](),_0x465116=(_0x5d5937=(_0x560c6c=process['env'])===null||_0x560c6c===void 0x0?void 0x0:_0x560c6c['temp_params'])===null||_0x5d5937===void 0x0?void 0x0:_0x5d5937[_0x55924d(0x125)](_0x55924d(0x10d));if(!!runtime_1['isCustomContainerRuntime']((_0x549d0d=this[_0x55924d(0xc3)])===null||_0x549d0d===void 0x0?void 0x0:_0x549d0d[_0x55924d(0xe7)]))return[0x3,0xb];logger_1[_0x55924d(0xc0)][_0x55924d(0xeb)](stdout_formatter_1['default'][_0x55924d(0x12a)][_0x55924d(0xfa)](_0x55924d(0xfc),_0x55924d(0xe6)));return[0x4,retry_1[_0x55924d(0x124)](function(_0x51cf72,_0x1daeaf){return __awaiter(_0x155431,void 0x0,void 0x0,function(){var _0x1164ba,_0x54a1db,_0x572356,_0x533930;return __generator(this,function(_0x3c799a){var _0x285d67=a31_0x21dd;switch(_0x3c799a[_0x285d67(0x121)]){case 0x0:_0x3c799a[_0x285d67(0x100)][_0x285d67(0xbd)]([0x0,0x3,,0x4]);if(!this[_0x285d67(0xfd)])throw new Error('Function\x20container\x20is\x20closed,\x20exit!');return[0x4,time_1[_0x285d67(0xf7)](0x3e8)];case 0x1:_0x3c799a['sent'](),_0x1164ba=((_0x533930=this[_0x285d67(0xc3)])===null||_0x533930===void 0x0?void 0x0:_0x533930[_0x285d67(0x112)])||0x2328;return[0x4,this[_0x285d67(0xfd)]['exec']([_0x285d67(0x109),_0x285d67(0xcb)+_0x1164ba],{'outputStream':_0x465116?process['stdout']:dev_null_1[_0x285d67(0xc0)](),'errorStream':_0x465116?process[_0x285d67(0xc7)]:dev_null_1[_0x285d67(0xc0)]()})];case 0x2:_0x54a1db=_0x3c799a[_0x285d67(0xda)]();if(_0x54a1db===0x0)return logger_1[_0x285d67(0xc0)][_0x285d67(0xeb)]('Server\x20in\x20function\x20container\x20is\x20up!'),[0x2];logger_1[_0x285d67(0xc0)][_0x285d67(0xdd)](_0x285d67(0xfe)+_0x54a1db),logger_1['default'][_0x285d67(0xeb)](stdout_formatter_1['default']['stdoutFormatter']['retry'](_0x285d67(0x10e),'is\x20up','',_0x1daeaf)),_0x51cf72(_0x54a1db);return[0x3,0x4];case 0x3:_0x572356=_0x3c799a[_0x285d67(0xda)]();if(_0x572356['message']===_0x285d67(0x11d))throw _0x572356;logger_1[_0x285d67(0xc0)][_0x285d67(0xdd)](_0x285d67(0xf3)+_0x572356),logger_1[_0x285d67(0xc0)][_0x285d67(0xeb)](stdout_formatter_1[_0x285d67(0xc0)][_0x285d67(0x12a)][_0x285d67(0xd5)](_0x285d67(0x10e),'is\x20up','',_0x1daeaf)),_0x51cf72(_0x572356);return[0x3,0x4];case 0x4:return[0x2];}});});},0x14)];case 0xa:_0x293230['sent'](),_0x293230[_0x55924d(0x121)]=0xb;case 0xb:return[0x2];}});});},_0x3c1df5[_0x5c6cb8(0xdf)][_0x5c6cb8(0x130)]=function(){var _0xc61846,_0x4155b8;return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x26bd0b){var _0x540acf=a31_0x21dd;switch(_0x26bd0b[_0x540acf(0x121)]){case 0x0:return[0x4,devs_1['setKVInState'](_0x540acf(0x108),(_0xc61846=this['runner'])===null||_0xc61846===void 0x0?void 0x0:_0xc61846[_0x540acf(0x114)],state_1[_0x540acf(0x103)]((_0x4155b8=this[_0x540acf(0x136)])===null||_0x4155b8===void 0x0?void 0x0:_0x4155b8[_0x540acf(0xce)],this[_0x540acf(0x138)],this[_0x540acf(0xf4)],this['functionName']))];case 0x1:_0x26bd0b[_0x540acf(0xda)]();return[0x2];}});});},_0x3c1df5[_0x5c6cb8(0xdf)][_0x5c6cb8(0x140)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0xbdda94,_0x4c2144,_0x79c93e,_0x1b338e=this;return __generator(this,function(_0x508f17){var _0x50003b=a31_0x21dd;switch(_0x508f17[_0x50003b(0x121)]){case 0x0:if(!(!this['watcher']&&!runtime_1['isCustomContainerRuntime'](this['runtime'])))return[0x3,0x2];return[0x4,ignore_1[_0x50003b(0x13d)](this['baseDir'])];case 0x1:_0xbdda94=_0x508f17['sent'](),_0x4c2144=![],_0x79c93e=![],this['watcher']=node_watch_1['default'](this['codeUri'],{'recursive':!![],'persistent':![],'filter':function(_0x980cfb){return _0xbdda94&&!_0xbdda94(_0x980cfb);}},function(_0x26a44d,_0x14298d){return __awaiter(_0x1b338e,void 0x0,void 0x0,function(){var _0x247d48,_0x3c7249,_0x404f38,_0x4f3c5b=this;return __generator(this,function(_0x8cb04e){var _0x468e93=a31_0x21dd;switch(_0x8cb04e[_0x468e93(0x121)]){case 0x0:if(_0x4c2144)return[0x2];_0x247d48=0x12c,_0x3c7249=0x0;if(!_0x79c93e)return[0x3,0x7];_0x8cb04e[_0x468e93(0x121)]=0x1;case 0x1:if(!_0x79c93e)return[0x3,0x7];if(_0x4c2144)return[0x2];return[0x4,time_1[_0x468e93(0xf7)](0xbb8)];case 0x2:_0x8cb04e[_0x468e93(0xda)](),_0x3c7249=_0x3c7249+0x3;if(!(_0x3c7249>_0x247d48))return[0x3,0x6];return[0x4,this[_0x468e93(0x118)]()];case 0x3:_0x8cb04e[_0x468e93(0xda)]();if(!this['tunnelService'])return[0x3,0x5];return[0x4,this[_0x468e93(0xd4)]['clean']()];case 0x4:_0x8cb04e[_0x468e93(0xda)](),_0x8cb04e[_0x468e93(0x121)]=0x5;case 0x5:throw new Error('Restart\x20function\x20container\x20timeout\x20after\x20300s!Please\x20check\x20if\x20docker\x20runs\x20normally,\x20then\x20runs\x20\x27clean\x27\x20method\x20and\x20try\x20\x27setup\x27\x20again.');case 0x6:return[0x3,0x1];case 0x7:_0x4c2144=!![],_0x8cb04e[_0x468e93(0x121)]=0x8;case 0x8:_0x8cb04e[_0x468e93(0x100)][_0x468e93(0xbd)]([0x8,0xc,,0xd]);if(!this[_0x468e93(0xfd)])return[0x3,0xa];return[0x4,this['_disableRunner'](_0x26a44d,_0x14298d)];case 0x9:_0x8cb04e[_0x468e93(0xda)]();return[0x3,0xb];case 0xa:logger_1[_0x468e93(0xc0)][_0x468e93(0xdd)](_0x468e93(0x146)),_0x8cb04e[_0x468e93(0x121)]=0xb;case 0xb:return[0x3,0xd];case 0xc:_0x404f38=_0x8cb04e[_0x468e93(0xda)](),logger_1['default'][_0x468e93(0x13e)]('Stop\x20function\x20container\x20failed,\x20please\x20stop\x20it\x20manually.'),logger_1['default'][_0x468e93(0xdd)](_0x468e93(0x111)+_0x404f38);return[0x3,0xd];case 0xd:_0x79c93e=!![],_0x4c2144=![],logger_1[_0x468e93(0xc0)][_0x468e93(0xeb)]('Detecting\x20code\x20changes\x20and\x20Restarting\x20funtion\x20container...');return[0x4,retry_1[_0x468e93(0x124)](function(_0x4bcdc2,_0x308878){return __awaiter(_0x4f3c5b,void 0x0,void 0x0,function(){var _0x20f6a5;return __generator(this,function(_0x91760d){var _0x3730e7=a31_0x21dd;switch(_0x91760d['label']){case 0x0:_0x91760d[_0x3730e7(0x100)][_0x3730e7(0xbd)]([0x0,0x2,,0x4]);return[0x4,this[_0x3730e7(0x104)]()];case 0x1:_0x91760d[_0x3730e7(0xda)](),logger_1[_0x3730e7(0xc0)][_0x3730e7(0xeb)](_0x3730e7(0x10c));return[0x2];case 0x2:_0x20f6a5=_0x91760d[_0x3730e7(0xda)](),logger_1[_0x3730e7(0xc0)][_0x3730e7(0xdc)](_0x3730e7(0x12e));if(_0x20f6a5===null||_0x20f6a5===void 0x0?void 0x0:_0x20f6a5['message'][_0x3730e7(0x125)](_0x3730e7(0x145)))throw _0x20f6a5;logger_1[_0x3730e7(0xc0)][_0x3730e7(0xdd)](_0x3730e7(0xf1)+_0x20f6a5),logger_1['default'][_0x3730e7(0xeb)](stdout_formatter_1[_0x3730e7(0xc0)]['stdoutFormatter'][_0x3730e7(0xd5)](_0x3730e7(0x12b),_0x3730e7(0xd0),'',_0x308878));return[0x4,time_1[_0x3730e7(0xf7)](0x64)];case 0x3:_0x91760d[_0x3730e7(0xda)](),_0x4bcdc2(_0x20f6a5);return[0x3,0x4];case 0x4:return[0x2];}});});})];case 0xe:_0x8cb04e[_0x468e93(0xda)](),_0x79c93e=![];return[0x2];}});});}),this[_0x50003b(0xc9)]['on'](_0x50003b(0xdc),function(_0x2dbb40){throw _0x2dbb40;}),_0x508f17[_0x50003b(0x121)]=0x2;case 0x2:return[0x2];}});});},_0x3c1df5['prototype'][_0x5c6cb8(0xf0)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x5d2dd5){var _0x16dfa1=a31_0x21dd;switch(_0x5d2dd5['label']){case 0x0:return[0x4,this[_0x16dfa1(0xe1)]()];case 0x1:_0x5d2dd5['sent']();return[0x4,this[_0x16dfa1(0x104)]()];case 0x2:_0x5d2dd5[_0x16dfa1(0xda)]();return[0x4,this[_0x16dfa1(0x140)]()];case 0x3:_0x5d2dd5[_0x16dfa1(0xda)]();return[0x4,this[_0x16dfa1(0x13a)]()];case 0x4:_0x5d2dd5[_0x16dfa1(0xda)]();return[0x2];}});});},_0x3c1df5[_0x5c6cb8(0xdf)][_0x5c6cb8(0x118)]=function(){var _0x1fa5e5,_0x435133;return __awaiter(this,void 0x0,void 0x0,function(){var _0x2dde49,_0x1d14a5;return __generator(this,function(_0x55b5bc){var _0x3a5662=a31_0x21dd;switch(_0x55b5bc[_0x3a5662(0x121)]){case 0x0:return[0x4,state_1[_0x3a5662(0xe4)]((_0x1fa5e5=this[_0x3a5662(0x136)])===null||_0x1fa5e5===void 0x0?void 0x0:_0x1fa5e5[_0x3a5662(0xce)],this[_0x3a5662(0x138)],this[_0x3a5662(0xf4)],this[_0x3a5662(0x133)])];case 0x1:_0x2dde49=_0x55b5bc[_0x3a5662(0xda)]();return[0x4,dockerClient[_0x3a5662(0xc6)](_0x2dde49)];case 0x2:_0x1d14a5=_0x55b5bc['sent']();return[0x4,docker['stopContainer'](_0x1d14a5)];case 0x3:_0x55b5bc['sent']();return[0x4,state_1[_0x3a5662(0xf6)]((_0x435133=this[_0x3a5662(0x136)])===null||_0x435133===void 0x0?void 0x0:_0x435133[_0x3a5662(0xce)],this[_0x3a5662(0x138)],this[_0x3a5662(0xf4)],this[_0x3a5662(0x133)])];case 0x4:_0x55b5bc['sent']();return[0x2];}});});},_0x3c1df5;}(invoke_1['default']);exports[a31_0x41f204(0xc0)]=HttpInvoke;