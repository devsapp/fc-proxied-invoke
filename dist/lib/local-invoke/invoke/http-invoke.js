'use strict';var a31_0x18a5=['../../../common/logger','23592ieanXw','init','102007wzWZhv','done','../../retry','curl','next','Received\x20canncel\x20request,\x20stopping\x20running\x20function\x20container...','../../utils/process','default','../../docker/docker-opts','env','detect\x20code\x20changes,\x20but\x20no\x20runner\x20found,\x20starting....','generateRamdomContainerName','prototype','Stop\x20function\x20container\x20failed,\x20error:\x20','apply','ops','message','exec','222DHHTiz','Stop\x20function\x20container\x20failed.','\x0aFunction\x20container\x20starts\x20failed.Start\x20cleaning\x20now.','../ignore','constructor','creds','Kill\x20function\x20container\x20successfully','clean','iterator','call','promiseRetry','SIGINT','runner','226116hnZYuk','initAndStartRunner','function','debug','fail','isIgnored','region','__esModule','startContainer','Server\x20in\x20function\x20container\x20is\x20up!','845385LTToKc','1460nxqBgV','unsetInvokeContainerId','saveInvokeContainerId','retry','serviceName','close','Function\x20container\x20starts\x20failed\x20because\x20proxy\x20container\x20is\x20not\x20running','stop','getInvokeContainerIdFromState','initWatch','debugPort','watcher','succeed','push','mounts','AccountID','functionName','Server\x20is\x20not\x20up.\x20Result\x20is\x20:','checkIfProxyContainerRunning',',\x20auto\x20reloading...','127.0.0.1:','rimraf','Stop\x20old\x20function\x20container\x20successfully','Function\x20container\x20is\x20closed,\x20exit!','Restart\x20function\x20container\x20timeout\x20after\x20300s!Please\x20check\x20if\x20docker\x20runs\x20normally,\x20then\x20runs\x20\x27clean\x27\x20method\x20and\x20try\x20\x27setup\x27\x20again.','is\x20up','restart','getContainer','../../docker/docker','value','nasConfig','128091mXrboC','then','setPrototypeOf','Restart\x20function\x20container\x20succeed!\x20Please\x20try\x20\x27invoke\x27\x20again.','checking\x20server\x20in\x20function\x20container','label','sleep','Restart\x20function\x20container\x20failed,\x20error\x20is:\x20\x0a','Checking\x20server\x20in\x20function\x20container\x20failed,\x20error:\x20','sessionId','containerName','stopContainer','pop','Kill\x20old\x20container\x20successfully','check','includes','../../utils/devs','../../component/stdout-formatter','../../utils/time','functionConfig','runtime','stdoutFormatter','create','__importDefault','Restart\x20function\x20container\x20failed!','containerId','serviceConfig','--debug','temp_params','trys','Detect\x20code\x20changes,\x20file\x20is\x20','Stop\x20function\x20container\x20error:\x20',',\x20event\x20is\x20','throw','Generator\x20is\x20already\x20executing.','unzippedCodeDir','150VuuBMn','is\x20up.','length','genProxyContainerName','Stop\x20function\x20container\x20successfully','Kill\x20function\x20container\x20failed,\x20error:\x20','3tGlxUz','_startRunner','generateLocalStartOpts','__setModuleDefault','setDebugIdeConfig','setSigint','baseDir','hasOwnProperty','./invoke','sent','tunnelService','invokeContainerId','info','__awaiter','_disableRunner','../../utils/state','generateDockerCmd','Clean\x20tmp\x20code\x20dir\x20','server\x20in\x20function\x20container','debugArgs','../../definition','kill','Detecting\x20code\x20changes\x20and\x20Restarting\x20funtion\x20container...','return','__generator','generateDockerEnvs','node-watch','Killing\x20old\x20container...','spinner','stderr','codeUri','__extends','debugIde','783COuFpA','error'];var a31_0x1ea1f2=a31_0x1b46;(function(_0x171bd8,_0x5241b8){var _0x157224=a31_0x1b46;while(!![]){try{var _0x1fc034=-parseInt(_0x157224(0x84))+parseInt(_0x157224(0xcf))*-parseInt(_0x157224(0xa8))+parseInt(_0x157224(0xf3))+-parseInt(_0x157224(0xe6))*parseInt(_0x157224(0xfe))+-parseInt(_0x157224(0xd2))+parseInt(_0x157224(0xae))*-parseInt(_0x157224(0xd4))+parseInt(_0x157224(0xfd));if(_0x1fc034===_0x5241b8)break;else _0x171bd8['push'](_0x171bd8['shift']());}catch(_0x13b3ba){_0x171bd8['push'](_0x171bd8['shift']());}}}(a31_0x18a5,0x2a0c3));function a31_0x1b46(_0x3c1055,_0x2c0f96){return a31_0x1b46=function(_0x18a563,_0x1b4612){_0x18a563=_0x18a563-0x73;var _0x1155b8=a31_0x18a5[_0x18a563];return _0x1155b8;},a31_0x1b46(_0x3c1055,_0x2c0f96);}var __extends=this&&this[a31_0x1ea1f2(0xcd)]||function(){var _0x59c90a=function(_0x181757,_0x5c26d3){var _0x410872=a31_0x1b46;return _0x59c90a=Object[_0x410872(0x86)]||{'__proto__':[]}instanceof Array&&function(_0x1d6701,_0x2f07ee){_0x1d6701['__proto__']=_0x2f07ee;}||function(_0x1678aa,_0x539eb9){var _0x3d01cd=_0x410872;for(var _0x48012d in _0x539eb9)if(_0x539eb9[_0x3d01cd(0xb5)](_0x48012d))_0x1678aa[_0x48012d]=_0x539eb9[_0x48012d];},_0x59c90a(_0x181757,_0x5c26d3);};return function(_0x194f5a,_0x46df83){var _0x3195e0=a31_0x1b46;_0x59c90a(_0x194f5a,_0x46df83);function _0x336f9a(){var _0x1c5583=a31_0x1b46;this[_0x1c5583(0xea)]=_0x194f5a;}_0x194f5a['prototype']=_0x46df83===null?Object[_0x3195e0(0x9a)](_0x46df83):(_0x336f9a['prototype']=_0x46df83[_0x3195e0(0xe0)],new _0x336f9a());};}(),__createBinding=this&&this['__createBinding']||(Object[a31_0x1ea1f2(0x9a)]?function(_0x570100,_0x8a3d58,_0x111b57,_0xe40cb){if(_0xe40cb===undefined)_0xe40cb=_0x111b57;Object['defineProperty'](_0x570100,_0xe40cb,{'enumerable':!![],'get':function(){return _0x8a3d58[_0x111b57];}});}:function(_0x3d4261,_0xd213bc,_0xa90d4b,_0x3fdaab){if(_0x3fdaab===undefined)_0x3fdaab=_0xa90d4b;_0x3d4261[_0x3fdaab]=_0xd213bc[_0xa90d4b];}),__setModuleDefault=this&&this[a31_0x1ea1f2(0xb1)]||(Object[a31_0x1ea1f2(0x9a)]?function(_0x26325a,_0x205f09){Object['defineProperty'](_0x26325a,'default',{'enumerable':!![],'value':_0x205f09});}:function(_0x2e7fc3,_0x327e37){var _0x1236d7=a31_0x1ea1f2;_0x2e7fc3[_0x1236d7(0xdb)]=_0x327e37;}),__importStar=this&&this['__importStar']||function(_0x219e02){var _0x58adec=a31_0x1ea1f2;if(_0x219e02&&_0x219e02['__esModule'])return _0x219e02;var _0x13b860={};if(_0x219e02!=null){for(var _0x3902ce in _0x219e02)if(_0x3902ce!==_0x58adec(0xdb)&&Object[_0x58adec(0xb5)][_0x58adec(0xef)](_0x219e02,_0x3902ce))__createBinding(_0x13b860,_0x219e02,_0x3902ce);}return __setModuleDefault(_0x13b860,_0x219e02),_0x13b860;},__awaiter=this&&this[a31_0x1ea1f2(0xbb)]||function(_0x3a1878,_0x1ebc21,_0x4ca598,_0x587657){function _0x6e1ab6(_0x519b33){return _0x519b33 instanceof _0x4ca598?_0x519b33:new _0x4ca598(function(_0x5be07b){_0x5be07b(_0x519b33);});}return new(_0x4ca598||(_0x4ca598=Promise))(function(_0x455a30,_0x44d5e0){var _0x375262=a31_0x1b46;function _0x642243(_0x33105b){try{_0x496192(_0x587657['next'](_0x33105b));}catch(_0x141448){_0x44d5e0(_0x141448);}}function _0x47ef9d(_0x5b908e){var _0x3305d5=a31_0x1b46;try{_0x496192(_0x587657[_0x3305d5(0xa5)](_0x5b908e));}catch(_0x56176a){_0x44d5e0(_0x56176a);}}function _0x496192(_0x83668b){var _0x571117=a31_0x1b46;_0x83668b[_0x571117(0xd5)]?_0x455a30(_0x83668b[_0x571117(0x82)]):_0x6e1ab6(_0x83668b[_0x571117(0x82)])[_0x571117(0x85)](_0x642243,_0x47ef9d);}_0x496192((_0x587657=_0x587657[_0x375262(0xe2)](_0x3a1878,_0x1ebc21||[]))[_0x375262(0xd8)]());});},__generator=this&&this[a31_0x1ea1f2(0xc6)]||function(_0x491938,_0x5523f3){var _0x2b5ffb=a31_0x1ea1f2,_0x4f1849={'label':0x0,'sent':function(){if(_0x1727c5[0x0]&0x1)throw _0x1727c5[0x1];return _0x1727c5[0x1];},'trys':[],'ops':[]},_0x5a45e8,_0x2b569a,_0x1727c5,_0x20b92f;return _0x20b92f={'next':_0x5dfdcb(0x0),'throw':_0x5dfdcb(0x1),'return':_0x5dfdcb(0x2)},typeof Symbol===_0x2b5ffb(0xf5)&&(_0x20b92f[Symbol[_0x2b5ffb(0xee)]]=function(){return this;}),_0x20b92f;function _0x5dfdcb(_0x1a84cd){return function(_0x566c61){return _0x4953a9([_0x1a84cd,_0x566c61]);};}function _0x4953a9(_0x48e55e){var _0x1ae1ec=_0x2b5ffb;if(_0x5a45e8)throw new TypeError(_0x1ae1ec(0xa6));while(_0x4f1849)try{if(_0x5a45e8=0x1,_0x2b569a&&(_0x1727c5=_0x48e55e[0x0]&0x2?_0x2b569a[_0x1ae1ec(0xc5)]:_0x48e55e[0x0]?_0x2b569a[_0x1ae1ec(0xa5)]||((_0x1727c5=_0x2b569a[_0x1ae1ec(0xc5)])&&_0x1727c5[_0x1ae1ec(0xef)](_0x2b569a),0x0):_0x2b569a['next'])&&!(_0x1727c5=_0x1727c5[_0x1ae1ec(0xef)](_0x2b569a,_0x48e55e[0x1]))[_0x1ae1ec(0xd5)])return _0x1727c5;if(_0x2b569a=0x0,_0x1727c5)_0x48e55e=[_0x48e55e[0x0]&0x2,_0x1727c5['value']];switch(_0x48e55e[0x0]){case 0x0:case 0x1:_0x1727c5=_0x48e55e;break;case 0x4:_0x4f1849[_0x1ae1ec(0x89)]++;return{'value':_0x48e55e[0x1],'done':![]};case 0x5:_0x4f1849[_0x1ae1ec(0x89)]++,_0x2b569a=_0x48e55e[0x1],_0x48e55e=[0x0];continue;case 0x7:_0x48e55e=_0x4f1849[_0x1ae1ec(0xe3)][_0x1ae1ec(0x90)](),_0x4f1849['trys'][_0x1ae1ec(0x90)]();continue;default:if(!(_0x1727c5=_0x4f1849[_0x1ae1ec(0xa1)],_0x1727c5=_0x1727c5[_0x1ae1ec(0xaa)]>0x0&&_0x1727c5[_0x1727c5[_0x1ae1ec(0xaa)]-0x1])&&(_0x48e55e[0x0]===0x6||_0x48e55e[0x0]===0x2)){_0x4f1849=0x0;continue;}if(_0x48e55e[0x0]===0x3&&(!_0x1727c5||_0x48e55e[0x1]>_0x1727c5[0x0]&&_0x48e55e[0x1]<_0x1727c5[0x3])){_0x4f1849[_0x1ae1ec(0x89)]=_0x48e55e[0x1];break;}if(_0x48e55e[0x0]===0x6&&_0x4f1849[_0x1ae1ec(0x89)]<_0x1727c5[0x1]){_0x4f1849['label']=_0x1727c5[0x1],_0x1727c5=_0x48e55e;break;}if(_0x1727c5&&_0x4f1849[_0x1ae1ec(0x89)]<_0x1727c5[0x2]){_0x4f1849[_0x1ae1ec(0x89)]=_0x1727c5[0x2],_0x4f1849[_0x1ae1ec(0xe3)][_0x1ae1ec(0x10b)](_0x48e55e);break;}if(_0x1727c5[0x2])_0x4f1849[_0x1ae1ec(0xe3)][_0x1ae1ec(0x90)]();_0x4f1849[_0x1ae1ec(0xa1)][_0x1ae1ec(0x90)]();continue;}_0x48e55e=_0x5523f3['call'](_0x491938,_0x4f1849);}catch(_0x37d874){_0x48e55e=[0x6,_0x37d874],_0x2b569a=0x0;}finally{_0x5a45e8=_0x1727c5=0x0;}if(_0x48e55e[0x0]&0x5)throw _0x48e55e[0x1];return{'value':_0x48e55e[0x0]?_0x48e55e[0x1]:void 0x0,'done':!![]};}},__importDefault=this&&this[a31_0x1ea1f2(0x9b)]||function(_0x520fa1){var _0x4dc6e0=a31_0x1ea1f2;return _0x520fa1&&_0x520fa1[_0x4dc6e0(0xfa)]?_0x520fa1:{'default':_0x520fa1};};Object['defineProperty'](exports,'__esModule',{'value':!![]});var node_watch_1=__importDefault(require(a31_0x1ea1f2(0xc8))),rimraf=__importStar(require(a31_0x1ea1f2(0x7a))),ignore_1=require(a31_0x1ea1f2(0xe9)),invoke_1=__importDefault(require(a31_0x1ea1f2(0xb6))),docker=__importStar(require(a31_0x1ea1f2(0x81))),dockerOpts=__importStar(require(a31_0x1ea1f2(0xdc))),dockerode_1=__importDefault(require('dockerode')),runtime_1=require('../../utils/runtime'),logger_1=__importDefault(require(a31_0x1ea1f2(0xd1))),definition_1=require(a31_0x1ea1f2(0xc2)),time_1=require(a31_0x1ea1f2(0x96)),process_1=require(a31_0x1ea1f2(0xda)),devs_1=require(a31_0x1ea1f2(0x94)),retry_1=require(a31_0x1ea1f2(0xd6)),core=__importStar(require('@serverless-devs/core')),stdout_formatter_1=__importDefault(require(a31_0x1ea1f2(0x95))),state_1=require(a31_0x1ea1f2(0xbd)),dev_null_1=__importDefault(require('dev-null')),dockerClient=new dockerode_1[(a31_0x1ea1f2(0xdb))](),HttpInvoke=function(_0x3dc9e8){var _0x444446=a31_0x1ea1f2;__extends(_0x151622,_0x3dc9e8);function _0x151622(_0x4be53e,_0x17c292,_0x393967,_0x455d77,_0x58baae,_0xfcad0f,_0x4d54ea,_0x2fa8c4,_0x543f03,_0x66d82f,_0x456ebc,_0x19671c,_0x44411b,_0x1e8ccb){var _0x4684bd=a31_0x1b46,_0x9e54a1=_0x3dc9e8[_0x4684bd(0xef)](this,_0x4be53e,_0x17c292,_0x393967,_0x455d77,_0x58baae,_0xfcad0f,_0x4d54ea,_0x2fa8c4,_0x543f03,_0x66d82f,_0x456ebc,_0x19671c,_0x44411b,_0x1e8ccb)||this;return process_1[_0x4684bd(0xb3)](),process['on'](_0x4684bd(0xf1),function(){return __awaiter(_0x9e54a1,void 0x0,void 0x0,function(){var _0x53c372,_0x4d2116,_0x4e0766,_0x591a9b,_0x1ac890;return __generator(this,function(_0x3881e5){var _0x311602=a31_0x1b46;switch(_0x3881e5[_0x311602(0x89)]){case 0x0:this[_0x311602(0x109)]&&this['watcher'][_0x311602(0x103)]();this['cleanUnzippedCodeDir']();if(!this['runner'])return[0x3,0xa];_0x53c372=core[_0x311602(0xca)](_0x311602(0xd9)),_0x3881e5[_0x311602(0x89)]=0x1;case 0x1:_0x3881e5[_0x311602(0xa1)][_0x311602(0x10b)]([0x1,0x3,,0x8]);return[0x4,this[_0x311602(0xf2)]['stop']()];case 0x2:_0x3881e5[_0x311602(0xb7)](),_0x53c372['succeed'](_0x311602(0xac));return[0x3,0x8];case 0x3:_0x4d2116=_0x3881e5['sent'](),_0x53c372[_0x311602(0xf7)](_0x311602(0xe7)),logger_1[_0x311602(0xdb)][_0x311602(0xf6)]('Stop\x20function\x20container\x20failed,\x20error:\x20'+_0x4d2116),_0x4e0766=core[_0x311602(0xca)](_0x311602(0xc9)),_0x3881e5[_0x311602(0x89)]=0x4;case 0x4:_0x3881e5[_0x311602(0xa1)][_0x311602(0x10b)]([0x4,0x6,,0x7]);return[0x4,this[_0x311602(0xf2)]['kill']()];case 0x5:_0x3881e5['sent'](),_0x4e0766[_0x311602(0x10a)](_0x311602(0xec));return[0x3,0x7];case 0x6:_0x591a9b=_0x3881e5[_0x311602(0xb7)](),_0x4e0766[_0x311602(0xf7)]('Kill\x20old\x20container\x20failed,\x20please\x20kill\x20it\x20manually.'),logger_1[_0x311602(0xdb)][_0x311602(0xf6)](_0x311602(0xad)+_0x591a9b);return[0x3,0x7];case 0x7:return[0x3,0x8];case 0x8:return[0x4,state_1[_0x311602(0xff)]((_0x1ac890=this[_0x311602(0xeb)])===null||_0x1ac890===void 0x0?void 0x0:_0x1ac890[_0x311602(0x74)],this[_0x311602(0xf9)],this[_0x311602(0x102)],this['functionName'])];case 0x9:_0x3881e5['sent'](),this[_0x311602(0xf2)]=null,_0x3881e5[_0x311602(0x89)]=0xa;case 0xa:if(!this['tunnelService'])return[0x3,0xc];return[0x4,this[_0x311602(0xb8)][_0x311602(0xed)]()];case 0xb:_0x3881e5[_0x311602(0xb7)](),_0x3881e5[_0x311602(0x89)]=0xc;case 0xc:return[0x2];}});});}),_0x9e54a1;}return _0x151622[_0x444446(0xe0)][_0x444446(0xbc)]=function(_0x46f6ba,_0xc058b8){var _0x185c76;return __awaiter(this,void 0x0,void 0x0,function(){var _0x155a14,_0x12c6d8,_0x311d56,_0x467f07,_0x4d41aa,_0xab8e2c;return __generator(this,function(_0x3467dd){var _0x502ad0=a31_0x1b46;switch(_0x3467dd[_0x502ad0(0x89)]){case 0x0:if(!this[_0x502ad0(0xf2)])return[0x2];logger_1['default'][_0x502ad0(0xba)](_0x502ad0(0xa2)+_0xc058b8+_0x502ad0(0xa4)+_0x46f6ba+_0x502ad0(0x78)),_0x155a14=this['runner'],_0x12c6d8=this[_0x502ad0(0xa7)],this[_0x502ad0(0xf2)]=null;return[0x4,this[_0x502ad0(0xd3)]()];case 0x1:_0x3467dd[_0x502ad0(0xb7)]();return[0x4,time_1[_0x502ad0(0x8a)](0x1f4)];case 0x2:_0x3467dd[_0x502ad0(0xb7)](),_0x311d56=core[_0x502ad0(0xca)]('Reloading\x20success,\x20stopping\x20old\x20function\x20container...'),_0x3467dd[_0x502ad0(0x89)]=0x3;case 0x3:_0x3467dd[_0x502ad0(0xa1)][_0x502ad0(0x10b)]([0x3,0x5,,0xa]);return[0x4,_0x155a14[_0x502ad0(0x105)]()];case 0x4:_0x3467dd[_0x502ad0(0xb7)](),_0x311d56['succeed'](_0x502ad0(0x7b));return[0x3,0xa];case 0x5:_0x467f07=_0x3467dd[_0x502ad0(0xb7)](),_0x311d56[_0x502ad0(0xf7)](_0x502ad0(0xe7)),logger_1[_0x502ad0(0xdb)][_0x502ad0(0xf6)](_0x502ad0(0xe1)+_0x467f07),_0x4d41aa=core[_0x502ad0(0xca)](_0x502ad0(0xc9)),_0x3467dd[_0x502ad0(0x89)]=0x6;case 0x6:_0x3467dd['trys'][_0x502ad0(0x10b)]([0x6,0x8,,0x9]);return[0x4,_0x155a14[_0x502ad0(0xc3)]()];case 0x7:_0x3467dd['sent'](),_0x4d41aa[_0x502ad0(0x10a)](_0x502ad0(0x91));return[0x3,0x9];case 0x8:_0xab8e2c=_0x3467dd[_0x502ad0(0xb7)](),_0x4d41aa[_0x502ad0(0xf7)]('Kill\x20old\x20container\x20failed,\x20please\x20kill\x20it\x20manually.'),logger_1['default']['debug']('Kill\x20function\x20container\x20failed,\x20error:\x20'+_0xab8e2c);return[0x3,0x9];case 0x9:return[0x3,0xa];case 0xa:return[0x4,state_1[_0x502ad0(0xff)]((_0x185c76=this[_0x502ad0(0xeb)])===null||_0x185c76===void 0x0?void 0x0:_0x185c76['AccountID'],this['region'],this[_0x502ad0(0x102)],this[_0x502ad0(0x75)])];case 0xb:_0x3467dd[_0x502ad0(0xb7)]();_0x12c6d8&&(rimraf['sync'](_0x12c6d8),logger_1[_0x502ad0(0xdb)][_0x502ad0(0xba)](_0x502ad0(0xbf)+_0x12c6d8+'\x20successfully.\x0a'));return[0x2];}});});},_0x151622[_0x444446(0xe0)][_0x444446(0xaf)]=function(){var _0x2ead3e,_0x296b8a,_0x2f4d4f;return __awaiter(this,void 0x0,void 0x0,function(){var _0x573597,_0x5b7cc5,_0x12463d,_0x3767fd,_0x30e2c4,_0x30476f,_0x4cb16e,_0x4d2932=this;return __generator(this,function(_0x564c39){var _0xbc401a=a31_0x1b46;switch(_0x564c39[_0xbc401a(0x89)]){case 0x0:_0x573597=this[_0xbc401a(0xb8)];if(!_0x573597)return[0x3,0x2];return[0x4,this[_0xbc401a(0xb8)][_0xbc401a(0x77)]()];case 0x1:_0x573597=!_0x564c39['sent'](),_0x564c39[_0xbc401a(0x89)]=0x2;case 0x2:if(!_0x573597)return[0x3,0x5];console['log'](),logger_1['default'][_0xbc401a(0xd0)](_0xbc401a(0xe8));if(!this[_0xbc401a(0xb8)])return[0x3,0x4];return[0x4,this[_0xbc401a(0xb8)][_0xbc401a(0xed)]()];case 0x3:_0x564c39[_0xbc401a(0xb7)](),_0x564c39['label']=0x4;case 0x4:throw new Error('Function\x20container\x20starts\x20failed\x20because\x20proxy\x20container\x20is\x20not\x20running,\x20please\x20retry\x20\x27setup\x27\x20method.');case 0x5:return[0x4,docker[_0xbc401a(0xc7)](this[_0xbc401a(0xeb)],this[_0xbc401a(0xf9)],this[_0xbc401a(0xb4)],this[_0xbc401a(0x102)],this[_0xbc401a(0x9e)],this[_0xbc401a(0x75)],this['functionConfig'],this[_0xbc401a(0x108)],null,this[_0xbc401a(0x83)],this[_0xbc401a(0xce)],this[_0xbc401a(0xc1)])];case 0x6:_0x5b7cc5=_0x564c39['sent'](),_0x12463d=docker[_0xbc401a(0xbe)](this[_0xbc401a(0x98)],!![],this[_0xbc401a(0x97)]),_0x3767fd=definition_1[_0xbc401a(0xab)](this[_0xbc401a(0x8d)]),this[_0xbc401a(0x8e)]=docker[_0xbc401a(0xdf)]();return[0x4,dockerOpts[_0xbc401a(0xb0)](_0x3767fd,this[_0xbc401a(0x98)],this[_0xbc401a(0x8e)],this[_0xbc401a(0x73)],_0x12463d,_0x5b7cc5,{'debugPort':this[_0xbc401a(0x108)],'dockerUser':this['dockerUser'],'imageName':this['imageName']})];case 0x7:_0x30e2c4=_0x564c39[_0xbc401a(0xb7)](),_0x30476f=this;return[0x4,docker[_0xbc401a(0xfb)](_0x30e2c4,process['stdout'],process['stderr'],{'serviceName':this['serviceName'],'functionName':this['functionName']})];case 0x8:_0x30476f[_0xbc401a(0xf2)]=_0x564c39[_0xbc401a(0xb7)]();return[0x4,this['saveInvokeContainerId']()];case 0x9:_0x564c39[_0xbc401a(0xb7)](),_0x4cb16e=(_0x296b8a=(_0x2ead3e=process[_0xbc401a(0xdd)])===null||_0x2ead3e===void 0x0?void 0x0:_0x2ead3e[_0xbc401a(0xa0)])===null||_0x296b8a===void 0x0?void 0x0:_0x296b8a[_0xbc401a(0x93)](_0xbc401a(0x9f));if(!!runtime_1['isCustomContainerRuntime']((_0x2f4d4f=this['functionConfig'])===null||_0x2f4d4f===void 0x0?void 0x0:_0x2f4d4f['runtime']))return[0x3,0xb];logger_1['default'][_0xbc401a(0xba)](stdout_formatter_1[_0xbc401a(0xdb)]['stdoutFormatter'][_0xbc401a(0x92)](_0xbc401a(0xc0),_0xbc401a(0xa9)));return[0x4,retry_1[_0xbc401a(0xf0)](function(_0x5acbb6,_0x47ae5d){return __awaiter(_0x4d2932,void 0x0,void 0x0,function(){var _0x313194,_0x13f5ba,_0xcd2cd3,_0x416bb6;return __generator(this,function(_0x2c9131){var _0x400162=a31_0x1b46;switch(_0x2c9131[_0x400162(0x89)]){case 0x0:_0x2c9131[_0x400162(0xa1)][_0x400162(0x10b)]([0x0,0x3,,0x4]);if(!this[_0x400162(0xf2)])throw new Error('Function\x20container\x20is\x20closed,\x20exit!');return[0x4,time_1['sleep'](0x3e8)];case 0x1:_0x2c9131[_0x400162(0xb7)](),_0x313194=((_0x416bb6=this['functionConfig'])===null||_0x416bb6===void 0x0?void 0x0:_0x416bb6['caPort'])||0x2328;return[0x4,this[_0x400162(0xf2)][_0x400162(0xe5)]([_0x400162(0xd7),_0x400162(0x79)+_0x313194],{'outputStream':_0x4cb16e?process['stdout']:dev_null_1[_0x400162(0xdb)](),'errorStream':_0x4cb16e?process[_0x400162(0xcb)]:dev_null_1['default']()})];case 0x2:_0x13f5ba=_0x2c9131['sent']();if(_0x13f5ba===0x0)return logger_1[_0x400162(0xdb)]['info'](_0x400162(0xfc)),[0x2];logger_1[_0x400162(0xdb)][_0x400162(0xf6)](_0x400162(0x76)+_0x13f5ba),logger_1[_0x400162(0xdb)][_0x400162(0xba)](stdout_formatter_1[_0x400162(0xdb)]['stdoutFormatter'][_0x400162(0x101)]('checking\x20server\x20in\x20function\x20container',_0x400162(0x7e),'',_0x47ae5d)),_0x5acbb6(_0x13f5ba);return[0x3,0x4];case 0x3:_0xcd2cd3=_0x2c9131[_0x400162(0xb7)]();if(_0xcd2cd3[_0x400162(0xe4)]===_0x400162(0x7c))throw _0xcd2cd3;logger_1[_0x400162(0xdb)][_0x400162(0xf6)](_0x400162(0x8c)+_0xcd2cd3),logger_1[_0x400162(0xdb)]['info'](stdout_formatter_1[_0x400162(0xdb)][_0x400162(0x99)][_0x400162(0x101)](_0x400162(0x88),_0x400162(0x7e),'',_0x47ae5d)),_0x5acbb6(_0xcd2cd3);return[0x3,0x4];case 0x4:return[0x2];}});});},0x14)];case 0xa:_0x564c39[_0xbc401a(0xb7)](),_0x564c39[_0xbc401a(0x89)]=0xb;case 0xb:return[0x2];}});});},_0x151622[_0x444446(0xe0)][_0x444446(0x100)]=function(){var _0x1d6e9e,_0x2ddbae;return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x5a7280){var _0x5811d3=a31_0x1b46;switch(_0x5a7280[_0x5811d3(0x89)]){case 0x0:return[0x4,devs_1['setKVInState'](_0x5811d3(0xb9),(_0x1d6e9e=this['runner'])===null||_0x1d6e9e===void 0x0?void 0x0:_0x1d6e9e[_0x5811d3(0x9d)],state_1['genStateId']((_0x2ddbae=this['creds'])===null||_0x2ddbae===void 0x0?void 0x0:_0x2ddbae[_0x5811d3(0x74)],this['region'],this[_0x5811d3(0x102)],this[_0x5811d3(0x75)]))];case 0x1:_0x5a7280[_0x5811d3(0xb7)]();return[0x2];}});});},_0x151622[_0x444446(0xe0)][_0x444446(0x107)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){var _0x1946d9,_0x2f46f7,_0x2f0504,_0x5979bf=this;return __generator(this,function(_0x5bb65c){var _0x4748e9=a31_0x1b46;switch(_0x5bb65c[_0x4748e9(0x89)]){case 0x0:if(!(!this[_0x4748e9(0x109)]&&!runtime_1['isCustomContainerRuntime'](this[_0x4748e9(0x98)])))return[0x3,0x2];return[0x4,ignore_1[_0x4748e9(0xf8)](this['baseDir'])];case 0x1:_0x1946d9=_0x5bb65c[_0x4748e9(0xb7)](),_0x2f46f7=![],_0x2f0504=![],this[_0x4748e9(0x109)]=node_watch_1[_0x4748e9(0xdb)](this[_0x4748e9(0xcc)],{'recursive':!![],'persistent':![],'filter':function(_0x2c9645){return _0x1946d9&&!_0x1946d9(_0x2c9645);}},function(_0xa610f0,_0xd14a79){return __awaiter(_0x5979bf,void 0x0,void 0x0,function(){var _0x36dabc,_0x159a8d,_0x1bc781,_0x33fb6c=this;return __generator(this,function(_0x1e095a){var _0x29b33f=a31_0x1b46;switch(_0x1e095a[_0x29b33f(0x89)]){case 0x0:if(_0x2f46f7)return[0x2];_0x36dabc=0x12c,_0x159a8d=0x0;if(!_0x2f0504)return[0x3,0x7];_0x1e095a[_0x29b33f(0x89)]=0x1;case 0x1:if(!_0x2f0504)return[0x3,0x7];if(_0x2f46f7)return[0x2];return[0x4,time_1[_0x29b33f(0x8a)](0xbb8)];case 0x2:_0x1e095a[_0x29b33f(0xb7)](),_0x159a8d=_0x159a8d+0x3;if(!(_0x159a8d>_0x36dabc))return[0x3,0x6];return[0x4,this[_0x29b33f(0xed)]()];case 0x3:_0x1e095a[_0x29b33f(0xb7)]();if(!this[_0x29b33f(0xb8)])return[0x3,0x5];return[0x4,this[_0x29b33f(0xb8)][_0x29b33f(0xed)]()];case 0x4:_0x1e095a[_0x29b33f(0xb7)](),_0x1e095a['label']=0x5;case 0x5:throw new Error(_0x29b33f(0x7d));case 0x6:return[0x3,0x1];case 0x7:_0x2f46f7=!![],_0x1e095a['label']=0x8;case 0x8:_0x1e095a[_0x29b33f(0xa1)][_0x29b33f(0x10b)]([0x8,0xc,,0xd]);if(!this[_0x29b33f(0xf2)])return[0x3,0xa];return[0x4,this[_0x29b33f(0xbc)](_0xa610f0,_0xd14a79)];case 0x9:_0x1e095a['sent']();return[0x3,0xb];case 0xa:logger_1['default'][_0x29b33f(0xf6)](_0x29b33f(0xde)),_0x1e095a[_0x29b33f(0x89)]=0xb;case 0xb:return[0x3,0xd];case 0xc:_0x1bc781=_0x1e095a[_0x29b33f(0xb7)](),logger_1[_0x29b33f(0xdb)]['warning']('Stop\x20function\x20container\x20failed,\x20please\x20stop\x20it\x20manually.'),logger_1[_0x29b33f(0xdb)]['debug'](_0x29b33f(0xa3)+_0x1bc781);return[0x3,0xd];case 0xd:_0x2f0504=!![],_0x2f46f7=![],logger_1[_0x29b33f(0xdb)]['info'](_0x29b33f(0xc4));return[0x4,retry_1[_0x29b33f(0xf0)](function(_0x31ba5c,_0x28c368){return __awaiter(_0x33fb6c,void 0x0,void 0x0,function(){var _0x3e1ad6;return __generator(this,function(_0x38bf74){var _0xd221cf=a31_0x1b46;switch(_0x38bf74[_0xd221cf(0x89)]){case 0x0:_0x38bf74[_0xd221cf(0xa1)][_0xd221cf(0x10b)]([0x0,0x2,,0x4]);return[0x4,this[_0xd221cf(0xaf)]()];case 0x1:_0x38bf74[_0xd221cf(0xb7)](),logger_1[_0xd221cf(0xdb)][_0xd221cf(0xba)](_0xd221cf(0x87));return[0x2];case 0x2:_0x3e1ad6=_0x38bf74['sent'](),logger_1['default'][_0xd221cf(0xd0)](_0xd221cf(0x9c));if(_0x3e1ad6===null||_0x3e1ad6===void 0x0?void 0x0:_0x3e1ad6['message'][_0xd221cf(0x93)](_0xd221cf(0x104)))throw _0x3e1ad6;logger_1[_0xd221cf(0xdb)][_0xd221cf(0xf6)](_0xd221cf(0x8b)+_0x3e1ad6),logger_1[_0xd221cf(0xdb)][_0xd221cf(0xba)](stdout_formatter_1[_0xd221cf(0xdb)]['stdoutFormatter']['retry']('function\x20container',_0xd221cf(0x7f),'',_0x28c368));return[0x4,time_1['sleep'](0x64)];case 0x3:_0x38bf74[_0xd221cf(0xb7)](),_0x31ba5c(_0x3e1ad6);return[0x3,0x4];case 0x4:return[0x2];}});});})];case 0xe:_0x1e095a[_0x29b33f(0xb7)](),_0x2f0504=![];return[0x2];}});});}),this[_0x4748e9(0x109)]['on']('error',function(_0x511c32){throw _0x511c32;}),_0x5bb65c[_0x4748e9(0x89)]=0x2;case 0x2:return[0x2];}});});},_0x151622[_0x444446(0xe0)][_0x444446(0xf4)]=function(){return __awaiter(this,void 0x0,void 0x0,function(){return __generator(this,function(_0x141bcd){var _0x58f6dd=a31_0x1b46;switch(_0x141bcd[_0x58f6dd(0x89)]){case 0x0:return[0x4,this[_0x58f6dd(0xd3)]()];case 0x1:_0x141bcd['sent']();return[0x4,this[_0x58f6dd(0xaf)]()];case 0x2:_0x141bcd[_0x58f6dd(0xb7)]();return[0x4,this['initWatch']()];case 0x3:_0x141bcd[_0x58f6dd(0xb7)]();return[0x4,this[_0x58f6dd(0xb2)]()];case 0x4:_0x141bcd[_0x58f6dd(0xb7)]();return[0x2];}});});},_0x151622['prototype'][_0x444446(0xed)]=function(){var _0x3902bb,_0x3c52c4;return __awaiter(this,void 0x0,void 0x0,function(){var _0x42bf14,_0x53f0c8;return __generator(this,function(_0x51cdeb){var _0x4b9684=a31_0x1b46;switch(_0x51cdeb['label']){case 0x0:return[0x4,state_1[_0x4b9684(0x106)]((_0x3902bb=this[_0x4b9684(0xeb)])===null||_0x3902bb===void 0x0?void 0x0:_0x3902bb[_0x4b9684(0x74)],this['region'],this[_0x4b9684(0x102)],this[_0x4b9684(0x75)])];case 0x1:_0x42bf14=_0x51cdeb[_0x4b9684(0xb7)]();return[0x4,dockerClient[_0x4b9684(0x80)](_0x42bf14)];case 0x2:_0x53f0c8=_0x51cdeb[_0x4b9684(0xb7)]();return[0x4,docker[_0x4b9684(0x8f)](_0x53f0c8)];case 0x3:_0x51cdeb['sent']();return[0x4,state_1[_0x4b9684(0xff)]((_0x3c52c4=this[_0x4b9684(0xeb)])===null||_0x3c52c4===void 0x0?void 0x0:_0x3c52c4[_0x4b9684(0x74)],this[_0x4b9684(0xf9)],this[_0x4b9684(0x102)],this[_0x4b9684(0x75)])];case 0x4:_0x51cdeb['sent']();return[0x2];}});});},_0x151622;}(invoke_1[a31_0x1ea1f2(0xdb)]);exports[a31_0x1ea1f2(0xdb)]=HttpInvoke;